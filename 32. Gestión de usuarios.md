# 32. Gesti√≥n de usuarios

> *"En el coraz√≥n de cualquier sistema operativo est√°n sus usuarios. ¬øSab√≠as que puedes gestionar cientos de cuentas de usuario desde la l√≠nea de comandos sin tocar una interfaz gr√°fica?"* üë•

## Introducci√≥n

La gesti√≥n de usuarios es una de las tareas m√°s fundamentales en la administraci√≥n de sistemas Windows. Desde crear cuentas para nuevos empleados hasta configurar pol√≠ticas de seguridad, cada acci√≥n que realizas afecta la experiencia y seguridad de los usuarios.

¬øTe imaginas administrando un servidor corporativo con 500 empleados? ¬øO configurando un laboratorio de computadoras para 200 estudiantes? Estas tareas, que parecer√≠an imposibles sin herramientas gr√°ficas, se vuelven simples y eficientes cuando dominas los comandos de l√≠nea de comandos.

En este cap√≠tulo, aprender√°s a crear, modificar, eliminar y administrar usuarios de manera profesional, desde operaciones b√°sicas hasta escenarios empresariales complejos.

## Conceptos Clave

### üë§ **Usuario del Sistema**
Una cuenta que permite a una persona acceder y utilizar los recursos del sistema operativo.

### üîê **Grupo de Usuarios**
Una colecci√≥n de usuarios que comparten los mismos permisos y privilegios en el sistema.

### üõ°Ô∏è **Pol√≠tica de Contrase√±as**
Reglas que definen la complejidad, duraci√≥n y renovaci√≥n de las contrase√±as de usuario.

### üìã **Perfil de Usuario**
Configuraci√≥n personalizada que incluye documentos, configuraciones y preferencias del usuario.

## Comandos y herramientas principales

### `NET USER`
Comando principal para gestionar usuarios locales del sistema, incluyendo creaci√≥n, modificaci√≥n y eliminaci√≥n de cuentas.

**Sintaxis b√°sica:**
```batch
net user [nombre_usuario] [contrase√±a] [opciones]
```

**Par√°metros principales:**
- `/add` - Crear nuevo usuario en el sistema
- `/delete` - Eliminar usuario del sistema
- `/active:yes|no` - Activar o desactivar la cuenta de usuario
- `/expires:date|never` - Establecer fecha de expiraci√≥n de la cuenta
- `/passwordchg:yes|no` - Permitir o denegar cambio de contrase√±a por el usuario
- `/passwordreq:yes|no` - Requerir o no contrase√±a para la cuenta
- `/comment:"texto"` - Agregar comentario descriptivo a la cuenta
- `/fullname:"nombre"` - Establecer nombre completo del usuario
- `/homedir:"ruta"` - Especificar directorio home del usuario
- `/profilepath:"ruta"` - Especificar ruta del perfil de usuario
- `/scriptpath:"ruta"` - Especificar script de inicio de sesi√≥n

### `NET LOCALGROUP`
Comando para gestionar grupos locales del sistema y sus miembros.

**Sintaxis:**
```batch
net localgroup [nombre_grupo] [usuario] [opciones]
```

**Par√°metros principales:**
- `/add` - Agregar usuario al grupo
- `/delete` - Remover usuario del grupo
- `nombre_grupo` - Nombre del grupo a gestionar
- `usuario` - Usuario a agregar o remover del grupo

### `WMIC USERACCOUNT`
Comando avanzado para consultas detalladas sobre cuentas de usuario usando WMI.

**Sintaxis:**
```batch
wmic useraccount [where condici√≥n] [get propiedades] [set propiedades]
```

**Propiedades comunes:**
- `name` - Nombre de la cuenta
- `disabled` - Estado de la cuenta (true/false)
- `lockout` - Si la cuenta est√° bloqueada
- `passwordexpires` - Si la contrase√±a expira
- `passwordrequired` - Si se requiere contrase√±a

### `Set-LocalUser` (PowerShell)
Cmdlet de PowerShell para cambiar propiedades de usuarios locales.

**Sintaxis:**
```powershell
Set-LocalUser -Name "usuario" -Password "contrase√±a"
Set-LocalUser -Name "usuario" -Enabled $true
Set-LocalUser -Name "usuario" -Description "comentario"
```

### Comandos adicionales utilizados
- `FOR /F` - Procesar archivos l√≠nea por l√≠nea
- `FOR /L` - Bucles num√©ricos para creaci√≥n masiva
- `IF` - Condiciones en scripts
- `PAUSE` - Pausar ejecuci√≥n del script
- `ECHO` - Mostrar mensajes
- `SET` - Definir variables
- `FINDSTR` - Buscar cadenas en la salida

## Ejemplos Pr√°cticos

### 1. **Crear Usuario B√°sico**
**Prop√≥sito:** Crear una nueva cuenta de usuario con configuraci√≥n b√°sica.

```batch
net user juan123 MiContrase√±a123 /add /fullname:"Juan P√©rez" /comment:"Empleado de IT"
```

**Casos de uso reales:**
- Nuevos empleados en la empresa
- Cuentas temporales para proyectos
- Usuarios de prueba para desarrollo

### 2. **Crear Usuario con Configuraci√≥n Avanzada**
**Prop√≥sito:** Crear usuario con pol√≠ticas espec√≠ficas de seguridad.

```batch
net user maria456 MiContrase√±a456 /add /fullname:"Mar√≠a Garc√≠a" /passwordchg:no /expires:12/31/2024
```

**Casos de uso reales:**
- Cuentas de servicio con restricciones
- Usuarios con acceso temporal
- Cuentas de auditor√≠a con pol√≠ticas estrictas

### 3. **Eliminar Usuario**
**Prop√≥sito:** Eliminar completamente una cuenta de usuario del sistema.

```batch
net user carlos789 /delete
```

**Casos de uso reales:**
- Empleados que dejan la empresa
- Limpieza de cuentas temporales
- Eliminaci√≥n de cuentas comprometidas

### 4. **Desactivar Usuario**
**Prop√≥sito:** Desactivar temporalmente una cuenta sin eliminarla.

```batch
net user ana123 /active:no
```

**Casos de uso reales:**
- Suspensiones temporales
- Mantenimiento de cuentas
- Investigaciones de seguridad

### 5. **Cambiar Contrase√±a**
**Prop√≥sito:** Cambiar la contrase√±a de un usuario existente.

```batch
net user luis456 NuevaContrase√±a789
```

**Casos de uso reales:**
- Renovaci√≥n de contrase√±as expiradas
- Reseteo de contrase√±as olvidadas
- Cambios de seguridad programados

### 6. **Agregar Usuario a Grupo**
**Prop√≥sito:** Asignar un usuario a un grupo espec√≠fico para otorgar permisos.

```batch
net localgroup Administradores juan123 /add
```

**Casos de uso reales:**
- Asignaci√≥n de roles administrativos
- Configuraci√≥n de permisos por departamento
- Gesti√≥n de acceso a recursos compartidos

### 7. **Listar Usuarios del Sistema**
**Prop√≥sito:** Ver todas las cuentas de usuario existentes en el sistema.

```batch
net user
```

**Casos de uso reales:**
- Auditor√≠a de cuentas de usuario
- Verificaci√≥n de cuentas activas
- Inventario de usuarios del sistema

### 8. **Ver Informaci√≥n Detallada de Usuario**
**Prop√≥sito:** Obtener informaci√≥n completa sobre una cuenta espec√≠fica.

```batch
net user maria456
```

**Casos de uso reales:**
- Verificaci√≥n de configuraci√≥n de cuenta
- Diagn√≥stico de problemas de acceso
- Auditor√≠a de pol√≠ticas de usuario

### 9. **Configurar Pol√≠tica de Contrase√±as**
**Prop√≥sito:** Establecer pol√≠ticas espec√≠ficas para la contrase√±a de un usuario.

```batch
net user pedro123 /passwordreq:yes /passwordchg:yes
```

**Casos de uso reales:**
- Cumplimiento de pol√≠ticas de seguridad
- Configuraci√≥n de cuentas de alto privilegio
- Gesti√≥n de cuentas de servicio

### 10. **Crear Usuario con Fecha de Expiraci√≥n**
**Prop√≥sito:** Crear una cuenta que expire autom√°ticamente en una fecha espec√≠fica.

```batch
net user temporal123 TempPass456 /add /expires:06/30/2024 /comment:"Cuenta temporal para proyecto"
```

**Casos de uso reales:**
- Contratistas temporales
- Proyectos con fecha de finalizaci√≥n
- Cuentas de prueba con expiraci√≥n autom√°tica



## Consejos Importantes

### ‚ö° **Optimizaci√≥n**
- Usa nombres de usuario consistentes y descriptivos
- Implementa pol√≠ticas de contrase√±as seguras
- Mant√©n un inventario actualizado de usuarios

### üõ°Ô∏è **Seguridad**
- Revisa regularmente las cuentas de usuario
- Implementa pol√≠ticas de expiraci√≥n de contrase√±as
- Usa grupos para gestionar permisos eficientemente

### üîß **Mejores Pr√°cticas**
- Documenta cambios en cuentas de usuario
- Usa comentarios para identificar el prop√≥sito de cada cuenta
- Implementa procesos de onboarding y offboarding

## Casos de Uso Reales

### üè¢ **Administraci√≥n de Sistemas**
- Gesti√≥n de cuentas de empleados
- Configuraci√≥n de cuentas de servicio
- Auditor√≠a de seguridad de usuarios

### üè´ **Entornos Educativos**
- Creaci√≥n masiva de cuentas de estudiantes
- Gesti√≥n de cuentas de profesores
- Configuraci√≥n de laboratorios de computaci√≥n

### üè≠ **Entornos Empresariales**
- Procesos de onboarding de empleados
- Gesti√≥n de cuentas de contratistas
- Cumplimiento de pol√≠ticas de seguridad

## Conclusi√≥n y Siguiente Paso

Has dominado la gesti√≥n de usuarios desde la l√≠nea de comandos. Ahora puedes crear, modificar y administrar cuentas de usuario de manera profesional y eficiente, sin depender de herramientas gr√°ficas.

En el siguiente cap√≠tulo, exploraremos c√≥mo **Habilitar el usuario Administrador**, una tarea cr√≠tica para la administraci√≥n de sistemas. ¬øTe imaginas recuperando acceso a un servidor cuando todas las cuentas administrativas est√°n bloqueadas? ¬°Esa ser√° tu pr√≥xima habilidad!

---

## Enlaces Relacionados

- [Cap√≠tulo 31: Apagar, Reiniciar y Cerrar sesi√≥n](31.%20Apagar,%20Reiniciar%20y%20Cerrar%20sesi√≥n.md)
- [Cap√≠tulo 33: Habilitar usuario Administrador](33.%20Habilitar%20usuario%20Administrador.md)
- [Cap√≠tulo 40: Ejecutar como Administrador - RUNAS](40.%20Ejecutar%20como%20Administrador%20-%20RUNAS.md)

## Fuentes y Referencias

- **Documentaci√≥n oficial de Microsoft:** [Net User Command](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/net-user)
- **Windows Command Line Reference:** [User Management Commands](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands)
- **Administraci√≥n de Windows Server:** [User Account Management](https://docs.microsoft.com/en-us/windows-server/administration/)

---

## Scripts disponibles

En el directorio `scripts/32-gestion-usuarios/` encontrar√°s los siguientes scripts para automatizar la gesti√≥n de usuarios del sistema:

### üë• **Gesti√≥n individual de usuarios**
- **`gestor-avanzado-usuarios.bat`** - Interfaz completa para crear, modificar, eliminar usuarios y gestionar grupos
- **`creacion-masiva-usuarios.bat`** - Herramienta para crear m√∫ltiples usuarios desde archivos CSV o generar usuarios de prueba

### üìã **Instrucciones de uso**

1. **Para gesti√≥n individual de usuarios:**
   ```batch
   cd scripts\32-gestion-usuarios
   gestor-avanzado-usuarios.bat
   ```

2. **Para creaci√≥n masiva:**
   - Crea un archivo CSV con formato: `usuario,contrase√±a,nombre,grupo`
   - Ejecuta: `creacion-masiva-usuarios.bat`
   - Selecciona la opci√≥n deseada

3. **Ejemplo de archivo CSV:**
   ```
   juan.perez,Pass123!,Juan P√©rez,Usuarios
   maria.garcia,Pass456!,Mar√≠a Garc√≠a,Administradores
   ```

### ‚ö†Ô∏è **Notas importantes**
- Ejecuta estos scripts como administrador
- Verifica las pol√≠ticas de contrase√±as del sistema
- Haz backup de la informaci√≥n de usuarios antes de modificaciones masivas
- Usa comentarios descriptivos para identificar el prop√≥sito de cada cuenta

---

**Autor:** Jerson Mart√≠nez  
**Sitio web:** [jersonmartinez.com](https://jersonmartinez.com)  
**Blog DevOps:** [crashell.com](https://crashell.com) 
# 32. GestiÃ³n de usuarios

> *"En el corazÃ³n de cualquier sistema operativo estÃ¡n sus usuarios. Â¿SabÃ­as que puedes gestionar cientos de cuentas de usuario desde la lÃ­nea de comandos sin tocar una interfaz grÃ¡fica?"* ğŸ‘¥

## IntroducciÃ³n

La gestiÃ³n de usuarios es una de las tareas mÃ¡s fundamentales en la administraciÃ³n de sistemas Windows. Desde crear cuentas para nuevos empleados hasta configurar polÃ­ticas de seguridad, cada acciÃ³n que realizas afecta la experiencia y seguridad de los usuarios.

Â¿Te imaginas administrando un servidor corporativo con 500 empleados? Â¿O configurando un laboratorio de computadoras para 200 estudiantes? Estas tareas, que parecerÃ­an imposibles sin herramientas grÃ¡ficas, se vuelven simples y eficientes cuando dominas los comandos de lÃ­nea de comandos.

En este capÃ­tulo, aprenderÃ¡s a crear, modificar, eliminar y administrar usuarios de manera profesional, desde operaciones bÃ¡sicas hasta escenarios empresariales complejos.

## Conceptos Clave

### ğŸ‘¤ **Usuario del Sistema**
Una cuenta que permite a una persona acceder y utilizar los recursos del sistema operativo.

### ğŸ” **Grupo de Usuarios**
Una colecciÃ³n de usuarios que comparten los mismos permisos y privilegios en el sistema.

### ğŸ›¡ï¸ **PolÃ­tica de ContraseÃ±as**
Reglas que definen la complejidad, duraciÃ³n y renovaciÃ³n de las contraseÃ±as de usuario.

### ğŸ“‹ **Perfil de Usuario**
ConfiguraciÃ³n personalizada que incluye documentos, configuraciones y preferencias del usuario.

## Comandos Principales

### `NET USER`
Comando principal para gestionar usuarios locales del sistema.

**Sintaxis bÃ¡sica:**
```batch
net user [nombre_usuario] [contraseÃ±a] [opciones]
```

**Opciones principales:**
- `/add` - Crear nuevo usuario
- `/delete` - Eliminar usuario
- `/active:yes|no` - Activar/desactivar usuario
- `/expires:date|never` - Establecer fecha de expiraciÃ³n
- `/passwordchg:yes|no` - Permitir cambio de contraseÃ±a
- `/passwordreq:yes|no` - Requerir contraseÃ±a
- `/comment:"texto"` - Agregar comentario
- `/fullname:"nombre"` - Establecer nombre completo

### `NET LOCALGROUP`
Comando para gestionar grupos locales del sistema.

**Sintaxis:**
```batch
net localgroup [nombre_grupo] [opciones]
```

### `WMIC USERACCOUNT`
Comando avanzado para consultas detalladas sobre cuentas de usuario.

**Sintaxis:**
```batch
wmic useraccount [where] [get] [set]
```

### `PASSWD` (PowerShell)
Comando de PowerShell para cambiar contraseÃ±as de usuario.

**Sintaxis:**
```powershell
Set-LocalUser -Name "usuario" -Password "contraseÃ±a"
```

## Ejemplos PrÃ¡cticos

### 1. **Crear Usuario BÃ¡sico**
**PropÃ³sito:** Crear una nueva cuenta de usuario con configuraciÃ³n bÃ¡sica.

```batch
net user juan123 MiContraseÃ±a123 /add /fullname:"Juan PÃ©rez" /comment:"Empleado de IT"
```

**Casos de uso reales:**
- Nuevos empleados en la empresa
- Cuentas temporales para proyectos
- Usuarios de prueba para desarrollo

### 2. **Crear Usuario con ConfiguraciÃ³n Avanzada**
**PropÃ³sito:** Crear usuario con polÃ­ticas especÃ­ficas de seguridad.

```batch
net user maria456 MiContraseÃ±a456 /add /fullname:"MarÃ­a GarcÃ­a" /passwordchg:no /expires:12/31/2024
```

**Casos de uso reales:**
- Cuentas de servicio con restricciones
- Usuarios con acceso temporal
- Cuentas de auditorÃ­a con polÃ­ticas estrictas

### 3. **Eliminar Usuario**
**PropÃ³sito:** Eliminar completamente una cuenta de usuario del sistema.

```batch
net user carlos789 /delete
```

**Casos de uso reales:**
- Empleados que dejan la empresa
- Limpieza de cuentas temporales
- EliminaciÃ³n de cuentas comprometidas

### 4. **Desactivar Usuario**
**PropÃ³sito:** Desactivar temporalmente una cuenta sin eliminarla.

```batch
net user ana123 /active:no
```

**Casos de uso reales:**
- Suspensiones temporales
- Mantenimiento de cuentas
- Investigaciones de seguridad

### 5. **Cambiar ContraseÃ±a**
**PropÃ³sito:** Cambiar la contraseÃ±a de un usuario existente.

```batch
net user luis456 NuevaContraseÃ±a789
```

**Casos de uso reales:**
- RenovaciÃ³n de contraseÃ±as expiradas
- Reseteo de contraseÃ±as olvidadas
- Cambios de seguridad programados

### 6. **Agregar Usuario a Grupo**
**PropÃ³sito:** Asignar un usuario a un grupo especÃ­fico para otorgar permisos.

```batch
net localgroup Administradores juan123 /add
```

**Casos de uso reales:**
- AsignaciÃ³n de roles administrativos
- ConfiguraciÃ³n de permisos por departamento
- GestiÃ³n de acceso a recursos compartidos

### 7. **Listar Usuarios del Sistema**
**PropÃ³sito:** Ver todas las cuentas de usuario existentes en el sistema.

```batch
net user
```

**Casos de uso reales:**
- AuditorÃ­a de cuentas de usuario
- VerificaciÃ³n de cuentas activas
- Inventario de usuarios del sistema

### 8. **Ver InformaciÃ³n Detallada de Usuario**
**PropÃ³sito:** Obtener informaciÃ³n completa sobre una cuenta especÃ­fica.

```batch
net user maria456
```

**Casos de uso reales:**
- VerificaciÃ³n de configuraciÃ³n de cuenta
- DiagnÃ³stico de problemas de acceso
- AuditorÃ­a de polÃ­ticas de usuario

### 9. **Configurar PolÃ­tica de ContraseÃ±as**
**PropÃ³sito:** Establecer polÃ­ticas especÃ­ficas para la contraseÃ±a de un usuario.

```batch
net user pedro123 /passwordreq:yes /passwordchg:yes
```

**Casos de uso reales:**
- Cumplimiento de polÃ­ticas de seguridad
- ConfiguraciÃ³n de cuentas de alto privilegio
- GestiÃ³n de cuentas de servicio

### 10. **Crear Usuario con Fecha de ExpiraciÃ³n**
**PropÃ³sito:** Crear una cuenta que expire automÃ¡ticamente en una fecha especÃ­fica.

```batch
net user temporal123 TempPass456 /add /expires:06/30/2024 /comment:"Cuenta temporal para proyecto"
```

**Casos de uso reales:**
- Contratistas temporales
- Proyectos con fecha de finalizaciÃ³n
- Cuentas de prueba con expiraciÃ³n automÃ¡tica

## Scripts Avanzados

### Script para GestiÃ³n Avanzada de Usuarios

```batch
@echo off
:: Gestor avanzado de usuarios del sistema
title ğŸ‘¥ Gestor de Usuarios
color 0A

:menu
cls
echo ========================================
echo    ğŸ‘¥ GESTOR AVANZADO DE USUARIOS
echo ========================================
echo.
echo 1. â• Crear usuario
echo 2. âŒ Eliminar usuario
echo 3. ğŸ”„ Modificar usuario
echo 4. ğŸ‘ï¸ Ver usuarios
echo 5. ğŸ” Cambiar contraseÃ±a
echo 6. ğŸ‘¥ Gestionar grupos
echo 7. ğŸ“Š Reporte de usuarios
echo 8. ğŸšª Salir
echo.
set /p opcion="Selecciona una opciÃ³n: "

if "%opcion%"=="1" goto crear_usuario
if "%opcion%"=="2" goto eliminar_usuario
if "%opcion%"=="3" goto modificar_usuario
if "%opcion%"=="4" goto ver_usuarios
if "%opcion%"=="5" goto cambiar_password
if "%opcion%"=="6" goto gestionar_grupos
if "%opcion%"=="7" goto reporte_usuarios
if "%opcion%"=="8" goto salir
goto menu

:crear_usuario
cls
echo ========================================
echo         â• CREAR USUARIO
echo ========================================
echo.
set /p username="Nombre de usuario: "
set /p password="ContraseÃ±a: "
set /p fullname="Nombre completo: "
set /p comment="Comentario (opcional): "
set /p expires="Fecha de expiraciÃ³n (MM/DD/YYYY o never): "

echo ğŸ”„ Creando usuario...
net user %username% %password% /add /fullname:"%fullname%"
if defined comment net user %username% /comment:"%comment%"
if not "%expires%"=="never" net user %username% /expires:%expires%

echo âœ… Usuario creado exitosamente
pause
goto menu

:eliminar_usuario
cls
echo ========================================
echo         âŒ ELIMINAR USUARIO
echo ========================================
echo.
set /p username="Nombre de usuario a eliminar: "
echo âš ï¸ Â¿EstÃ¡s seguro de eliminar el usuario %username%?
set /p confirm="(S/N): "
if /i "%confirm%"=="S" (
    echo ğŸ”„ Eliminando usuario...
    net user %username% /delete
    echo âœ… Usuario eliminado
) else (
    echo âŒ OperaciÃ³n cancelada
)
pause
goto menu

:modificar_usuario
cls
echo ========================================
echo         ğŸ”„ MODIFICAR USUARIO
echo ========================================
echo.
set /p username="Nombre de usuario: "
echo 1. Activar/Desactivar
echo 2. Cambiar nombre completo
echo 3. Cambiar comentario
echo 4. Establecer fecha de expiraciÃ³n
echo.
set /p mod="Selecciona modificaciÃ³n: "

if "%mod%"=="1" (
    set /p active="Activar (S/N): "
    if /i "%active%"=="S" net user %username% /active:yes
    if /i "%active%"=="N" net user %username% /active:no
) else if "%mod%"=="2" (
    set /p fullname="Nuevo nombre completo: "
    net user %username% /fullname:"%fullname%"
) else if "%mod%"=="3" (
    set /p comment="Nuevo comentario: "
    net user %username% /comment:"%comment%"
) else if "%mod%"=="4" (
    set /p expires="Nueva fecha de expiraciÃ³n: "
    net user %username% /expires:%expires%
)

echo âœ… Usuario modificado
pause
goto menu

:ver_usuarios
cls
echo ========================================
echo         ğŸ‘ï¸ VER USUARIOS
echo ========================================
echo.
echo ğŸ” Listando usuarios del sistema...
net user
echo.
pause
goto menu

:cambiar_password
cls
echo ========================================
echo         ğŸ” CAMBIAR CONTRASEÃ‘A
echo ========================================
echo.
set /p username="Nombre de usuario: "
set /p password="Nueva contraseÃ±a: "
echo ğŸ”„ Cambiando contraseÃ±a...
net user %username% %password%
echo âœ… ContraseÃ±a cambiada
pause
goto menu

:gestionar_grupos
cls
echo ========================================
echo         ğŸ‘¥ GESTIONAR GRUPOS
echo ========================================
echo.
set /p username="Nombre de usuario: "
echo 1. Agregar a grupo
echo 2. Remover de grupo
echo 3. Ver grupos del usuario
echo.
set /p op="Selecciona opciÃ³n: "

if "%op%"=="1" (
    set /p group="Nombre del grupo: "
    net localgroup %group% %username% /add
    echo âœ… Usuario agregado al grupo
) else if "%op%"=="2" (
    set /p group="Nombre del grupo: "
    net localgroup %group% %username% /delete
    echo âœ… Usuario removido del grupo
) else if "%op%"=="3" (
    echo ğŸ” Grupos del usuario %username%:
    net user %username%
)
pause
goto menu

:reporte_usuarios
cls
echo ========================================
echo         ğŸ“Š REPORTE DE USUARIOS
echo ========================================
echo.
echo ğŸ”„ Generando reporte...
echo === REPORTE DE USUARIOS === > reporte_usuarios.txt
echo Fecha: %date% %time% >> reporte_usuarios.txt
echo. >> reporte_usuarios.txt
net user >> reporte_usuarios.txt
echo. >> reporte_usuarios.txt
echo === GRUPOS === >> reporte_usuarios.txt
net localgroup >> reporte_usuarios.txt
echo âœ… Reporte generado en reporte_usuarios.txt
pause
goto menu

:salir
exit
```

### Script para CreaciÃ³n Masiva de Usuarios

```batch
@echo off
:: CreaciÃ³n masiva de usuarios desde archivo CSV
title ğŸ“‹ CreaciÃ³n Masiva de Usuarios
color 0A

echo ========================================
echo    ğŸ“‹ CREACIÃ“N MASIVA DE USUARIOS
echo ========================================
echo.

:menu
echo 1. ğŸ“„ Crear usuarios desde CSV
echo 2. ğŸ”„ Crear usuarios de prueba
echo 3. ğŸ“Š Verificar usuarios creados
echo 4. ğŸšª Salir
echo.
set /p opcion="Selecciona opciÃ³n: "

if "%opcion%"=="1" goto crear_desde_csv
if "%opcion%"=="2" goto crear_prueba
if "%opcion%"=="3" goto verificar_usuarios
if "%opcion%"=="4" goto salir
goto menu

:crear_desde_csv
cls
echo ========================================
echo         ğŸ“„ CREAR DESDE CSV
echo ========================================
echo.
set /p archivo="Archivo CSV (usuario,contraseÃ±a,nombre,grupo): "
if exist "%archivo%" (
    echo ğŸ”„ Procesando archivo CSV...
    for /f "tokens=1-4 delims=," %%a in (%archivo%) do (
        echo Creando usuario: %%a
        net user %%a %%b /add /fullname:"%%c"
        if not "%%d"=="" net localgroup %%d %%a /add
    )
    echo âœ… Usuarios creados desde CSV
) else (
    echo âŒ Archivo no encontrado
)
pause
goto menu

:crear_prueba
cls
echo ========================================
echo         ğŸ”„ CREAR USUARIOS DE PRUEBA
echo ========================================
echo.
set /p cantidad="Cantidad de usuarios: "
set /p prefijo="Prefijo (ej: test): "
echo ğŸ”„ Creando usuarios de prueba...
for /l %%i in (1,1,%cantidad%) do (
    set username=%prefijo%%%i
    set password=Test%%i123
    net user !username! !password! /add /fullname:"Usuario de Prueba %%i"
    echo Usuario creado: !username!
)
echo âœ… Usuarios de prueba creados
pause
goto menu

:verificar_usuarios
cls
echo ========================================
echo         ğŸ“Š VERIFICAR USUARIOS
echo ========================================
echo.
echo ğŸ” Verificando usuarios activos...
net user | findstr /v "Comando completado"
echo.
echo === USUARIOS RECIENTES ===
wmic useraccount get name,disabled,lockout 2>nul
pause
goto menu

:salir
exit
```

## Consejos Importantes

### âš¡ **OptimizaciÃ³n**
- Usa nombres de usuario consistentes y descriptivos
- Implementa polÃ­ticas de contraseÃ±as seguras
- MantÃ©n un inventario actualizado de usuarios

### ğŸ›¡ï¸ **Seguridad**
- Revisa regularmente las cuentas de usuario
- Implementa polÃ­ticas de expiraciÃ³n de contraseÃ±as
- Usa grupos para gestionar permisos eficientemente

### ğŸ”§ **Mejores PrÃ¡cticas**
- Documenta cambios en cuentas de usuario
- Usa comentarios para identificar el propÃ³sito de cada cuenta
- Implementa procesos de onboarding y offboarding

## Casos de Uso Reales

### ğŸ¢ **AdministraciÃ³n de Sistemas**
- GestiÃ³n de cuentas de empleados
- ConfiguraciÃ³n de cuentas de servicio
- AuditorÃ­a de seguridad de usuarios

### ğŸ« **Entornos Educativos**
- CreaciÃ³n masiva de cuentas de estudiantes
- GestiÃ³n de cuentas de profesores
- ConfiguraciÃ³n de laboratorios de computaciÃ³n

### ğŸ­ **Entornos Empresariales**
- Procesos de onboarding de empleados
- GestiÃ³n de cuentas de contratistas
- Cumplimiento de polÃ­ticas de seguridad

## ConclusiÃ³n y Siguiente Paso

Has dominado la gestiÃ³n de usuarios desde la lÃ­nea de comandos. Ahora puedes crear, modificar y administrar cuentas de usuario de manera profesional y eficiente, sin depender de herramientas grÃ¡ficas.

En el siguiente capÃ­tulo, exploraremos cÃ³mo **Habilitar el usuario Administrador**, una tarea crÃ­tica para la administraciÃ³n de sistemas. Â¿Te imaginas recuperando acceso a un servidor cuando todas las cuentas administrativas estÃ¡n bloqueadas? Â¡Esa serÃ¡ tu prÃ³xima habilidad!

---

## Enlaces Relacionados

- [CapÃ­tulo 31: Apagar, Reiniciar y Cerrar sesiÃ³n](31.%20Apagar,%20Reiniciar%20y%20Cerrar%20sesiÃ³n.md)
- [CapÃ­tulo 33: Habilitar usuario Administrador](33.%20Habilitar%20usuario%20Administrador.md)
- [CapÃ­tulo 40: Ejecutar como Administrador - RUNAS](40.%20Ejecutar%20como%20Administrador%20-%20RUNAS.md)

## Fuentes y Referencias

- **DocumentaciÃ³n oficial de Microsoft:** [Net User Command](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/net-user)
- **Windows Command Line Reference:** [User Management Commands](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands)
- **AdministraciÃ³n de Windows Server:** [User Account Management](https://docs.microsoft.com/en-us/windows-server/administration/)

---

**Autor:** Jerson MartÃ­nez  
**Sitio web:** [jersonmartinez.com](https://jersonmartinez.com)  
**Blog DevOps:** [crashell.com](https://crashell.com) 
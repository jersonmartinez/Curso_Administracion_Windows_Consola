# 32. Gesti√≥n de usuarios

> *"En el coraz√≥n de cualquier sistema operativo est√°n sus usuarios. ¬øSab√≠as que puedes gestionar cientos de cuentas de usuario desde la l√≠nea de comandos sin tocar una interfaz gr√°fica?"* üë•

## Introducci√≥n

La gesti√≥n de usuarios es una de las tareas m√°s fundamentales en la administraci√≥n de sistemas Windows. Desde crear cuentas para nuevos empleados hasta configurar pol√≠ticas de seguridad, cada acci√≥n que realizas afecta la experiencia y seguridad de los usuarios.

¬øTe imaginas administrando un servidor corporativo con 500 empleados? ¬øO configurando un laboratorio de computadoras para 200 estudiantes? Estas tareas, que parecer√≠an imposibles sin herramientas gr√°ficas, se vuelven simples y eficientes cuando dominas los comandos de l√≠nea de comandos.

En este cap√≠tulo, aprender√°s a crear, modificar, eliminar y administrar usuarios de manera profesional, desde operaciones b√°sicas hasta escenarios empresariales complejos.

## Conceptos Clave

### üë§ **Usuario del Sistema**
Una cuenta que permite a una persona acceder y utilizar los recursos del sistema operativo.

### üîê **Grupo de Usuarios**
Una colecci√≥n de usuarios que comparten los mismos permisos y privilegios en el sistema.

### üõ°Ô∏è **Pol√≠tica de Contrase√±as**
Reglas que definen la complejidad, duraci√≥n y renovaci√≥n de las contrase√±as de usuario.

### üìã **Perfil de Usuario**
Configuraci√≥n personalizada que incluye documentos, configuraciones y preferencias del usuario.

## Comandos Principales

### `NET USER`
Comando principal para gestionar usuarios locales del sistema.

**Sintaxis b√°sica:**
```batch
net user [nombre_usuario] [contrase√±a] [opciones]
```

**Opciones principales:**
- `/add` - Crear nuevo usuario
- `/delete` - Eliminar usuario
- `/active:yes|no` - Activar/desactivar usuario
- `/expires:date|never` - Establecer fecha de expiraci√≥n
- `/passwordchg:yes|no` - Permitir cambio de contrase√±a
- `/passwordreq:yes|no` - Requerir contrase√±a
- `/comment:"texto"` - Agregar comentario
- `/fullname:"nombre"` - Establecer nombre completo

### `NET LOCALGROUP`
Comando para gestionar grupos locales del sistema.

**Sintaxis:**
```batch
net localgroup [nombre_grupo] [opciones]
```

### `WMIC USERACCOUNT`
Comando avanzado para consultas detalladas sobre cuentas de usuario.

**Sintaxis:**
```batch
wmic useraccount [where] [get] [set]
```

### `PASSWD` (PowerShell)
Comando de PowerShell para cambiar contrase√±as de usuario.

**Sintaxis:**
```powershell
Set-LocalUser -Name "usuario" -Password "contrase√±a"
```

## Ejemplos Pr√°cticos

### 1. **Crear Usuario B√°sico**
**Prop√≥sito:** Crear una nueva cuenta de usuario con configuraci√≥n b√°sica.

```batch
net user juan123 MiContrase√±a123 /add /fullname:"Juan P√©rez" /comment:"Empleado de IT"
```

**Casos de uso reales:**
- Nuevos empleados en la empresa
- Cuentas temporales para proyectos
- Usuarios de prueba para desarrollo

### 2. **Crear Usuario con Configuraci√≥n Avanzada**
**Prop√≥sito:** Crear usuario con pol√≠ticas espec√≠ficas de seguridad.

```batch
net user maria456 MiContrase√±a456 /add /fullname:"Mar√≠a Garc√≠a" /passwordchg:no /expires:12/31/2024
```

**Casos de uso reales:**
- Cuentas de servicio con restricciones
- Usuarios con acceso temporal
- Cuentas de auditor√≠a con pol√≠ticas estrictas

### 3. **Eliminar Usuario**
**Prop√≥sito:** Eliminar completamente una cuenta de usuario del sistema.

```batch
net user carlos789 /delete
```

**Casos de uso reales:**
- Empleados que dejan la empresa
- Limpieza de cuentas temporales
- Eliminaci√≥n de cuentas comprometidas

### 4. **Desactivar Usuario**
**Prop√≥sito:** Desactivar temporalmente una cuenta sin eliminarla.

```batch
net user ana123 /active:no
```

**Casos de uso reales:**
- Suspensiones temporales
- Mantenimiento de cuentas
- Investigaciones de seguridad

### 5. **Cambiar Contrase√±a**
**Prop√≥sito:** Cambiar la contrase√±a de un usuario existente.

```batch
net user luis456 NuevaContrase√±a789
```

**Casos de uso reales:**
- Renovaci√≥n de contrase√±as expiradas
- Reseteo de contrase√±as olvidadas
- Cambios de seguridad programados

### 6. **Agregar Usuario a Grupo**
**Prop√≥sito:** Asignar un usuario a un grupo espec√≠fico para otorgar permisos.

```batch
net localgroup Administradores juan123 /add
```

**Casos de uso reales:**
- Asignaci√≥n de roles administrativos
- Configuraci√≥n de permisos por departamento
- Gesti√≥n de acceso a recursos compartidos

### 7. **Listar Usuarios del Sistema**
**Prop√≥sito:** Ver todas las cuentas de usuario existentes en el sistema.

```batch
net user
```

**Casos de uso reales:**
- Auditor√≠a de cuentas de usuario
- Verificaci√≥n de cuentas activas
- Inventario de usuarios del sistema

### 8. **Ver Informaci√≥n Detallada de Usuario**
**Prop√≥sito:** Obtener informaci√≥n completa sobre una cuenta espec√≠fica.

```batch
net user maria456
```

**Casos de uso reales:**
- Verificaci√≥n de configuraci√≥n de cuenta
- Diagn√≥stico de problemas de acceso
- Auditor√≠a de pol√≠ticas de usuario

### 9. **Configurar Pol√≠tica de Contrase√±as**
**Prop√≥sito:** Establecer pol√≠ticas espec√≠ficas para la contrase√±a de un usuario.

```batch
net user pedro123 /passwordreq:yes /passwordchg:yes
```

**Casos de uso reales:**
- Cumplimiento de pol√≠ticas de seguridad
- Configuraci√≥n de cuentas de alto privilegio
- Gesti√≥n de cuentas de servicio

### 10. **Crear Usuario con Fecha de Expiraci√≥n**
**Prop√≥sito:** Crear una cuenta que expire autom√°ticamente en una fecha espec√≠fica.

```batch
net user temporal123 TempPass456 /add /expires:06/30/2024 /comment:"Cuenta temporal para proyecto"
```

**Casos de uso reales:**
- Contratistas temporales
- Proyectos con fecha de finalizaci√≥n
- Cuentas de prueba con expiraci√≥n autom√°tica

## Scripts Avanzados

### Script para Gesti√≥n Avanzada de Usuarios

```batch
@echo off
:: Gestor avanzado de usuarios del sistema
title üë• Gestor de Usuarios
color 0A

:menu
cls
echo ========================================
echo    üë• GESTOR AVANZADO DE USUARIOS
echo ========================================
echo.
echo 1. ‚ûï Crear usuario
echo 2. ‚ùå Eliminar usuario
echo 3. üîÑ Modificar usuario
echo 4. üëÅÔ∏è Ver usuarios
echo 5. üîê Cambiar contrase√±a
echo 6. üë• Gestionar grupos
echo 7. üìä Reporte de usuarios
echo 8. üö™ Salir
echo.
set /p opcion="Selecciona una opci√≥n: "

if "%opcion%"=="1" goto crear_usuario
if "%opcion%"=="2" goto eliminar_usuario
if "%opcion%"=="3" goto modificar_usuario
if "%opcion%"=="4" goto ver_usuarios
if "%opcion%"=="5" goto cambiar_password
if "%opcion%"=="6" goto gestionar_grupos
if "%opcion%"=="7" goto reporte_usuarios
if "%opcion%"=="8" goto salir
goto menu

:crear_usuario
cls
echo ========================================
echo         ‚ûï CREAR USUARIO
echo ========================================
echo.
set /p username="Nombre de usuario: "
set /p password="Contrase√±a: "
set /p fullname="Nombre completo: "
set /p comment="Comentario (opcional): "
set /p expires="Fecha de expiraci√≥n (MM/DD/YYYY o never): "

echo üîÑ Creando usuario...
net user %username% %password% /add /fullname:"%fullname%"
if defined comment net user %username% /comment:"%comment%"
if not "%expires%"=="never" net user %username% /expires:%expires%

echo ‚úÖ Usuario creado exitosamente
pause
goto menu

:eliminar_usuario
cls
echo ========================================
echo         ‚ùå ELIMINAR USUARIO
echo ========================================
echo.
set /p username="Nombre de usuario a eliminar: "
echo ‚ö†Ô∏è ¬øEst√°s seguro de eliminar el usuario %username%?
set /p confirm="(S/N): "
if /i "%confirm%"=="S" (
    echo üîÑ Eliminando usuario...
    net user %username% /delete
    echo ‚úÖ Usuario eliminado
) else (
    echo ‚ùå Operaci√≥n cancelada
)
pause
goto menu

:modificar_usuario
cls
echo ========================================
echo         üîÑ MODIFICAR USUARIO
echo ========================================
echo.
set /p username="Nombre de usuario: "
echo 1. Activar/Desactivar
echo 2. Cambiar nombre completo
echo 3. Cambiar comentario
echo 4. Establecer fecha de expiraci√≥n
echo.
set /p mod="Selecciona modificaci√≥n: "

if "%mod%"=="1" (
    set /p active="Activar (S/N): "
    if /i "%active%"=="S" net user %username% /active:yes
    if /i "%active%"=="N" net user %username% /active:no
) else if "%mod%"=="2" (
    set /p fullname="Nuevo nombre completo: "
    net user %username% /fullname:"%fullname%"
) else if "%mod%"=="3" (
    set /p comment="Nuevo comentario: "
    net user %username% /comment:"%comment%"
) else if "%mod%"=="4" (
    set /p expires="Nueva fecha de expiraci√≥n: "
    net user %username% /expires:%expires%
)

echo ‚úÖ Usuario modificado
pause
goto menu

:ver_usuarios
cls
echo ========================================
echo         üëÅÔ∏è VER USUARIOS
echo ========================================
echo.
echo üîç Listando usuarios del sistema...
net user
echo.
pause
goto menu

:cambiar_password
cls
echo ========================================
echo         üîê CAMBIAR CONTRASE√ëA
echo ========================================
echo.
set /p username="Nombre de usuario: "
set /p password="Nueva contrase√±a: "
echo üîÑ Cambiando contrase√±a...
net user %username% %password%
echo ‚úÖ Contrase√±a cambiada
pause
goto menu

:gestionar_grupos
cls
echo ========================================
echo         üë• GESTIONAR GRUPOS
echo ========================================
echo.
set /p username="Nombre de usuario: "
echo 1. Agregar a grupo
echo 2. Remover de grupo
echo 3. Ver grupos del usuario
echo.
set /p op="Selecciona opci√≥n: "

if "%op%"=="1" (
    set /p group="Nombre del grupo: "
    net localgroup %group% %username% /add
    echo ‚úÖ Usuario agregado al grupo
) else if "%op%"=="2" (
    set /p group="Nombre del grupo: "
    net localgroup %group% %username% /delete
    echo ‚úÖ Usuario removido del grupo
) else if "%op%"=="3" (
    echo üîç Grupos del usuario %username%:
    net user %username%
)
pause
goto menu

:reporte_usuarios
cls
echo ========================================
echo         üìä REPORTE DE USUARIOS
echo ========================================
echo.
echo üîÑ Generando reporte...
echo === REPORTE DE USUARIOS === > reporte_usuarios.txt
echo Fecha: %date% %time% >> reporte_usuarios.txt
echo. >> reporte_usuarios.txt
net user >> reporte_usuarios.txt
echo. >> reporte_usuarios.txt
echo === GRUPOS === >> reporte_usuarios.txt
net localgroup >> reporte_usuarios.txt
echo ‚úÖ Reporte generado en reporte_usuarios.txt
pause
goto menu

:salir
exit
```

### Script para Creaci√≥n Masiva de Usuarios

```batch
@echo off
:: Creaci√≥n masiva de usuarios desde archivo CSV
title üìã Creaci√≥n Masiva de Usuarios
color 0A

echo ========================================
echo    üìã CREACI√ìN MASIVA DE USUARIOS
echo ========================================
echo.

:menu
echo 1. üìÑ Crear usuarios desde CSV
echo 2. üîÑ Crear usuarios de prueba
echo 3. üìä Verificar usuarios creados
echo 4. üö™ Salir
echo.
set /p opcion="Selecciona opci√≥n: "

if "%opcion%"=="1" goto crear_desde_csv
if "%opcion%"=="2" goto crear_prueba
if "%opcion%"=="3" goto verificar_usuarios
if "%opcion%"=="4" goto salir
goto menu

:crear_desde_csv
cls
echo ========================================
echo         üìÑ CREAR DESDE CSV
echo ========================================
echo.
set /p archivo="Archivo CSV (usuario,contrase√±a,nombre,grupo): "
if exist "%archivo%" (
    echo üîÑ Procesando archivo CSV...
    for /f "tokens=1-4 delims=," %%a in (%archivo%) do (
        echo Creando usuario: %%a
        net user %%a %%b /add /fullname:"%%c"
        if not "%%d"=="" net localgroup %%d %%a /add
    )
    echo ‚úÖ Usuarios creados desde CSV
) else (
    echo ‚ùå Archivo no encontrado
)
pause
goto menu

:crear_prueba
cls
echo ========================================
echo         üîÑ CREAR USUARIOS DE PRUEBA
echo ========================================
echo.
set /p cantidad="Cantidad de usuarios: "
set /p prefijo="Prefijo (ej: test): "
echo üîÑ Creando usuarios de prueba...
for /l %%i in (1,1,%cantidad%) do (
    set username=%prefijo%%%i
    set password=Test%%i123
    net user !username! !password! /add /fullname:"Usuario de Prueba %%i"
    echo Usuario creado: !username!
)
echo ‚úÖ Usuarios de prueba creados
pause
goto menu

:verificar_usuarios
cls
echo ========================================
echo         üìä VERIFICAR USUARIOS
echo ========================================
echo.
echo üîç Verificando usuarios activos...
net user | findstr /v "Comando completado"
echo.
echo === USUARIOS RECIENTES ===
wmic useraccount get name,disabled,lockout 2>nul
pause
goto menu

:salir
exit
```

## Consejos Importantes

### ‚ö° **Optimizaci√≥n**
- Usa nombres de usuario consistentes y descriptivos
- Implementa pol√≠ticas de contrase√±as seguras
- Mant√©n un inventario actualizado de usuarios

### üõ°Ô∏è **Seguridad**
- Revisa regularmente las cuentas de usuario
- Implementa pol√≠ticas de expiraci√≥n de contrase√±as
- Usa grupos para gestionar permisos eficientemente

### üîß **Mejores Pr√°cticas**
- Documenta cambios en cuentas de usuario
- Usa comentarios para identificar el prop√≥sito de cada cuenta
- Implementa procesos de onboarding y offboarding

## Casos de Uso Reales

### üè¢ **Administraci√≥n de Sistemas**
- Gesti√≥n de cuentas de empleados
- Configuraci√≥n de cuentas de servicio
- Auditor√≠a de seguridad de usuarios

### üè´ **Entornos Educativos**
- Creaci√≥n masiva de cuentas de estudiantes
- Gesti√≥n de cuentas de profesores
- Configuraci√≥n de laboratorios de computaci√≥n

### üè≠ **Entornos Empresariales**
- Procesos de onboarding de empleados
- Gesti√≥n de cuentas de contratistas
- Cumplimiento de pol√≠ticas de seguridad

## Conclusi√≥n y Siguiente Paso

Has dominado la gesti√≥n de usuarios desde la l√≠nea de comandos. Ahora puedes crear, modificar y administrar cuentas de usuario de manera profesional y eficiente, sin depender de herramientas gr√°ficas.

En el siguiente cap√≠tulo, exploraremos c√≥mo **Habilitar el usuario Administrador**, una tarea cr√≠tica para la administraci√≥n de sistemas. ¬øTe imaginas recuperando acceso a un servidor cuando todas las cuentas administrativas est√°n bloqueadas? ¬°Esa ser√° tu pr√≥xima habilidad!

---

## Enlaces Relacionados

- [Cap√≠tulo 31: Apagar, Reiniciar y Cerrar sesi√≥n](31.%20Apagar,%20Reiniciar%20y%20Cerrar%20sesi√≥n.md)
- [Cap√≠tulo 33: Habilitar usuario Administrador](33.%20Habilitar%20usuario%20Administrador.md)
- [Cap√≠tulo 40: Ejecutar como Administrador - RUNAS](40.%20Ejecutar%20como%20Administrador%20-%20RUNAS.md)

## Fuentes y Referencias

- **Documentaci√≥n oficial de Microsoft:** [Net User Command](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/net-user)
- **Windows Command Line Reference:** [User Management Commands](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands)
- **Administraci√≥n de Windows Server:** [User Account Management](https://docs.microsoft.com/en-us/windows-server/administration/)

---

**Autor:** Jerson Mart√≠nez  
**Sitio web:** [jersonmartinez.com](https://jersonmartinez.com)  
**Blog DevOps:** [crashell.com](https://crashell.com) 
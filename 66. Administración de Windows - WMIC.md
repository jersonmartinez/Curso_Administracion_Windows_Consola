# 🔧 Administración de Windows - WMIC

> *"WMIC es la llave maestra de Windows. Con él, puedes consultar y controlar cualquier aspecto del sistema"* - **Principio fundamental de la administración avanzada**

## 📋 Introducción

¿Te has preguntado alguna vez cómo los administradores de sistemas obtienen información detallada de miles de equipos remotamente? ¿Cómo automatizan tareas complejas de administración en entornos empresariales? En este capítulo, exploraremos las técnicas avanzadas de Windows Management Instrumentation (WMIC).

WMIC es una herramienta poderosa que permite acceder a información del sistema, gestionar configuraciones, y automatizar tareas administrativas de manera programática. Aprenderemos a utilizar WMIC para consultar hardware, gestionar software, y crear scripts de administración avanzados.

## 🎯 Conceptos Clave

### **WMI (Windows Management Instrumentation)**
Infraestructura de gestión que proporciona acceso a información del sistema operativo y hardware.

### **WMIC (Windows Management Instrumentation Command)**
Interfaz de línea de comandos para acceder a WMI de manera programática.

### **CIM (Common Information Model)**
Estándar que define cómo representar información de sistemas de manera consistente.

### **Namespace**
Contenedor lógico que organiza clases WMI relacionadas.

## 🛠️ Comandos Principales

### **WMIC**
```batch
WMIC CPU GET Name,NumberOfCores,MaxClockSpeed
```
Consulta información del procesador del sistema.

### **WMIC PROCESS**
```batch
WMIC PROCESS WHERE "Name='explorer.exe'" GET ProcessId,WorkingSetSize
```
Obtiene información de procesos específicos.

### **WMIC SERVICE**
```batch
WMIC SERVICE WHERE "StartMode='Auto'" GET Name,State
```
Lista servicios con inicio automático.

### **WMIC PRODUCT**
```batch
WMIC PRODUCT GET Name,Version,Vendor
```
Obtiene información de software instalado.

## 💡 Ejemplos Prácticos

### **Ejemplo 1: Consultar información del sistema**
**Propósito**: Comprender cómo usar WMIC para obtener información detallada del sistema operativo y hardware.

**Explicación del comando**: `WMIC` con diferentes clases permite acceder a información específica del sistema. Las clases como `OS`, `COMPUTERSYSTEM`, y `BIOS` proporcionan datos fundamentales para la administración.

```batch
@echo off
echo ========================================
echo    CONSULTAR INFORMACION DEL SISTEMA
echo ========================================
echo.

echo Consultando informacion del sistema...
echo Consulta iniciada: %date% %time%

REM Información del sistema operativo
echo === INFORMACION DEL SISTEMA OPERATIVO ===
wmic os get Caption,Version,BuildNumber,OSArchitecture /format:table

REM Información del equipo
echo.
echo === INFORMACION DEL EQUIPO ===
wmic computersystem get Name,Manufacturer,Model,TotalPhysicalMemory /format:table

REM Información de la BIOS
echo.
echo === INFORMACION DE LA BIOS ===
wmic bios get Manufacturer,Version,ReleaseDate /format:table

REM Información del procesador
echo.
echo === INFORMACION DEL PROCESADOR ===
wmic cpu get Name,NumberOfCores,MaxClockSpeed /format:table

echo Consulta de informacion del sistema completada
pause
```

### **Ejemplo 2: Gestionar procesos del sistema**
**Propósito**: Aprender a usar WMIC para gestionar procesos del sistema, incluyendo monitoreo y control.

**Explicación del comando**: `WMIC PROCESS` permite consultar y gestionar procesos del sistema. Con filtros WHERE podemos obtener información específica de procesos.

```batch
@echo off
echo ========================================
echo    GESTIONAR PROCESOS DEL SISTEMA
echo ========================================
echo.

echo Gestionando procesos del sistema...
echo Gestion iniciada: %date% %time%

REM Listar procesos con mayor uso de memoria
echo === PROCESOS CON MAYOR USO DE MEMORIA ===
wmic process where "WorkingSetSize>100000000" get Name,ProcessId,WorkingSetSize /format:table

REM Información de procesos específicos
echo.
echo === INFORMACION DE PROCESOS ESPECIFICOS ===
for %%p in (explorer.exe svchost.exe) do (
    echo --- Proceso: %%p ---
    wmic process where "Name='%%p'" get ProcessId,WorkingSetSize,VirtualSize /format:table
)

REM Procesos del usuario actual
echo.
echo === PROCESOS DEL USUARIO ACTUAL ===
wmic process where "ExecutablePath like '%%%USERNAME%%%'" get Name,ProcessId,WorkingSetSize /format:table

echo Gestion de procesos completada
pause
```

### **Ejemplo 3: Gestionar servicios del sistema**
**Propósito**: Utilizar WMIC para gestionar servicios del sistema de manera programática.

**Explicación del comando**: `WMIC SERVICE` permite consultar y gestionar servicios del sistema. Es útil para automatizar tareas de administración de servicios.

```batch
@echo off
echo ========================================
echo    GESTIONAR SERVICIOS DEL SISTEMA
echo ========================================
echo.

echo Gestionando servicios del sistema...
echo Gestion iniciada: %date% %time%

REM Servicios en ejecución
echo === SERVICIOS EN EJECUCION ===
wmic service where "State='Running'" get Name,DisplayName,StartMode /format:table

REM Servicios con inicio automático
echo.
echo === SERVICIOS CON INICIO AUTOMATICO ===
wmic service where "StartMode='Auto'" get Name,DisplayName,State /format:table

REM Servicios detenidos
echo.
echo === SERVICIOS DETENIDOS ===
wmic service where "State='Stopped'" get Name,DisplayName,StartMode /format:table

REM Información de servicios críticos
echo.
echo === INFORMACION DE SERVICIOS CRITICOS ===
for %%s in (spooler eventlog themes) do (
    echo --- Servicio: %%s ---
    wmic service where "Name='%%s'" get Name,DisplayName,State,StartMode /format:table
)

echo Gestion de servicios completada
pause
```

### **Ejemplo 4: Gestionar software instalado**
**Propósito**: Usar WMIC para obtener información detallada del software instalado en el sistema.

**Explicación del comando**: `WMIC PRODUCT` permite consultar información del software instalado a través de Windows Installer.

```batch
@echo off
echo ========================================
echo    GESTIONAR SOFTWARE INSTALADO
echo ========================================
echo.

echo Gestionando software instalado...
echo Gestion iniciada: %date% %time%

REM Listar todo el software instalado
echo === SOFTWARE INSTALADO ===
wmic product get Name,Version,Vendor /format:table

REM Software de Microsoft
echo.
echo === SOFTWARE DE MICROSOFT ===
wmic product where "Vendor like '%%Microsoft%%'" get Name,Version,InstallDate /format:table

REM Software recientemente instalado
echo.
echo === SOFTWARE RECIENTEMENTE INSTALADO ===
wmic product where "InstallDate>'20240101'" get Name,Version,InstallDate /format:table

REM Información de aplicaciones específicas
echo.
echo === INFORMACION DE APLICACIONES ESPECIFICAS ===
for %%a in (Office Chrome Firefox) do (
    echo --- Aplicacion: %%a ---
    wmic product where "Name like '%%%%a%%'" get Name,Version,Vendor,InstallDate /format:table
)

echo Gestion de software completada
pause
```

### **Ejemplo 5: Monitorear rendimiento del sistema**
**Propósito**: Crear un sistema de monitoreo de rendimiento usando WMIC para obtener métricas del sistema.

**Explicación del comando**: Este ejemplo combina múltiples clases WMIC para crear un sistema de monitoreo integral del rendimiento.

```batch
@echo off
echo ========================================
echo    MONITOREAR RENDIMIENTO DEL SISTEMA
echo ========================================
echo.

echo Monitoreando rendimiento del sistema...
echo Monitoreo iniciado: %date% %time%

REM Configuración
set "log_file=rendimiento_%date:~-4,4%%date:~-10,2%%date:~-7,2%.log"

REM Crear archivo de log
echo Monitoreo de rendimiento - %date% %time% > %log_file%

REM Información de memoria
echo === INFORMACION DE MEMORIA ===
wmic OS get TotalVisibleMemorySize,FreePhysicalMemory /format:table >> %log_file%

REM Información de CPU
echo === INFORMACION DE CPU ===
wmic cpu get LoadPercentage,NumberOfCores /format:table >> %log_file%

REM Información de disco
echo === INFORMACION DE DISCO ===
wmic logicaldisk get DeviceID,Size,FreeSpace /format:table >> %log_file%

REM Procesos con mayor uso de recursos
echo === PROCESOS CON MAYOR USO DE RECURSOS ===
wmic process where "WorkingSetSize>50000000" get Name,WorkingSetSize /format:table >> %log_file%

echo Monitoreo de rendimiento completado
echo Log guardado en: %log_file%
pause
```

## 🔧 Scripts Avanzados

### **Script para Administración Completa con WMIC**

```batch
@echo off
setlocal enabledelayedexpansion
title ADMINISTRACION COMPLETA CON WMIC

echo ========================================
echo  ADMINISTRACION COMPLETA CON WMIC
echo ========================================
echo.

:menu_principal
cls
echo ========================================
echo    ADMINISTRACION COMPLETA CON WMIC
echo ========================================
echo.
echo 1. Informacion del sistema
echo 2. Gestionar procesos
echo 3. Gestionar servicios
echo 4. Gestionar software
echo 5. Monitorear rendimiento
echo 6. Informacion de hardware
echo 7. Salir
echo.
set /p opcion="Seleccione una opcion: "

if "%opcion%"=="1" goto info_sistema
if "%opcion%"=="2" goto gestionar_procesos
if "%opcion%"=="3" goto gestionar_servicios
if "%opcion%"=="4" goto gestionar_software
if "%opcion%"=="5" goto monitorear_rendimiento
if "%opcion%"=="6" goto info_hardware
if "%opcion%"=="7" goto salir
goto menu_principal

:info_sistema
echo.
echo === INFORMACION DEL SISTEMA ===
echo.
wmic os get Caption,Version,OSArchitecture /format:table
wmic computersystem get Name,Manufacturer,Model /format:table
pause
goto menu_principal

:gestionar_procesos
echo.
echo === GESTIONAR PROCESOS ===
echo.
wmic process where "WorkingSetSize>100000000" get Name,ProcessId,WorkingSetSize /format:table
pause
goto menu_principal

:gestionar_servicios
echo.
echo === GESTIONAR SERVICIOS ===
echo.
wmic service where "State='Running'" get Name,DisplayName /format:table
pause
goto menu_principal

:gestionar_software
echo.
echo === GESTIONAR SOFTWARE ===
echo.
wmic product get Name,Version,Vendor /format:table
pause
goto menu_principal

:monitorear_rendimiento
echo.
echo === MONITOREAR RENDIMIENTO ===
echo.
wmic OS get TotalVisibleMemorySize,FreePhysicalMemory /format:table
wmic cpu get LoadPercentage /format:table
pause
goto menu_principal

:info_hardware
echo.
echo === INFORMACION DE HARDWARE ===
echo.
wmic cpu get Name,NumberOfCores,MaxClockSpeed /format:table
wmic memorychip get Capacity,Speed /format:table
pause
goto menu_principal

:salir
echo Gracias por usar la Administracion Completa con WMIC
exit
```

## 💡 Consejos Importantes

### **Optimización**
- Usa filtros WHERE para consultas más eficientes
- Limita los campos consultados con GET
- Utiliza formatos de salida apropiados

### **Seguridad**
- Ejecuta WMIC con privilegios mínimos necesarios
- Valida consultas antes de ejecutarlas
- Mantén logs de operaciones administrativas

### **Mejores Prácticas**
- Documenta las consultas WMIC utilizadas
- Establece políticas de administración remota
- Realiza pruebas de consultas en entornos controlados

## 🌍 Casos de Uso Reales

### **Administración de Sistemas**
- Inventario automatizado de hardware y software
- Monitoreo remoto de sistemas
- Automatización de tareas administrativas

### **Empresarial**
- Gestión centralizada de activos IT
- Cumplimiento de políticas corporativas
- Auditoría de sistemas

### **Desarrollo y Testing**
- Validación de requisitos de sistema
- Testing de aplicaciones en diferentes configuraciones
- Automatización de despliegues

## 🎯 Conclusión y Siguiente Paso

¡Excelente trabajo! Has dominado las técnicas de administración avanzada con WMIC. Desde consultas básicas hasta automatización compleja, ahora tienes las herramientas necesarias para gestionar sistemas Windows de manera programática y eficiente.

En el siguiente capítulo, exploraremos los **Registros**, donde aprenderás a gestionar el registro de Windows, consultar y modificar claves, y automatizar tareas de configuración del sistema.

¡Prepárate para convertirte en un experto en gestión del registro de Windows!

---

## 📚 Enlaces Relacionados

- [Capítulo 65: Utilidad de zona horaria de Windows](65.%20Utilidad%20de%20zona%20horaria%20de%20Windows.md)
- [Capítulo 67: Registros](67.%20Registros.md)

## 🔗 Fuentes y Referencias

- **Microsoft Documentation**: [WMIC](https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmic)
- **WMI Reference**: [Windows Management Instrumentation](https://docs.microsoft.com/en-us/windows/win32/wmisdk/)
- **WMIC Commands**: [WMIC Command-Line Reference](https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmic-command-line-reference)

---

**Autor**: [Jerson Martínez](https://jersonmartinez.com)  
**Blog**: [Crashell](https://crashell.com)  
**Fecha**: 2024  
**Versión**: 1.0 
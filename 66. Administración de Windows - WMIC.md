# üîß Administraci√≥n de Windows - WMIC

> *"WMIC es la llave maestra de Windows. Con √©l, puedes consultar y controlar cualquier aspecto del sistema"* - **Principio fundamental de la administraci√≥n avanzada**

## üìã Introducci√≥n

¬øTe has preguntado alguna vez c√≥mo los administradores de sistemas obtienen informaci√≥n detallada de miles de equipos remotamente? ¬øC√≥mo automatizan tareas complejas de administraci√≥n en entornos empresariales? En este cap√≠tulo, exploraremos las t√©cnicas avanzadas de Windows Management Instrumentation (WMIC).

WMIC es una herramienta poderosa que permite acceder a informaci√≥n del sistema, gestionar configuraciones, y automatizar tareas administrativas de manera program√°tica. Aprenderemos a utilizar WMIC para consultar hardware, gestionar software, y crear scripts de administraci√≥n avanzados.

## üéØ Conceptos Clave

### **WMI (Windows Management Instrumentation)**
Infraestructura de gesti√≥n que proporciona acceso a informaci√≥n del sistema operativo y hardware.

### **WMIC (Windows Management Instrumentation Command)**
Interfaz de l√≠nea de comandos para acceder a WMI de manera program√°tica.

### **CIM (Common Information Model)**
Est√°ndar que define c√≥mo representar informaci√≥n de sistemas de manera consistente.

### **Namespace**
Contenedor l√≥gico que organiza clases WMI relacionadas.

## üõ†Ô∏è Comandos Principales

### **WMIC**
```batch
WMIC CPU GET Name,NumberOfCores,MaxClockSpeed
```
Consulta informaci√≥n del procesador del sistema.

### **WMIC PROCESS**
```batch
WMIC PROCESS WHERE "Name='explorer.exe'" GET ProcessId,WorkingSetSize
```
Obtiene informaci√≥n de procesos espec√≠ficos.

### **WMIC SERVICE**
```batch
WMIC SERVICE WHERE "StartMode='Auto'" GET Name,State
```
Lista servicios con inicio autom√°tico.

### **WMIC PRODUCT**
```batch
WMIC PRODUCT GET Name,Version,Vendor
```
Obtiene informaci√≥n de software instalado.

## üí° Ejemplos Pr√°cticos

### **Ejemplo 1: Consultar informaci√≥n del sistema**
**Prop√≥sito**: Comprender c√≥mo usar WMIC para obtener informaci√≥n detallada del sistema operativo y hardware.

**Explicaci√≥n del comando**: `WMIC` con diferentes clases permite acceder a informaci√≥n espec√≠fica del sistema. Las clases como `OS`, `COMPUTERSYSTEM`, y `BIOS` proporcionan datos fundamentales para la administraci√≥n.

```batch
@echo off
echo ========================================
echo    CONSULTAR INFORMACION DEL SISTEMA
echo ========================================
echo.

echo Consultando informacion del sistema...
echo Consulta iniciada: %date% %time%

REM Informaci√≥n del sistema operativo
echo === INFORMACION DEL SISTEMA OPERATIVO ===
wmic os get Caption,Version,BuildNumber,OSArchitecture /format:table

REM Informaci√≥n del equipo
echo.
echo === INFORMACION DEL EQUIPO ===
wmic computersystem get Name,Manufacturer,Model,TotalPhysicalMemory /format:table

REM Informaci√≥n de la BIOS
echo.
echo === INFORMACION DE LA BIOS ===
wmic bios get Manufacturer,Version,ReleaseDate /format:table

REM Informaci√≥n del procesador
echo.
echo === INFORMACION DEL PROCESADOR ===
wmic cpu get Name,NumberOfCores,MaxClockSpeed /format:table

echo Consulta de informacion del sistema completada
pause
```

### **Ejemplo 2: Gestionar procesos del sistema**
**Prop√≥sito**: Aprender a usar WMIC para gestionar procesos del sistema, incluyendo monitoreo y control.

**Explicaci√≥n del comando**: `WMIC PROCESS` permite consultar y gestionar procesos del sistema. Con filtros WHERE podemos obtener informaci√≥n espec√≠fica de procesos.

```batch
@echo off
echo ========================================
echo    GESTIONAR PROCESOS DEL SISTEMA
echo ========================================
echo.

echo Gestionando procesos del sistema...
echo Gestion iniciada: %date% %time%

REM Listar procesos con mayor uso de memoria
echo === PROCESOS CON MAYOR USO DE MEMORIA ===
wmic process where "WorkingSetSize>100000000" get Name,ProcessId,WorkingSetSize /format:table

REM Informaci√≥n de procesos espec√≠ficos
echo.
echo === INFORMACION DE PROCESOS ESPECIFICOS ===
for %%p in (explorer.exe svchost.exe) do (
    echo --- Proceso: %%p ---
    wmic process where "Name='%%p'" get ProcessId,WorkingSetSize,VirtualSize /format:table
)

REM Procesos del usuario actual
echo.
echo === PROCESOS DEL USUARIO ACTUAL ===
wmic process where "ExecutablePath like '%%%USERNAME%%%'" get Name,ProcessId,WorkingSetSize /format:table

echo Gestion de procesos completada
pause
```

### **Ejemplo 3: Gestionar servicios del sistema**
**Prop√≥sito**: Utilizar WMIC para gestionar servicios del sistema de manera program√°tica.

**Explicaci√≥n del comando**: `WMIC SERVICE` permite consultar y gestionar servicios del sistema. Es √∫til para automatizar tareas de administraci√≥n de servicios.

```batch
@echo off
echo ========================================
echo    GESTIONAR SERVICIOS DEL SISTEMA
echo ========================================
echo.

echo Gestionando servicios del sistema...
echo Gestion iniciada: %date% %time%

REM Servicios en ejecuci√≥n
echo === SERVICIOS EN EJECUCION ===
wmic service where "State='Running'" get Name,DisplayName,StartMode /format:table

REM Servicios con inicio autom√°tico
echo.
echo === SERVICIOS CON INICIO AUTOMATICO ===
wmic service where "StartMode='Auto'" get Name,DisplayName,State /format:table

REM Servicios detenidos
echo.
echo === SERVICIOS DETENIDOS ===
wmic service where "State='Stopped'" get Name,DisplayName,StartMode /format:table

REM Informaci√≥n de servicios cr√≠ticos
echo.
echo === INFORMACION DE SERVICIOS CRITICOS ===
for %%s in (spooler eventlog themes) do (
    echo --- Servicio: %%s ---
    wmic service where "Name='%%s'" get Name,DisplayName,State,StartMode /format:table
)

echo Gestion de servicios completada
pause
```

### **Ejemplo 4: Gestionar software instalado**
**Prop√≥sito**: Usar WMIC para obtener informaci√≥n detallada del software instalado en el sistema.

**Explicaci√≥n del comando**: `WMIC PRODUCT` permite consultar informaci√≥n del software instalado a trav√©s de Windows Installer.

```batch
@echo off
echo ========================================
echo    GESTIONAR SOFTWARE INSTALADO
echo ========================================
echo.

echo Gestionando software instalado...
echo Gestion iniciada: %date% %time%

REM Listar todo el software instalado
echo === SOFTWARE INSTALADO ===
wmic product get Name,Version,Vendor /format:table

REM Software de Microsoft
echo.
echo === SOFTWARE DE MICROSOFT ===
wmic product where "Vendor like '%%Microsoft%%'" get Name,Version,InstallDate /format:table

REM Software recientemente instalado
echo.
echo === SOFTWARE RECIENTEMENTE INSTALADO ===
wmic product where "InstallDate>'20240101'" get Name,Version,InstallDate /format:table

REM Informaci√≥n de aplicaciones espec√≠ficas
echo.
echo === INFORMACION DE APLICACIONES ESPECIFICAS ===
for %%a in (Office Chrome Firefox) do (
    echo --- Aplicacion: %%a ---
    wmic product where "Name like '%%%%a%%'" get Name,Version,Vendor,InstallDate /format:table
)

echo Gestion de software completada
pause
```

### **Ejemplo 5: Monitorear rendimiento del sistema**
**Prop√≥sito**: Crear un sistema de monitoreo de rendimiento usando WMIC para obtener m√©tricas del sistema.

**Explicaci√≥n del comando**: Este ejemplo combina m√∫ltiples clases WMIC para crear un sistema de monitoreo integral del rendimiento.

```batch
@echo off
echo ========================================
echo    MONITOREAR RENDIMIENTO DEL SISTEMA
echo ========================================
echo.

echo Monitoreando rendimiento del sistema...
echo Monitoreo iniciado: %date% %time%

REM Configuraci√≥n
set "log_file=rendimiento_%date:~-4,4%%date:~-10,2%%date:~-7,2%.log"

REM Crear archivo de log
echo Monitoreo de rendimiento - %date% %time% > %log_file%

REM Informaci√≥n de memoria
echo === INFORMACION DE MEMORIA ===
wmic OS get TotalVisibleMemorySize,FreePhysicalMemory /format:table >> %log_file%

REM Informaci√≥n de CPU
echo === INFORMACION DE CPU ===
wmic cpu get LoadPercentage,NumberOfCores /format:table >> %log_file%

REM Informaci√≥n de disco
echo === INFORMACION DE DISCO ===
wmic logicaldisk get DeviceID,Size,FreeSpace /format:table >> %log_file%

REM Procesos con mayor uso de recursos
echo === PROCESOS CON MAYOR USO DE RECURSOS ===
wmic process where "WorkingSetSize>50000000" get Name,WorkingSetSize /format:table >> %log_file%

echo Monitoreo de rendimiento completado
echo Log guardado en: %log_file%
pause
```

## üîß Scripts Avanzados

### **Script para Administraci√≥n Completa con WMIC**

```batch
@echo off
setlocal enabledelayedexpansion
title ADMINISTRACION COMPLETA CON WMIC

echo ========================================
echo  ADMINISTRACION COMPLETA CON WMIC
echo ========================================
echo.

:menu_principal
cls
echo ========================================
echo    ADMINISTRACION COMPLETA CON WMIC
echo ========================================
echo.
echo 1. Informacion del sistema
echo 2. Gestionar procesos
echo 3. Gestionar servicios
echo 4. Gestionar software
echo 5. Monitorear rendimiento
echo 6. Informacion de hardware
echo 7. Salir
echo.
set /p opcion="Seleccione una opcion: "

if "%opcion%"=="1" goto info_sistema
if "%opcion%"=="2" goto gestionar_procesos
if "%opcion%"=="3" goto gestionar_servicios
if "%opcion%"=="4" goto gestionar_software
if "%opcion%"=="5" goto monitorear_rendimiento
if "%opcion%"=="6" goto info_hardware
if "%opcion%"=="7" goto salir
goto menu_principal

:info_sistema
echo.
echo === INFORMACION DEL SISTEMA ===
echo.
wmic os get Caption,Version,OSArchitecture /format:table
wmic computersystem get Name,Manufacturer,Model /format:table
pause
goto menu_principal

:gestionar_procesos
echo.
echo === GESTIONAR PROCESOS ===
echo.
wmic process where "WorkingSetSize>100000000" get Name,ProcessId,WorkingSetSize /format:table
pause
goto menu_principal

:gestionar_servicios
echo.
echo === GESTIONAR SERVICIOS ===
echo.
wmic service where "State='Running'" get Name,DisplayName /format:table
pause
goto menu_principal

:gestionar_software
echo.
echo === GESTIONAR SOFTWARE ===
echo.
wmic product get Name,Version,Vendor /format:table
pause
goto menu_principal

:monitorear_rendimiento
echo.
echo === MONITOREAR RENDIMIENTO ===
echo.
wmic OS get TotalVisibleMemorySize,FreePhysicalMemory /format:table
wmic cpu get LoadPercentage /format:table
pause
goto menu_principal

:info_hardware
echo.
echo === INFORMACION DE HARDWARE ===
echo.
wmic cpu get Name,NumberOfCores,MaxClockSpeed /format:table
wmic memorychip get Capacity,Speed /format:table
pause
goto menu_principal

:salir
echo Gracias por usar la Administracion Completa con WMIC
exit
```

## üí° Consejos Importantes

### **Optimizaci√≥n**
- Usa filtros WHERE para consultas m√°s eficientes
- Limita los campos consultados con GET
- Utiliza formatos de salida apropiados

### **Seguridad**
- Ejecuta WMIC con privilegios m√≠nimos necesarios
- Valida consultas antes de ejecutarlas
- Mant√©n logs de operaciones administrativas

### **Mejores Pr√°cticas**
- Documenta las consultas WMIC utilizadas
- Establece pol√≠ticas de administraci√≥n remota
- Realiza pruebas de consultas en entornos controlados

## üåç Casos de Uso Reales

### **Administraci√≥n de Sistemas**
- Inventario automatizado de hardware y software
- Monitoreo remoto de sistemas
- Automatizaci√≥n de tareas administrativas

### **Empresarial**
- Gesti√≥n centralizada de activos IT
- Cumplimiento de pol√≠ticas corporativas
- Auditor√≠a de sistemas

### **Desarrollo y Testing**
- Validaci√≥n de requisitos de sistema
- Testing de aplicaciones en diferentes configuraciones
- Automatizaci√≥n de despliegues

## üéØ Conclusi√≥n y Siguiente Paso

¬°Excelente trabajo! Has dominado las t√©cnicas de administraci√≥n avanzada con WMIC. Desde consultas b√°sicas hasta automatizaci√≥n compleja, ahora tienes las herramientas necesarias para gestionar sistemas Windows de manera program√°tica y eficiente.

En el siguiente cap√≠tulo, exploraremos los **Registros**, donde aprender√°s a gestionar el registro de Windows, consultar y modificar claves, y automatizar tareas de configuraci√≥n del sistema.

¬°Prep√°rate para convertirte en un experto en gesti√≥n del registro de Windows!

---

## üìö Enlaces Relacionados

- [Cap√≠tulo 65: Utilidad de zona horaria de Windows](65.%20Utilidad%20de%20zona%20horaria%20de%20Windows.md)
- [Cap√≠tulo 67: Registros](67.%20Registros.md)

## üîó Fuentes y Referencias

- **Microsoft Documentation**: [WMIC](https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmic)
- **WMI Reference**: [Windows Management Instrumentation](https://docs.microsoft.com/en-us/windows/win32/wmisdk/)
- **WMIC Commands**: [WMIC Command-Line Reference](https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmic-command-line-reference)

---

**Autor**: [Jerson Mart√≠nez](https://jersonmartinez.com)  
**Blog**: [Crashell](https://crashell.com)  
**Fecha**: 2024  
**Versi√≥n**: 1.0 
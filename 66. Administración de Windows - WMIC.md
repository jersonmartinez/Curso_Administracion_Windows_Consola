# üîß Administraci√≥n de Windows - WMIC

> *"WMIC es la llave maestra de Windows. Con √©l, puedes consultar y controlar cualquier aspecto del sistema"* - **Principio fundamental de la administraci√≥n avanzada**

## üìã Introducci√≥n

¬øTe has preguntado alguna vez c√≥mo los administradores de sistemas obtienen informaci√≥n detallada de miles de equipos remotamente? ¬øC√≥mo automatizan tareas complejas de administraci√≥n en entornos empresariales? En este cap√≠tulo, exploraremos las t√©cnicas avanzadas de Windows Management Instrumentation (WMIC).

WMIC es una herramienta poderosa que permite acceder a informaci√≥n del sistema, gestionar configuraciones, y automatizar tareas administrativas de manera program√°tica. Aprenderemos a utilizar WMIC para consultar hardware, gestionar software, y crear scripts de administraci√≥n avanzados.

## üéØ Conceptos Clave

### **WMI (Windows Management Instrumentation)**
Infraestructura de gesti√≥n que proporciona acceso a informaci√≥n del sistema operativo y hardware.

### **WMIC (Windows Management Instrumentation Command)**
Interfaz de l√≠nea de comandos para acceder a WMI de manera program√°tica.

### **CIM (Common Information Model)**
Est√°ndar que define c√≥mo representar informaci√≥n de sistemas de manera consistente.

### **Namespace**
Contenedor l√≥gico que organiza clases WMI relacionadas.

## üõ†Ô∏è Comandos Principales

### **WMIC - Consulta General**
```batch
wmic [clase] [comando] [par√°metros]
```
Comando principal para acceder a WMI. Permite consultar diferentes clases del sistema.

**Par√°metros principales:**
- `[clase]`: Clase WMI a consultar (CPU, PROCESS, SERVICE, PRODUCT, OS, etc.)
- `GET`: Especifica los campos a obtener
- `WHERE`: Define filtros para la consulta
- `/format`: Especifica el formato de salida (table, list, csv)

### **WMIC CPU - Informaci√≥n del Procesador**
```batch
wmic cpu get Name,NumberOfCores,MaxClockSpeed,LoadPercentage
```
Obtiene informaci√≥n detallada del procesador del sistema.

**Campos disponibles:**
- `Name`: Nombre del procesador
- `NumberOfCores`: N√∫mero de n√∫cleos
- `MaxClockSpeed`: Velocidad m√°xima en MHz
- `LoadPercentage`: Porcentaje de uso actual

### **WMIC PROCESS - Gesti√≥n de Procesos**
```batch
wmic process where "Name='explorer.exe'" get ProcessId,WorkingSetSize,VirtualSize
```
Consulta y gestiona procesos del sistema.

**Filtros comunes:**
- `WorkingSetSize>100000000`: Procesos con uso de memoria > 100MB
- `Name='nombre_proceso'`: Proceso espec√≠fico
- `ProcessId=1234`: Por ID de proceso

### **WMIC SERVICE - Gesti√≥n de Servicios**
```batch
wmic service where "StartMode='Auto'" get Name,DisplayName,State
```
Gestiona servicios del sistema.

**Estados de servicio:**
- `Running`: En ejecuci√≥n
- `Stopped`: Detenido
- `Auto`: Inicio autom√°tico
- `Manual`: Inicio manual

### **WMIC PRODUCT - Software Instalado**
```batch
wmic product get Name,Version,Vendor,InstallDate
```
Obtiene informaci√≥n del software instalado a trav√©s de Windows Installer.

**Filtros √∫tiles:**
- `Vendor like '%Microsoft%'`: Software de Microsoft
- `InstallDate>'20240101'`: Software instalado despu√©s de una fecha

### **WMIC OS - Sistema Operativo**
```batch
wmic os get Caption,Version,BuildNumber,OSArchitecture,TotalVisibleMemorySize,FreePhysicalMemory
```
Informaci√≥n del sistema operativo y memoria.

### **WMIC COMPUTERSYSTEM - Informaci√≥n del Equipo**
```batch
wmic computersystem get Name,Manufacturer,Model,TotalPhysicalMemory
```
Informaci√≥n del hardware del equipo.

### **WMIC BIOS - Informaci√≥n de la BIOS**
```batch
wmic bios get Manufacturer,Version,ReleaseDate
```
Informaci√≥n de la BIOS del sistema.

### **WMIC LOGICALDISK - Unidades de Disco**
```batch
wmic logicaldisk get DeviceID,Size,FreeSpace,FileSystem
```
Informaci√≥n de las unidades de disco l√≥gicas.

### **WMIC MEMORYCHIP - M√≥dulos de Memoria**
```batch
wmic memorychip get Capacity,Speed,Manufacturer
```
Informaci√≥n de los m√≥dulos de memoria RAM.

## üí° Ejemplos Pr√°cticos

### **Ejemplo 1: Consultar informaci√≥n del sistema**
```batch
wmic os get Caption,Version,BuildNumber,OSArchitecture /format:table
wmic computersystem get Name,Manufacturer,Model,TotalPhysicalMemory /format:table
wmic bios get Manufacturer,Version,ReleaseDate /format:table
wmic cpu get Name,NumberOfCores,MaxClockSpeed /format:table
```

### **Ejemplo 2: Gestionar procesos del sistema**
```batch
wmic process where "WorkingSetSize>100000000" get Name,ProcessId,WorkingSetSize /format:table
wmic process where "Name='explorer.exe'" get ProcessId,WorkingSetSize,VirtualSize /format:table
```

### **Ejemplo 3: Gestionar servicios del sistema**
```batch
wmic service where "State='Running'" get Name,DisplayName,StartMode /format:table
wmic service where "StartMode='Auto'" get Name,DisplayName,State /format:table
wmic service where "State='Stopped'" get Name,DisplayName,StartMode /format:table
```

### **Ejemplo 4: Gestionar software instalado**
```batch
wmic product get Name,Version,Vendor /format:table
wmic product where "Vendor like '%Microsoft%'" get Name,Version,InstallDate /format:table
wmic product where "InstallDate>'20240101'" get Name,Version,InstallDate /format:table
```

### **Ejemplo 5: Monitorear rendimiento del sistema**
```batch
wmic OS get TotalVisibleMemorySize,FreePhysicalMemory /format:table
wmic cpu get LoadPercentage,NumberOfCores /format:table
wmic logicaldisk get DeviceID,Size,FreeSpace /format:table
wmic process where "WorkingSetSize>50000000" get Name,WorkingSetSize /format:table
```

## üîß Scripts Avanzados

### **Script de Gesti√≥n Completa con WMIC**
**Archivo**: `scripts/66-administracion-wmic/gestion-completa-wmic.bat`

Este script proporciona una interfaz completa para la administraci√≥n del sistema usando WMIC, incluyendo:
- Consulta de informaci√≥n del sistema
- Gesti√≥n de procesos
- Gesti√≥n de servicios
- Gesti√≥n de software instalado
- Monitoreo de rendimiento
- Informaci√≥n de hardware
- Generaci√≥n de reportes

### **Sistema de Gesti√≥n Avanzada con WMIC**
**Archivo**: `scripts/66-administracion-wmic/sistema-gestion-avanzada-wmic.bat`

Sistema avanzado con caracter√≠sticas adicionales:
- Configuraci√≥n mediante archivos de configuraci√≥n
- Monitoreo en tiempo real
- An√°lisis de rendimiento avanzado
- Gesti√≥n de pol√≠ticas de administraci√≥n
- Backup y restauraci√≥n de configuraciones
- Generaci√≥n de reportes detallados
- Auditor√≠a de cambios del sistema

## üí° Consejos Importantes

### **Optimizaci√≥n**
- Usa filtros WHERE para consultas m√°s eficientes
- Limita los campos consultados con GET
- Utiliza formatos de salida apropiados

### **Seguridad**
- Ejecuta WMIC con privilegios m√≠nimos necesarios
- Valida consultas antes de ejecutarlas
- Mant√©n logs de operaciones administrativas

### **Mejores Pr√°cticas**
- Documenta las consultas WMIC utilizadas
- Establece pol√≠ticas de administraci√≥n remota
- Realiza pruebas de consultas en entornos controlados

## üåç Casos de Uso Reales

### **Administraci√≥n de Sistemas**
- Inventario automatizado de hardware y software
- Monitoreo remoto de sistemas
- Automatizaci√≥n de tareas administrativas

### **Empresarial**
- Gesti√≥n centralizada de activos IT
- Cumplimiento de pol√≠ticas corporativas
- Auditor√≠a de sistemas

### **Desarrollo y Testing**
- Validaci√≥n de requisitos de sistema
- Testing de aplicaciones en diferentes configuraciones
- Automatizaci√≥n de despliegues

## üéØ Conclusi√≥n y Siguiente Paso

¬°Excelente trabajo! Has dominado las t√©cnicas de administraci√≥n avanzada con WMIC. Desde consultas b√°sicas hasta automatizaci√≥n compleja, ahora tienes las herramientas necesarias para gestionar sistemas Windows de manera program√°tica y eficiente.

En el siguiente cap√≠tulo, exploraremos los **Registros**, donde aprender√°s a gestionar el registro de Windows, consultar y modificar claves, y automatizar tareas de configuraci√≥n del sistema.

¬°Prep√°rate para convertirte en un experto en gesti√≥n del registro de Windows!

---

## üìö Enlaces Relacionados

- [Cap√≠tulo 65: Utilidad de zona horaria de Windows](65.%20Utilidad%20de%20zona%20horaria%20de%20Windows.md)
- [Cap√≠tulo 67: Registros](67.%20Registros.md)

## üîó Fuentes y Referencias

- **Microsoft Documentation**: [WMIC](https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmic)
- **WMI Reference**: [Windows Management Instrumentation](https://docs.microsoft.com/en-us/windows/win32/wmisdk/)
- **WMIC Commands**: [WMIC Command-Line Reference](https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmic-command-line-reference)

---

**Autor**: [Jerson Mart√≠nez](https://jersonmartinez.com)  
**Blog**: [Crashell](https://crashell.com)
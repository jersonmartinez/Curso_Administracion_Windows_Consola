# üåê CURL

> *"CURL es el puente entre tu sistema y el mundo web. Con √©l, puedes transferir datos a cualquier lugar del planeta"* - **Principio fundamental de las transferencias web**

## üìã Introducci√≥n

¬øTe has preguntado alguna vez c√≥mo descargar archivos desde la l√≠nea de comandos? ¬øC√≥mo automatizar transferencias de datos entre sistemas remotos? En este cap√≠tulo, exploraremos las t√©cnicas avanzadas para utilizar CURL en Windows.

CURL es una herramienta poderosa para transferir datos usando diversos protocolos (HTTP, HTTPS, FTP, SFTP). Aprenderemos a utilizar CURL para descargas web, transferencias de archivos, y automatizaci√≥n de tareas de red.

## üéØ Conceptos Clave

### **CURL (Client URL)**
Herramienta de l√≠nea de comandos para transferir datos usando m√∫ltiples protocolos.

### **Protocolo de Transferencia**
M√©todo de comunicaci√≥n para enviar y recibir datos (HTTP, HTTPS, FTP, SFTP).

### **Headers HTTP**
Informaci√≥n adicional enviada con las peticiones web para controlar el comportamiento.

### **Autenticaci√≥n**
Proceso de verificaci√≥n de identidad para acceder a recursos protegidos.

## üõ†Ô∏è Comandos Principales

### **CURL**
```batch
CURL -O https://ejemplo.com/archivo.zip
```
Descarga un archivo desde una URL.

### **CURL con Headers**
```batch
CURL -H "User-Agent: MiScript" https://api.ejemplo.com/datos
```
Realiza peticiones con headers personalizados.

### **CURL con Autenticaci√≥n**
```batch
CURL -u usuario:contrase√±a https://servidor.com/recurso
```
Accede a recursos protegidos con autenticaci√≥n.

### **CURL con FTP**
```batch
CURL -T archivo.txt ftp://servidor.com/
```
Sube archivos a un servidor FTP.

## üí° Ejemplos Pr√°cticos

### **Ejemplo 1: Descarga b√°sica de archivos**
**Prop√≥sito**: Comprender c√≥mo usar CURL para descargar archivos desde la web de manera b√°sica.

**Explicaci√≥n del comando**: `CURL -O` descarga un archivo y lo guarda con el nombre original. Es la forma m√°s simple de descargar archivos.

```batch
@echo off
echo ========================================
echo    DESCARGA BASICA DE ARCHIVOS
echo ========================================
echo.

echo Descargando archivos...
echo Descarga iniciada: %date% %time%

REM Descargar archivo simple
echo === DESCARGA DE ARCHIVO SIMPLE ===
curl -O https://www.ejemplo.com/archivo.txt

REM Descargar con nombre personalizado
echo.
echo === DESCARGA CON NOMBRE PERSONALIZADO ===
curl -o mi_archivo.txt https://www.ejemplo.com/archivo.txt

REM Descargar m√∫ltiples archivos
echo.
echo === DESCARGA MULTIPLE ===
curl -O https://www.ejemplo.com/archivo1.txt -O https://www.ejemplo.com/archivo2.txt

REM Verificar descargas
echo.
echo === VERIFICANDO DESCARGAS ===
dir *.txt

echo Descarga de archivos completada
pause
```

### **Ejemplo 2: Peticiones HTTP avanzadas**
**Prop√≥sito**: Aprender a usar CURL para realizar peticiones HTTP con headers personalizados y diferentes m√©todos.

**Explicaci√≥n del comando**: CURL permite personalizar peticiones HTTP con headers, m√©todos y par√°metros espec√≠ficos.

```batch
@echo off
echo ========================================
echo    PETICIONES HTTP AVANZADAS
echo ========================================
echo.

echo Realizando peticiones HTTP avanzadas...
echo Peticiones iniciadas: %date% %time%

REM Petici√≥n GET con headers
echo === PETICION GET CON HEADERS ===
curl -H "User-Agent: MiScript/1.0" -H "Accept: application/json" https://api.ejemplo.com/datos

REM Petici√≥n POST con datos
echo.
echo === PETICION POST CON DATOS ===
curl -X POST -H "Content-Type: application/json" -d "{\"nombre\":\"test\"}" https://api.ejemplo.com/crear

REM Petici√≥n con cookies
echo.
echo === PETICION CON COOKIES ===
curl -b "session=abc123" https://www.ejemplo.com/pagina-protegida

REM Petici√≥n con seguimiento de redirecciones
echo.
echo === PETICION CON REDIRECCIONES ===
curl -L https://www.ejemplo.com/redireccion

echo Peticiones HTTP completadas
pause
```

### **Ejemplo 3: Transferencias FTP**
**Prop√≥sito**: Utilizar CURL para realizar transferencias de archivos usando protocolo FTP.

**Explicaci√≥n del comando**: CURL soporta protocolo FTP para subir y descargar archivos desde servidores FTP.

```batch
@echo off
echo ========================================
echo    TRANSFERENCIAS FTP
echo ========================================
echo.

echo Realizando transferencias FTP...
echo Transferencias iniciadas: %date% %time%

REM Descargar archivo desde FTP
echo === DESCARGA DESDE FTP ===
curl -u usuario:contrase√±a -O ftp://servidor.com/archivo.txt

REM Subir archivo a FTP
echo.
echo === SUBIDA A FTP ===
curl -u usuario:contrase√±a -T archivo_local.txt ftp://servidor.com/

REM Listar directorio FTP
echo.
echo === LISTAR DIRECTORIO FTP ===
curl -u usuario:contrase√±a ftp://servidor.com/

REM Transferencia con modo pasivo
echo.
echo === TRANSFERENCIA MODO PASIVO ===
curl -u usuario:contrase√±a --ftp-pasv -T archivo.txt ftp://servidor.com/

echo Transferencias FTP completadas
pause
```

### **Ejemplo 4: Descargas con verificaci√≥n**
**Prop√≥sito**: Crear un sistema de descarga con verificaci√≥n de integridad y manejo de errores.

**Explicaci√≥n del comando**: Este ejemplo demuestra c√≥mo implementar descargas robustas con verificaci√≥n y manejo de errores.

```batch
@echo off
echo ========================================
echo    DESCARGAS CON VERIFICACION
echo ========================================
echo.

echo Realizando descargas con verificacion...
echo Descargas iniciadas: %date% %time%

REM Configuraci√≥n
set "url=https://www.ejemplo.com/archivo.zip"
set "archivo=archivo.zip"
set "intentos=3"

REM Descarga con reintentos
echo === DESCARGA CON REINTENTOS ===
for /l %%i in (1,1,%intentos%) do (
    echo Intento %%i de %intentos%
    curl -f -o "%archivo%" "%url%"
    if !errorlevel! equ 0 (
        echo Descarga exitosa
        goto verificar
    ) else (
        echo Error en descarga, reintentando...
        timeout /t 5 /nobreak >nul
    )
)

:verificar
REM Verificar archivo descargado
echo.
echo === VERIFICANDO ARCHIVO ===
if exist "%archivo%" (
    echo Archivo descargado: %archivo%
    dir "%archivo%"
) else (
    echo Error: No se pudo descargar el archivo
)

echo Descargas con verificacion completadas
pause
```

### **Ejemplo 5: Automatizaci√≥n de descargas**
**Prop√≥sito**: Crear un sistema automatizado para descargar m√∫ltiples archivos de diferentes fuentes.

**Explicaci√≥n del comando**: Este ejemplo combina CURL con scripts batch para automatizar descargas masivas.

```batch
@echo off
echo ========================================
echo    AUTOMATIZACION DE DESCARGAS
echo ========================================
echo.

echo Automatizando descargas...
echo Automatizacion iniciada: %date% %time%

REM Configuraci√≥n
set "directorio_descargas=C:\Descargas\Automaticas"
set "log_file=%directorio_descargas%\descargas_%date:~-4,4%%date:~-10,2%%date:~-7,2%.log"

REM Crear directorio de descargas
if not exist "%directorio_descargas%" mkdir "%directorio_descargas%"

REM Crear archivo de log
echo Automatizacion de descargas - %date% %time% > %log_file%

REM Lista de URLs a descargar
echo === DESCARGANDO ARCHIVOS ===
cd /d "%directorio_descargas%"

REM Descargar archivos de la lista
for %%u in (
    "https://www.ejemplo.com/archivo1.zip"
    "https://www.ejemplo.com/archivo2.txt"
    "https://www.ejemplo.com/archivo3.pdf"
) do (
    echo Descargando: %%u
    curl -O "%%u" >> %log_file% 2>&1
    if !errorlevel! equ 0 (
        echo [EXITO] Descarga completada: %%u >> %log_file%
    ) else (
        echo [ERROR] Error en descarga: %%u >> %log_file%
    )
)

echo Automatizacion de descargas completada
echo Log guardado en: %log_file%
pause
```

## üîß Scripts Avanzados

### **Script para Gesti√≥n Completa de CURL**

```batch
@echo off
setlocal enabledelayedexpansion
title GESTION COMPLETA DE CURL

echo ========================================
echo  GESTION COMPLETA DE CURL
echo ========================================
echo.

:menu_principal
cls
echo ========================================
echo    GESTION COMPLETA DE CURL
echo ========================================
echo.
echo 1. Descarga simple
echo 2. Descarga con verificacion
echo 3. Peticion HTTP
echo 4. Transferencia FTP
echo 5. Descarga multiple
echo 6. Monitorear descargas
echo 7. Salir
echo.
set /p opcion="Seleccione una opcion: "

if "%opcion%"=="1" goto descarga_simple
if "%opcion%"=="2" goto descarga_verificacion
if "%opcion%"=="3" goto peticion_http
if "%opcion%"=="4" goto transferencia_ftp
if "%opcion%"=="5" goto descarga_multiple
if "%opcion%"=="6" goto monitorear_descargas
if "%opcion%"=="7" goto salir
goto menu_principal

:descarga_simple
echo.
echo === DESCARGA SIMPLE ===
echo.
set /p url="URL del archivo: "
set /p archivo="Nombre del archivo: "
curl -o "%archivo%" "%url%"
echo Descarga completada
pause
goto menu_principal

:descarga_verificacion
echo.
echo === DESCARGA CON VERIFICACION ===
echo.
set /p url="URL del archivo: "
set /p archivo="Nombre del archivo: "
curl -f -o "%archivo%" "%url%"
if !errorlevel! equ 0 (
    echo Descarga exitosa
) else (
    echo Error en descarga
)
pause
goto menu_principal

:peticion_http
echo.
echo === PETICION HTTP ===
echo.
set /p url="URL: "
set /p metodo="Metodo (GET/POST): "
if "%metodo%"=="POST" (
    set /p datos="Datos POST: "
    curl -X POST -d "%datos%" "%url%"
) else (
    curl "%url%"
)
pause
goto menu_principal

:transferencia_ftp
echo.
echo === TRANSFERENCIA FTP ===
echo.
set /p servidor="Servidor FTP: "
set /p usuario="Usuario: "
set /p archivo="Archivo: "
curl -u %usuario% -T "%archivo%" "ftp://%servidor%/"
echo Transferencia completada
pause
goto menu_principal

:descarga_multiple
echo.
echo === DESCARGA MULTIPLE ===
echo.
set /p archivo_urls="Archivo con URLs: "
for /f %%u in (%archivo_urls%) do (
    echo Descargando: %%u
    curl -O "%%u"
)
echo Descargas multiples completadas
pause
goto menu_principal

:monitorear_descargas
echo.
echo === MONITOREAR DESCARGAS ===
echo.
dir *.zip *.txt *.pdf
echo Archivos descargados listados
pause
goto menu_principal

:salir
echo Gracias por usar la Gestion Completa de CURL
exit
```

## üí° Consejos Importantes

### **Optimizaci√≥n**
- Usa la opci√≥n `-f` para manejar errores HTTP
- Implementa reintentos para descargas cr√≠ticas
- Utiliza la opci√≥n `-L` para seguir redirecciones

### **Seguridad**
- Verifica URLs antes de descargar
- Usa HTTPS cuando sea posible
- Valida archivos descargados

### **Mejores Pr√°cticas**
- Documenta las URLs y par√°metros utilizados
- Implementa logs para monitorear descargas
- Realiza pruebas en entornos controlados

## üåç Casos de Uso Reales

### **Administraci√≥n de Sistemas**
- Descarga autom√°tica de actualizaciones
- Backup de archivos remotos
- Monitoreo de servicios web

### **Empresarial**
- Sincronizaci√≥n de datos entre sistemas
- Descarga de reportes autom√°ticos
- Integraci√≥n con APIs empresariales

### **Desarrollo y Testing**
- Descarga de dependencias de desarrollo
- Testing de APIs web
- Automatizaci√≥n de despliegues

## üéØ Conclusi√≥n y Siguiente Paso

¬°Excelente trabajo! Has dominado las t√©cnicas de uso de CURL en Windows. Desde descargas b√°sicas hasta automatizaci√≥n avanzada, ahora tienes las herramientas necesarias para transferir datos de manera eficiente y program√°tica.

En el siguiente cap√≠tulo, exploraremos **SHELL**, donde aprender√°s a gestionar entornos de shell, configurar variables de entorno, y automatizar tareas del sistema operativo.

¬°Prep√°rate para convertirte en un experto en gesti√≥n de shells y automatizaci√≥n del sistema!

---

## üìö Enlaces Relacionados

- [Cap√≠tulo 67: Registros](67.%20Registros.md)
- [Cap√≠tulo 69: SHELL](69.%20SHELL.md)

## üîó Fuentes y Referencias

- **CURL Documentation**: [CURL Manual](https://curl.se/docs/)
- **CURL Windows**: [CURL for Windows](https://curl.se/windows/)
- **HTTP Methods**: [HTTP Methods](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods)

---

**Autor**: [Jerson Mart√≠nez](https://jersonmartinez.com)  
**Blog**: [Crashell](https://crashell.com)  
**Fecha**: 2024  
**Versi√≥n**: 1.0 
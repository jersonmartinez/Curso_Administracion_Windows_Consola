# üíæ Windows To Go

> *"Windows To Go es la libertad de llevar tu sistema operativo en el bolsillo. Tu entorno de trabajo, donde quiera que vayas"* - **Principio fundamental de la movilidad digital**

## üìã Introducci√≥n

¬øTe has preguntado alguna vez c√≥mo llevar tu sistema Windows completo en un dispositivo USB? ¬øC√≥mo los administradores de sistemas crean entornos de trabajo port√°tiles para despliegues r√°pidos? En este cap√≠tulo, exploraremos las t√©cnicas avanzadas para crear y gestionar sistemas Windows To Go.

Windows To Go permite crear instalaciones completas de Windows en dispositivos USB, proporcionando movilidad total y flexibilidad para diferentes entornos de trabajo. Aprenderemos a utilizar herramientas nativas de Windows para crear, configurar y gestionar estos sistemas port√°tiles.

## üéØ Conceptos Clave

### **Windows To Go**
Tecnolog√≠a que permite crear instalaciones completas de Windows en dispositivos USB port√°tiles.

### **Workspace**
Entorno de trabajo personalizado que incluye aplicaciones, configuraciones y datos espec√≠ficos.

### **Bootable USB**
Dispositivo USB que puede iniciar un sistema operativo completo sin necesidad de instalaci√≥n.

### **Portable Applications**
Aplicaciones que pueden ejecutarse desde dispositivos USB sin instalaci√≥n en el sistema host.

## üõ†Ô∏è Comandos Principales

### **DISM**
```batch
DISM /Apply-Image /ImageFile:install.wim /Index:1 /ApplyDir:E:\
```
Aplica una imagen de Windows a un dispositivo USB.

### **BOOTREC**
```batch
BOOTREC /FIXMBR /FIXBOOT /REBUILDBCD
```
Repara y configura el sector de arranque en dispositivos USB.

### **BCDBOOT**
```batch
BCDBOOT E:\Windows /S E: /F ALL
```
Crea la configuraci√≥n de arranque para Windows To Go.

### **POWERSHELL New-WindowsToGo**
```powershell
New-WindowsToGo -Path "E:\" -SourcePath "D:\Sources\install.wim"
```
Crea una instalaci√≥n Windows To Go usando PowerShell.

## üí° Ejemplos Pr√°cticos

### **Ejemplo 1: Crear Windows To Go b√°sico**
**Prop√≥sito**: Comprender c√≥mo usar DISM para crear una instalaci√≥n Windows To Go b√°sica en un dispositivo USB.

**Explicaci√≥n del comando**: `DISM /Apply-Image` aplica una imagen de Windows a un dispositivo USB. El par√°metro `/Index:1` especifica qu√© edici√≥n de Windows usar, y `/ApplyDir` define la ubicaci√≥n de destino.

```batch
@echo off
echo ========================================
echo    CREAR WINDOWS TO GO BASICO
echo ========================================
echo.

echo Creando Windows To Go basico...
echo Creacion iniciada: %date% %time%

REM Configuraci√≥n
set "usb_drive=E:"
set "image_file=D:\Sources\install.wim"
set "image_index=1"

REM Verificar que el USB est√© disponible
if not exist "%usb_drive%" (
    echo [ERROR] Unidad USB %usb_drive% no encontrada
    pause
    exit /b 1
)

REM Aplicar imagen de Windows
echo === APLICANDO IMAGEN DE WINDOWS ===
dism /apply-image /imagefile:"%image_file%" /index:%image_index% /applydir:%usb_drive% /checkintegrity

REM Crear configuraci√≥n de arranque
echo === CREANDO CONFIGURACION DE ARRANQUE ===
bcdboot %usb_drive%\Windows /s %usb_drive% /f all

echo Windows To Go creado exitosamente en %usb_drive%
pause
```

### **Ejemplo 2: Configurar arranque dual**
**Prop√≥sito**: Configurar un dispositivo USB para arranque dual con m√∫ltiples sistemas operativos.

**Explicaci√≥n del comando**: `BCDBOOT` crea la configuraci√≥n de arranque necesaria para que el dispositivo USB sea booteable.

```batch
@echo off
echo ========================================
echo    CONFIGURAR ARRANQUE DUAL
echo ========================================
echo.

echo Configurando arranque dual...
echo Configuracion iniciada: %date% %time%

REM Configuraci√≥n
set "usb_drive=E:"
set "windows_path=%usb_drive%\Windows"

REM Crear configuraci√≥n de arranque principal
echo === CONFIGURANDO ARRANQUE PRINCIPAL ===
bcdboot %windows_path% /s %usb_drive% /f all

REM Configurar opciones de arranque
echo === CONFIGURANDO OPCIONES DE ARRANQUE ===
bcdedit /store %usb_drive%\boot\bcd /set {bootmgr} timeout 10
bcdedit /store %usb_drive%\boot\bcd /set {bootmgr} displaybootmenu yes

echo Arranque dual configurado exitosamente
pause
```

### **Ejemplo 3: Crear workspace personalizado**
**Prop√≥sito**: Crear un entorno de trabajo personalizado con aplicaciones y configuraciones espec√≠ficas.

**Explicaci√≥n del comando**: Este ejemplo demuestra c√≥mo personalizar una instalaci√≥n Windows To Go con aplicaciones y configuraciones espec√≠ficas.

```batch
@echo off
echo ========================================
echo    CREAR WORKSPACE PERSONALIZADO
echo ========================================
echo.

echo Creando workspace personalizado...
echo Creacion iniciada: %date% %time%

REM Configuraci√≥n
set "usb_drive=E:"
set "workspace_dir=%usb_drive%\Workspace"

REM Crear estructura de directorios
echo === CREANDO ESTRUCTURA DE DIRECTORIOS ===
mkdir "%workspace_dir%"
mkdir "%workspace_dir%\Apps"
mkdir "%workspace_dir%\Data"
mkdir "%workspace_dir%\Config"

REM Copiar aplicaciones port√°tiles
echo === COPIANDO APLICACIONES PORTATILES ===
xcopy "C:\PortableApps\*" "%workspace_dir%\Apps\" /E /I /H /Y

REM Crear script de configuraci√≥n autom√°tica
echo @echo off > "%workspace_dir%\setup_workspace.bat"
echo echo Configurando workspace... >> "%workspace_dir%\setup_workspace.bat"
echo echo Workspace configurado: %%date%% %%time%% >> "%workspace_dir%\setup_workspace.bat"

echo Workspace personalizado creado en %workspace_dir%
pause
```

### **Ejemplo 4: Gestionar m√∫ltiples instalaciones**
**Prop√≥sito**: Gestionar m√∫ltiples instalaciones Windows To Go en diferentes dispositivos USB.

**Explicaci√≥n del comando**: Este ejemplo muestra c√≥mo gestionar m√∫ltiples instalaciones y mantener un inventario de dispositivos Windows To Go.

```batch
@echo off
echo ========================================
echo    GESTIONAR MULTIPLES INSTALACIONES
echo ========================================
echo.

echo Gestionando multiples instalaciones...
echo Gestion iniciada: %date% %time%

REM Configuraci√≥n
set "inventory_file=inventory_wtg.txt"
set "backup_dir=C:\Backups\WindowsToGo"

REM Crear inventario
echo INVENTARIO WINDOWS TO GO > %inventory_file%
echo ======================================== >> %inventory_file%
echo Fecha: %date% %time% >> %inventory_file%
echo. >> %inventory_file%

REM Detectar dispositivos USB
echo === DETECTANDO DISPOSITIVOS USB ===
for %%d in (D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
    if exist "%%d:\Windows\System32" (
        echo Dispositivo: %%d: >> %inventory_file%
        echo Ruta: %%d:\ >> %inventory_file%
        echo Windows: %%d:\Windows >> %inventory_file%
        echo. >> %inventory_file%
    )
)

echo Inventario guardado en: %inventory_file%
pause
```

### **Ejemplo 5: Backup y restauraci√≥n**
**Prop√≥sito**: Crear un sistema de backup y restauraci√≥n para instalaciones Windows To Go.

**Explicaci√≥n del comando**: Este ejemplo demuestra c√≥mo respaldar y restaurar instalaciones Windows To Go completas.

```batch
@echo off
echo ========================================
echo    BACKUP Y RESTAURACION
echo ========================================
echo.

echo Realizando backup de Windows To Go...
echo Backup iniciado: %date% %time%

REM Configuraci√≥n
set "usb_drive=E:"
set "backup_path=C:\Backups\WTG_%date:~-4,4%%date:~-10,2%%date:~-7,2%"

REM Crear directorio de backup
if not exist "%backup_path%" mkdir "%backup_path%"

REM Crear imagen de backup
echo === CREANDO IMAGEN DE BACKUP ===
dism /capture-image /imagefile:"%backup_path%\wtg_backup.wim" /capturedir:%usb_drive% /name:"Windows To Go Backup" /description:"Backup del %date% %time%"

REM Crear script de restauraci√≥n
echo @echo off > "%backup_path%\restaurar_wtg.bat"
echo echo Restaurando Windows To Go... >> "%backup_path%\restaurar_wtg.bat"
echo dism /apply-image /imagefile:"wtg_backup.wim" /index:1 /applydir:E:\ /checkintegrity >> "%backup_path%\restaurar_wtg.bat"

echo Backup completado: %backup_path%
pause
```

## üîß Scripts Avanzados

### **Script para Gesti√≥n Completa de Windows To Go**

```batch
@echo off
setlocal enabledelayedexpansion
title GESTION COMPLETA DE WINDOWS TO GO

echo ========================================
echo  GESTION COMPLETA DE WINDOWS TO GO
echo ========================================
echo.

:menu_principal
cls
echo ========================================
echo    GESTION COMPLETA DE WINDOWS TO GO
echo ========================================
echo.
echo 1. Crear Windows To Go
echo 2. Configurar arranque
echo 3. Crear workspace
echo 4. Gestionar instalaciones
echo 5. Backup y restauracion
echo 6. Salir
echo.
set /p opcion="Seleccione una opcion: "

if "%opcion%"=="1" goto crear_wtg
if "%opcion%"=="2" goto configurar_arranque
if "%opcion%"=="3" goto crear_workspace
if "%opcion%"=="4" goto gestionar_instalaciones
if "%opcion%"=="5" goto backup_restauracion
if "%opcion%"=="6" goto salir
goto menu_principal

:crear_wtg
echo.
echo === CREAR WINDOWS TO GO ===
echo.
set /p usb="Unidad USB (ej: E:): "
set /p image="Ruta de imagen WIM: "
dism /apply-image /imagefile:"%image%" /index:1 /applydir:%usb% /checkintegrity
bcdboot %usb%\Windows /s %usb% /f all
echo Windows To Go creado
pause
goto menu_principal

:configurar_arranque
echo.
echo === CONFIGURAR ARRANQUE ===
echo.
set /p usb="Unidad USB: "
bcdedit /store %usb%\boot\bcd /set {bootmgr} timeout 10
echo Arranque configurado
pause
goto menu_principal

:crear_workspace
echo.
echo === CREAR WORKSPACE ===
echo.
set /p usb="Unidad USB: "
mkdir "%usb%\Workspace"
mkdir "%usb%\Workspace\Apps"
echo Workspace creado
pause
goto menu_principal

:gestionar_instalaciones
echo.
echo === GESTIONAR INSTALACIONES ===
echo.
for %%d in (D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
    if exist "%%d:\Windows\System32" (
        echo Dispositivo: %%d: - Windows To Go detectado
    )
)
pause
goto menu_principal

:backup_restauracion
echo.
echo === BACKUP Y RESTAURACION ===
echo.
set /p usb="Unidad USB: "
set /p backup="Ruta de backup: "
dism /capture-image /imagefile:"%backup%\wtg_backup.wim" /capturedir:%usb% /name:"WTG Backup"
echo Backup completado
pause
goto menu_principal

:salir
echo Gracias por usar la Gestion de Windows To Go
exit
```

## üí° Consejos Importantes

### **Optimizaci√≥n**
- Usa dispositivos USB 3.0 para mejor rendimiento
- Mant√©n las instalaciones actualizadas regularmente
- Optimiza el espacio en dispositivos USB

### **Seguridad**
- Implementa cifrado en dispositivos Windows To Go
- Mant√©n backups regulares de configuraciones
- Usa dispositivos USB certificados para Windows To Go

### **Mejores Pr√°cticas**
- Documenta las configuraciones de cada instalaci√≥n
- Establece pol√≠ticas de gesti√≥n para dispositivos port√°tiles
- Realiza pruebas de arranque regularmente

## üåç Casos de Uso Reales

### **Administraci√≥n de Sistemas**
- Despliegue r√°pido de entornos de trabajo
- Recuperaci√≥n ante desastres
- Testing de configuraciones

### **Empresarial**
- Entornos de trabajo m√≥viles
- Demostraciones de software
- Entrenamiento de usuarios

### **Desarrollo y Testing**
- Entornos de desarrollo port√°tiles
- Testing de aplicaciones
- Demostraciones t√©cnicas

## üéØ Conclusi√≥n y Siguiente Paso

¬°Excelente trabajo! Has dominado las t√©cnicas de creaci√≥n y gesti√≥n de Windows To Go. Desde instalaciones b√°sicas hasta workspaces personalizados, ahora tienes las herramientas necesarias para crear sistemas Windows port√°tiles completamente funcionales.

En el siguiente cap√≠tulo, exploraremos la **Utilidad de zona horaria de Windows**, donde aprender√°s a gestionar configuraciones de tiempo, sincronizar relojes del sistema, y configurar zonas horarias para entornos globales.

¬°Prep√°rate para convertirte en un experto en gesti√≥n de tiempo y zonas horarias!

---

## üìö Enlaces Relacionados

- [Cap√≠tulo 63: Gestionar Servicios](63.%20Gestionar%20Servicios.md)
- [Cap√≠tulo 65: Utilidad de zona horaria de Windows](65.%20Utilidad%20de%20zona%20horaria%20de%20Windows.md)

## üîó Fuentes y Referencias

- **Microsoft Documentation**: [Windows To Go](https://docs.microsoft.com/en-us/windows/deployment/planning/windows-to-go-overview)
- **DISM Command**: [DISM Overview](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/dism-overview)
- **BCDBoot**: [BCDBoot Command-Line Options](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/bcdboot-command-line-options-techref-di)

---

**Autor**: [Jerson Mart√≠nez](https://jersonmartinez.com)  
**Blog**: [Crashell](https://crashell.com)  
**Fecha**: 2024  
**Versi√≥n**: 1.0 
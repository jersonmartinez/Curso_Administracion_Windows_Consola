# 💾 Windows To Go

> *"Windows To Go es la libertad de llevar tu sistema operativo en el bolsillo. Tu entorno de trabajo, donde quiera que vayas"* - **Principio fundamental de la movilidad digital**

## 📋 Introducción

¿Te has preguntado alguna vez cómo llevar tu sistema Windows completo en un dispositivo USB? ¿Cómo los administradores de sistemas crean entornos de trabajo portátiles para despliegues rápidos? En este capítulo, exploraremos las técnicas avanzadas para crear y gestionar sistemas Windows To Go.

Windows To Go permite crear instalaciones completas de Windows en dispositivos USB, proporcionando movilidad total y flexibilidad para diferentes entornos de trabajo. Aprenderemos a utilizar herramientas nativas de Windows para crear, configurar y gestionar estos sistemas portátiles.

## 🎯 Conceptos Clave

### **Windows To Go**
Tecnología que permite crear instalaciones completas de Windows en dispositivos USB portátiles.

### **Workspace**
Entorno de trabajo personalizado que incluye aplicaciones, configuraciones y datos específicos.

### **Bootable USB**
Dispositivo USB que puede iniciar un sistema operativo completo sin necesidad de instalación.

### **Portable Applications**
Aplicaciones que pueden ejecutarse desde dispositivos USB sin instalación en el sistema host.

## 🛠️ Comandos Principales

### **DISM**
```batch
DISM /Apply-Image /ImageFile:install.wim /Index:1 /ApplyDir:E:\
```
Aplica una imagen de Windows a un dispositivo USB.

### **BOOTREC**
```batch
BOOTREC /FIXMBR /FIXBOOT /REBUILDBCD
```
Repara y configura el sector de arranque en dispositivos USB.

### **BCDBOOT**
```batch
BCDBOOT E:\Windows /S E: /F ALL
```
Crea la configuración de arranque para Windows To Go.

### **POWERSHELL New-WindowsToGo**
```powershell
New-WindowsToGo -Path "E:\" -SourcePath "D:\Sources\install.wim"
```
Crea una instalación Windows To Go usando PowerShell.

## 💡 Ejemplos Prácticos

### **Ejemplo 1: Crear Windows To Go básico**
**Propósito**: Comprender cómo usar DISM para crear una instalación Windows To Go básica en un dispositivo USB.

**Explicación del comando**: `DISM /Apply-Image` aplica una imagen de Windows a un dispositivo USB. El parámetro `/Index:1` especifica qué edición de Windows usar, y `/ApplyDir` define la ubicación de destino.

```batch
@echo off
echo ========================================
echo    CREAR WINDOWS TO GO BASICO
echo ========================================
echo.

echo Creando Windows To Go basico...
echo Creacion iniciada: %date% %time%

REM Configuración
set "usb_drive=E:"
set "image_file=D:\Sources\install.wim"
set "image_index=1"

REM Verificar que el USB esté disponible
if not exist "%usb_drive%" (
    echo [ERROR] Unidad USB %usb_drive% no encontrada
    pause
    exit /b 1
)

REM Aplicar imagen de Windows
echo === APLICANDO IMAGEN DE WINDOWS ===
dism /apply-image /imagefile:"%image_file%" /index:%image_index% /applydir:%usb_drive% /checkintegrity

REM Crear configuración de arranque
echo === CREANDO CONFIGURACION DE ARRANQUE ===
bcdboot %usb_drive%\Windows /s %usb_drive% /f all

echo Windows To Go creado exitosamente en %usb_drive%
pause
```

### **Ejemplo 2: Configurar arranque dual**
**Propósito**: Configurar un dispositivo USB para arranque dual con múltiples sistemas operativos.

**Explicación del comando**: `BCDBOOT` crea la configuración de arranque necesaria para que el dispositivo USB sea booteable.

```batch
@echo off
echo ========================================
echo    CONFIGURAR ARRANQUE DUAL
echo ========================================
echo.

echo Configurando arranque dual...
echo Configuracion iniciada: %date% %time%

REM Configuración
set "usb_drive=E:"
set "windows_path=%usb_drive%\Windows"

REM Crear configuración de arranque principal
echo === CONFIGURANDO ARRANQUE PRINCIPAL ===
bcdboot %windows_path% /s %usb_drive% /f all

REM Configurar opciones de arranque
echo === CONFIGURANDO OPCIONES DE ARRANQUE ===
bcdedit /store %usb_drive%\boot\bcd /set {bootmgr} timeout 10
bcdedit /store %usb_drive%\boot\bcd /set {bootmgr} displaybootmenu yes

echo Arranque dual configurado exitosamente
pause
```

### **Ejemplo 3: Crear workspace personalizado**
**Propósito**: Crear un entorno de trabajo personalizado con aplicaciones y configuraciones específicas.

**Explicación del comando**: Este ejemplo demuestra cómo personalizar una instalación Windows To Go con aplicaciones y configuraciones específicas.

```batch
@echo off
echo ========================================
echo    CREAR WORKSPACE PERSONALIZADO
echo ========================================
echo.

echo Creando workspace personalizado...
echo Creacion iniciada: %date% %time%

REM Configuración
set "usb_drive=E:"
set "workspace_dir=%usb_drive%\Workspace"

REM Crear estructura de directorios
echo === CREANDO ESTRUCTURA DE DIRECTORIOS ===
mkdir "%workspace_dir%"
mkdir "%workspace_dir%\Apps"
mkdir "%workspace_dir%\Data"
mkdir "%workspace_dir%\Config"

REM Copiar aplicaciones portátiles
echo === COPIANDO APLICACIONES PORTATILES ===
xcopy "C:\PortableApps\*" "%workspace_dir%\Apps\" /E /I /H /Y

REM Crear script de configuración automática
echo @echo off > "%workspace_dir%\setup_workspace.bat"
echo echo Configurando workspace... >> "%workspace_dir%\setup_workspace.bat"
echo echo Workspace configurado: %%date%% %%time%% >> "%workspace_dir%\setup_workspace.bat"

echo Workspace personalizado creado en %workspace_dir%
pause
```

### **Ejemplo 4: Gestionar múltiples instalaciones**
**Propósito**: Gestionar múltiples instalaciones Windows To Go en diferentes dispositivos USB.

**Explicación del comando**: Este ejemplo muestra cómo gestionar múltiples instalaciones y mantener un inventario de dispositivos Windows To Go.

```batch
@echo off
echo ========================================
echo    GESTIONAR MULTIPLES INSTALACIONES
echo ========================================
echo.

echo Gestionando multiples instalaciones...
echo Gestion iniciada: %date% %time%

REM Configuración
set "inventory_file=inventory_wtg.txt"
set "backup_dir=C:\Backups\WindowsToGo"

REM Crear inventario
echo INVENTARIO WINDOWS TO GO > %inventory_file%
echo ======================================== >> %inventory_file%
echo Fecha: %date% %time% >> %inventory_file%
echo. >> %inventory_file%

REM Detectar dispositivos USB
echo === DETECTANDO DISPOSITIVOS USB ===
for %%d in (D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
    if exist "%%d:\Windows\System32" (
        echo Dispositivo: %%d: >> %inventory_file%
        echo Ruta: %%d:\ >> %inventory_file%
        echo Windows: %%d:\Windows >> %inventory_file%
        echo. >> %inventory_file%
    )
)

echo Inventario guardado en: %inventory_file%
pause
```

### **Ejemplo 5: Backup y restauración**
**Propósito**: Crear un sistema de backup y restauración para instalaciones Windows To Go.

**Explicación del comando**: Este ejemplo demuestra cómo respaldar y restaurar instalaciones Windows To Go completas.

```batch
@echo off
echo ========================================
echo    BACKUP Y RESTAURACION
echo ========================================
echo.

echo Realizando backup de Windows To Go...
echo Backup iniciado: %date% %time%

REM Configuración
set "usb_drive=E:"
set "backup_path=C:\Backups\WTG_%date:~-4,4%%date:~-10,2%%date:~-7,2%"

REM Crear directorio de backup
if not exist "%backup_path%" mkdir "%backup_path%"

REM Crear imagen de backup
echo === CREANDO IMAGEN DE BACKUP ===
dism /capture-image /imagefile:"%backup_path%\wtg_backup.wim" /capturedir:%usb_drive% /name:"Windows To Go Backup" /description:"Backup del %date% %time%"

REM Crear script de restauración
echo @echo off > "%backup_path%\restaurar_wtg.bat"
echo echo Restaurando Windows To Go... >> "%backup_path%\restaurar_wtg.bat"
echo dism /apply-image /imagefile:"wtg_backup.wim" /index:1 /applydir:E:\ /checkintegrity >> "%backup_path%\restaurar_wtg.bat"

echo Backup completado: %backup_path%
pause
```

## 🔧 Scripts Avanzados

### **Script para Gestión Completa de Windows To Go**

```batch
@echo off
setlocal enabledelayedexpansion
title GESTION COMPLETA DE WINDOWS TO GO

echo ========================================
echo  GESTION COMPLETA DE WINDOWS TO GO
echo ========================================
echo.

:menu_principal
cls
echo ========================================
echo    GESTION COMPLETA DE WINDOWS TO GO
echo ========================================
echo.
echo 1. Crear Windows To Go
echo 2. Configurar arranque
echo 3. Crear workspace
echo 4. Gestionar instalaciones
echo 5. Backup y restauracion
echo 6. Salir
echo.
set /p opcion="Seleccione una opcion: "

if "%opcion%"=="1" goto crear_wtg
if "%opcion%"=="2" goto configurar_arranque
if "%opcion%"=="3" goto crear_workspace
if "%opcion%"=="4" goto gestionar_instalaciones
if "%opcion%"=="5" goto backup_restauracion
if "%opcion%"=="6" goto salir
goto menu_principal

:crear_wtg
echo.
echo === CREAR WINDOWS TO GO ===
echo.
set /p usb="Unidad USB (ej: E:): "
set /p image="Ruta de imagen WIM: "
dism /apply-image /imagefile:"%image%" /index:1 /applydir:%usb% /checkintegrity
bcdboot %usb%\Windows /s %usb% /f all
echo Windows To Go creado
pause
goto menu_principal

:configurar_arranque
echo.
echo === CONFIGURAR ARRANQUE ===
echo.
set /p usb="Unidad USB: "
bcdedit /store %usb%\boot\bcd /set {bootmgr} timeout 10
echo Arranque configurado
pause
goto menu_principal

:crear_workspace
echo.
echo === CREAR WORKSPACE ===
echo.
set /p usb="Unidad USB: "
mkdir "%usb%\Workspace"
mkdir "%usb%\Workspace\Apps"
echo Workspace creado
pause
goto menu_principal

:gestionar_instalaciones
echo.
echo === GESTIONAR INSTALACIONES ===
echo.
for %%d in (D E F G H I J K L M N O P Q R S T U V W X Y Z) do (
    if exist "%%d:\Windows\System32" (
        echo Dispositivo: %%d: - Windows To Go detectado
    )
)
pause
goto menu_principal

:backup_restauracion
echo.
echo === BACKUP Y RESTAURACION ===
echo.
set /p usb="Unidad USB: "
set /p backup="Ruta de backup: "
dism /capture-image /imagefile:"%backup%\wtg_backup.wim" /capturedir:%usb% /name:"WTG Backup"
echo Backup completado
pause
goto menu_principal

:salir
echo Gracias por usar la Gestion de Windows To Go
exit
```

## 💡 Consejos Importantes

### **Optimización**
- Usa dispositivos USB 3.0 para mejor rendimiento
- Mantén las instalaciones actualizadas regularmente
- Optimiza el espacio en dispositivos USB

### **Seguridad**
- Implementa cifrado en dispositivos Windows To Go
- Mantén backups regulares de configuraciones
- Usa dispositivos USB certificados para Windows To Go

### **Mejores Prácticas**
- Documenta las configuraciones de cada instalación
- Establece políticas de gestión para dispositivos portátiles
- Realiza pruebas de arranque regularmente

## 🌍 Casos de Uso Reales

### **Administración de Sistemas**
- Despliegue rápido de entornos de trabajo
- Recuperación ante desastres
- Testing de configuraciones

### **Empresarial**
- Entornos de trabajo móviles
- Demostraciones de software
- Entrenamiento de usuarios

### **Desarrollo y Testing**
- Entornos de desarrollo portátiles
- Testing de aplicaciones
- Demostraciones técnicas

## 🎯 Conclusión y Siguiente Paso

¡Excelente trabajo! Has dominado las técnicas de creación y gestión de Windows To Go. Desde instalaciones básicas hasta workspaces personalizados, ahora tienes las herramientas necesarias para crear sistemas Windows portátiles completamente funcionales.

En el siguiente capítulo, exploraremos la **Utilidad de zona horaria de Windows**, donde aprenderás a gestionar configuraciones de tiempo, sincronizar relojes del sistema, y configurar zonas horarias para entornos globales.

¡Prepárate para convertirte en un experto en gestión de tiempo y zonas horarias!

---

## 📚 Enlaces Relacionados

- [Capítulo 63: Gestionar Servicios](63.%20Gestionar%20Servicios.md)
- [Capítulo 65: Utilidad de zona horaria de Windows](65.%20Utilidad%20de%20zona%20horaria%20de%20Windows.md)

## 🔗 Fuentes y Referencias

- **Microsoft Documentation**: [Windows To Go](https://docs.microsoft.com/en-us/windows/deployment/planning/windows-to-go-overview)
- **DISM Command**: [DISM Overview](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/dism-overview)
- **BCDBoot**: [BCDBoot Command-Line Options](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/bcdboot-command-line-options-techref-di)

---

**Autor**: [Jerson Martínez](https://jersonmartinez.com)  
**Blog**: [Crashell](https://crashell.com)  
**Fecha**: 2024  
**Versión**: 1.0 
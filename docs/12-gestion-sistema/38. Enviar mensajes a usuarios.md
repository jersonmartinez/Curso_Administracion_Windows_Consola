# 38. Enviar mensajes a usuarios üí¨

> *"¬øTe imaginas poder comunicarte instant√°neamente con todos los usuarios conectados a tu red? ¬øO enviar alertas importantes a equipos espec√≠ficos? La comunicaci√≥n en red es una herramienta poderosa para administradores de sistemas y t√©cnicos de soporte."*

## üìö Conceptos Clave

### **Mensaje de Red (Network Message)**
Comunicaci√≥n enviada a trav√©s de la red local que aparece como una ventana emergente en los equipos de destino, permitiendo la comunicaci√≥n directa entre administradores y usuarios.

### **Servicio de Mensajer√≠a (Messenger Service)**
Servicio de Windows que permite el env√≠o y recepci√≥n de mensajes entre equipos en la misma red, facilitando la comunicaci√≥n administrativa.

### **Broadcast**
T√©cnica de env√≠o de mensajes a todos los equipos conectados en la red simult√°neamente, √∫til para anuncios generales.

### **Mensaje Unicast**
Env√≠o de mensajes a un equipo espec√≠fico, ideal para comunicaciones personalizadas o alertas individuales.

## üõ†Ô∏è Comandos y herramientas principales

### **MSG**
Comando nativo de Windows para enviar mensajes a usuarios conectados en la red local.

**Sintaxis:**
```batch
msg {username | sessionname | sessionid} [/server:servername] [/time:seconds] [/v] [/w] [message]
```

**Par√°metros principales:**
- `username`: Nombre del usuario al que enviar el mensaje
- `sessionname`: Nombre de la sesi√≥n de terminal
- `sessionid`: ID de la sesi√≥n de terminal
- `/server:servername`: Especifica el servidor remoto
- `/time:seconds`: Tiempo en segundos antes de cerrar el mensaje
- `/v`: Modo verbose (muestra informaci√≥n detallada)
- `/w`: Espera respuesta del usuario
- `message`: Texto del mensaje a enviar

**Ejemplos:**
```batch
msg * "Mensaje para todos los usuarios"
msg usuario1 "Mensaje personalizado"
msg /server:PC01 * "Mensaje remoto"
msg * /time:30 "Mensaje con timeout"
```

### **NET SEND**
Comando heredado de versiones anteriores de Windows, a√∫n funcional en algunos sistemas.

**Sintaxis:**
```batch
net send {name | * | /domain[:name] | /users} message
```

**Par√°metros principales:**
- `name`: Nombre del usuario, computadora o dominio
- `*`: Env√≠a a todos los usuarios en el dominio
- `/domain[:name]`: Env√≠a a todos los usuarios en el dominio especificado
- `/users`: Env√≠a a todos los usuarios conectados
- `message`: Texto del mensaje

**Ejemplos:**
```batch
net send * "Mensaje de prueba"
net send PC01 "Mensaje a equipo espec√≠fico"
net send /domain:empresa "Mensaje corporativo"
```

### **QUERY USER**
Comando para mostrar informaci√≥n sobre usuarios conectados en el sistema.

**Sintaxis:**
```batch
query user [username | sessionname | sessionid] [/server:servername]
```

**Par√°metros principales:**
- `username`: Nombre del usuario espec√≠fico
- `sessionname`: Nombre de la sesi√≥n
- `sessionid`: ID de la sesi√≥n
- `/server:servername`: Servidor remoto

**Ejemplos:**
```batch
query user
query user usuario1
query user /server:PC01
```

### **AT**
Comando para programar comandos y scripts para ejecutarse en un momento espec√≠fico.

**Sintaxis:**
```batch
at [\\computername] time [/interactive] [/every:date[,...] | /next:date[,...]] command
```

**Par√°metros principales:**
- `\\computername`: Computadora remota
- `time`: Hora de ejecuci√≥n (HH:MM)
- `/interactive`: Permite interacci√≥n con el usuario
- `/every:date`: Ejecuta en fechas espec√≠ficas
- `/next:date`: Ejecuta en la pr√≥xima fecha especificada
- `command`: Comando a ejecutar

**Ejemplos:**
```batch
at 18:00 msg * "Mensaje programado"
at 09:00 /every:LUN,MIE,VIE msg * "Recordatorio semanal"
```

### **Comandos adicionales utilizados:**
- `IF`: Control de flujo condicional
- `FOR /F`: Bucle para procesar archivos o comandos
- `SET /P`: Entrada de usuario interactiva
- `ERRORLEVEL`: Verificaci√≥n de c√≥digos de salida
- `PAUSE`: Pausa la ejecuci√≥n
- `ECHO`: Muestra texto en pantalla
- `CLS`: Limpia la pantalla
- `TIMEOUT`: Pausa con temporizador
- `CHOICE`: Selecci√≥n de opciones
- `PING`: Verificaci√≥n de conectividad de red
- `NET SESSION`: Verificaci√≥n de permisos de administrador

## üí° Ejemplos Pr√°cticos

### **Ejemplo 1: Enviar mensaje a todos los usuarios**
**Prop√≥sito**: Comunicar informaci√≥n importante a todos los usuarios conectados en la red, como mantenimiento programado o alertas del sistema.

### **Ejemplo 2: Enviar mensaje a un usuario espec√≠fico**
**Prop√≥sito**: Comunicarse con un usuario en particular para resolver problemas espec√≠ficos o dar instrucciones personalizadas.

### **Ejemplo 3: Enviar mensaje a un equipo espec√≠fico**
**Prop√≥sito**: Comunicarse con un equipo en particular, √∫til cuando se conoce la direcci√≥n IP o nombre del equipo pero no el usuario.

### **Ejemplo 4: Enviar mensaje con timeout**
**Prop√≥sito**: Enviar mensajes que se cierran autom√°ticamente despu√©s de un tiempo determinado, evitando interrupciones prolongadas.

### **Ejemplo 5: Enviar mensaje urgente**
**Prop√≥sito**: Enviar mensajes que requieren atenci√≥n inmediata, como alertas de seguridad o emergencias del sistema.

### **Ejemplo 6: Verificar usuarios conectados antes de enviar**
**Prop√≥sito**: Verificar qu√© usuarios est√°n activos antes de enviar mensajes, asegurando que la comunicaci√≥n llegue a su destino.

### **Ejemplo 7: Enviar mensaje programado**
**Prop√≥sito**: Crear un sistema de mensajes programados que se env√≠an autom√°ticamente en horarios espec√≠ficos.

### **Ejemplo 8: Enviar mensaje a m√∫ltiples equipos**
**Prop√≥sito**: Enviar el mismo mensaje a varios equipos espec√≠ficos de forma eficiente.

### **Ejemplo 9: Enviar mensaje con confirmaci√≥n**
**Prop√≥sito**: Enviar mensajes que requieren confirmaci√≥n del usuario antes de proceder con acciones importantes.

### **Ejemplo 10: Script de gesti√≥n de mensajes**
**Prop√≥sito**: Script interactivo para gestionar diferentes tipos de mensajes con m√∫ltiples opciones y configuraciones.

## üîß Scripts Avanzados

### **Gesti√≥n Avanzada de Mensajes**
Script completo con logging, monitoreo, plantillas y gesti√≥n de mensajes programados.

### **Sistema de Alertas Autom√°tico**
Sistema que env√≠a alertas autom√°ticas basadas en configuraciones de tiempo y eventos del sistema.

## üí° Consejos Importantes

### **Optimizaci√≥n**
- **Verificar conectividad**: Antes de enviar mensajes, aseg√∫rate de que la red est√© funcionando correctamente
- **Usar mensajes concisos**: Los mensajes largos pueden ser molestos para los usuarios
- **Programar en horarios adecuados**: Env√≠a mensajes en momentos que no interrumpan el trabajo

### **Seguridad**
- **Verificar permisos**: Aseg√∫rate de tener los permisos necesarios para enviar mensajes
- **No abusar del sistema**: Usa los mensajes solo para comunicaciones importantes
- **Registrar actividad**: Mant√©n logs de todos los mensajes enviados para auditor√≠a

### **Mejores Pr√°cticas**
- **Mensajes claros**: Usa un lenguaje claro y directo en los mensajes
- **Confirmar recepci√≥n**: En casos cr√≠ticos, solicita confirmaci√≥n de recepci√≥n
- **Respetar horarios**: Evita enviar mensajes fuera del horario laboral

## üåç Casos de Uso Reales

### **Administraci√≥n de Sistemas**
- **Mantenimiento programado**: Notificar a usuarios sobre reinicios o actualizaciones del sistema
- **Alertas de seguridad**: Comunicar amenazas o vulnerabilidades detectadas
- **Monitoreo de red**: Informar sobre problemas de conectividad o rendimiento

### **Entornos Educativos**
- **Anuncios de clase**: Comunicar cambios de horario o cancelaciones
- **Recordatorios**: Notificar sobre fechas l√≠mite o ex√°menes
- **Emergencias**: Alertar sobre situaciones de emergencia en el campus

### **Empresas**
- **Comunicaci√≥n interna**: Enviar anuncios corporativos a todos los empleados
- **Soporte t√©cnico**: Contactar usuarios para resolver problemas espec√≠ficos
- **Gesti√≥n de proyectos**: Coordinar equipos de trabajo en tiempo real

## üéØ Conclusi√≥n y Siguiente Paso

¬°Excelente! Has dominado el env√≠o de mensajes a usuarios en Windows. Esta habilidad te permitir√° comunicarte eficientemente con todos los usuarios de tu red, una competencia esencial para administradores de sistemas y t√©cnicos de soporte.

**¬øQu√© has aprendido?**
- Enviar mensajes a usuarios espec√≠ficos o a toda la red
- Programar mensajes autom√°ticos para diferentes horarios
- Crear sistemas de alertas autom√°ticas
- Gestionar plantillas de mensajes para diferentes situaciones

**Aplicaciones profesionales:**
- Administrador de sistemas corporativos
- T√©cnico de soporte en empresas
- Coordinador de TI en instituciones educativas
- Consultor de infraestructura de red

En el siguiente cap√≠tulo, aprender√°s sobre el **env√≠o de se√±ales** a procesos y aplicaciones, una habilidad avanzada que te permitir√° controlar el comportamiento de programas en ejecuci√≥n. ¬°Prep√°rate para dominar el control de procesos!

---

## üìÅ Scripts disponibles

Todos los scripts de este cap√≠tulo est√°n disponibles en el directorio `scripts/38-enviar-mensajes-usuarios/`:

### **Scripts b√°sicos:**
- **`enviar-mensaje-todos-usuarios.bat`**: Env√≠a un mensaje a todos los usuarios conectados
- **`enviar-mensaje-usuario-especifico.bat`**: Env√≠a mensaje a un usuario espec√≠fico
- **`enviar-mensaje-equipo-especifico.bat`**: Env√≠a mensaje a un equipo espec√≠fico
- **`enviar-mensaje-timeout.bat`**: Env√≠a mensaje con tiempo de expiraci√≥n autom√°tico
- **`enviar-mensaje-urgente.bat`**: Env√≠a mensaje de emergencia
- **`verificar-usuarios-conectados.bat`**: Verifica usuarios antes de enviar mensajes
- **`enviar-mensaje-programado.bat`**: Programa mensajes para horarios espec√≠ficos
- **`enviar-mensaje-multiples-equipos.bat`**: Env√≠a mensaje a varios equipos
- **`enviar-mensaje-confirmacion.bat`**: Env√≠a mensaje solicitando confirmaci√≥n

### **Scripts avanzados:**
- **`gestion-mensajes-interactivo.bat`**: Men√∫ interactivo para gesti√≥n de mensajes
- **`gestion-avanzada-mensajes.bat`**: Sistema completo con logging y monitoreo
- **`sistema-alertas-automatico.bat`**: Sistema de alertas autom√°ticas

### **Instrucciones de uso:**
1. Navega al directorio `scripts/38-enviar-mensajes-usuarios/`
2. Ejecuta cualquier script con doble clic o desde la l√≠nea de comandos
3. Los scripts avanzados requieren permisos de administrador
4. Algunos scripts crean archivos de configuraci√≥n y logs autom√°ticamente

---

## üìö Enlaces Relacionados

- [Cap√≠tulo 34: Gesti√≥n de Procesos](34.%20Gesti√≥n%20de%20Procesos.md)
- [Cap√≠tulo 37: Crear red hospedada](37.%20Crear%20red%20hospedada.md)
- [Cap√≠tulo 39: Env√≠o de se√±ales](39.%20Env√≠o%20de%20se√±ales.md)

## üîó Fuentes y Referencias

- **Microsoft Docs**: [MSG Command](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msg)
- **Windows Networking**: [Messenger Service](https://docs.microsoft.com/en-us/windows/win32/winmsg/messenger-service)
- **PowerShell Documentation**: [Send-Message Cmdlet](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/send-message)
- **Autor**: [Jerson Mart√≠nez](https://jersonmartinez.com)
- **Blog DevOps**: [Crashell](https://crashell.com) 
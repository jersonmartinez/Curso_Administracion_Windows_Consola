# 37. Crear red hospedada 🌐

> *"¿Alguna vez te has preguntado cómo convertir tu PC en un punto de acceso WiFi? ¿O cómo compartir tu conexión de internet con otros dispositivos? La creación de redes hospedadas es una habilidad esencial para administradores de sistemas y técnicos de red."*

## 📚 Conceptos Clave

### **Red Hospedada (Hosted Network)**
Una red virtual creada por Windows que permite compartir la conexión de internet de una tarjeta de red con otros dispositivos, convirtiendo el equipo en un punto de acceso WiFi.

### **Punto de Acceso (Access Point)**
Dispositivo que permite a otros equipos conectarse a una red inalámbrica, actuando como intermediario entre los clientes y la red principal.

### **SSID (Service Set Identifier)**
Nombre único que identifica una red WiFi, visible para los dispositivos que buscan conexiones disponibles.

### **WPA2-PSK (Wi-Fi Protected Access 2 - Pre-Shared Key)**
Protocolo de seguridad que protege la red con una contraseña compartida entre todos los dispositivos conectados.

## Comandos y herramientas principales

### `NETSH WLAN`
Comando principal para gestionar redes inalámbricas en Windows, incluyendo la creación y gestión de redes hospedadas.

**Sintaxis básica:**
```batch
netsh wlan [subcomando] [opciones]
```

**Subcomandos principales:**
- `set hostednetwork mode=allow|disallow` - Habilitar o deshabilitar redes hospedadas
- `set hostednetwork ssid="nombre"` - Establecer nombre de la red WiFi
- `set hostednetwork key="contraseña"` - Establecer contraseña de la red
- `set hostednetwork maxclient=N` - Establecer máximo número de clientes
- `start hostednetwork` - Iniciar red hospedada configurada
- `stop hostednetwork` - Detener red hospedada activa
- `show hostednetwork` - Mostrar estado y configuración de la red
- `show drivers` - Mostrar información de drivers de red inalámbrica

### `NETSH WLAN START/STOP`
Comandos para iniciar o detener una red hospedada previamente configurada.

**Sintaxis:**
```batch
netsh wlan start hostednetwork
netsh wlan stop hostednetwork
```

**Parámetros:**
- `start` - Inicia la red hospedada si está configurada
- `stop` - Detiene la red hospedada activa

### `NETSH WLAN SHOW`
Comando para mostrar información detallada sobre las redes hospedadas y su estado.

**Sintaxis:**
```batch
netsh wlan show hostednetwork
netsh wlan show drivers
netsh wlan show interfaces
```

**Información mostrada:**
- Estado de la red hospedada (iniciada/detenida)
- Número de clientes conectados
- Configuración de seguridad
- Compatibilidad del adaptador

### `NETSH INTERFACE SET INTERFACE`
Comando para habilitar o deshabilitar interfaces de red específicas.

**Sintaxis:**
```batch
netsh interface set interface "nombre_interfaz" enabled|disabled
netsh interface set interface "nombre_interfaz" sharing=enabled|disabled
```

**Parámetros:**
- `nombre_interfaz` - Nombre de la interfaz de red (Wi-Fi, Ethernet, etc.)
- `enabled|disabled` - Habilitar o deshabilitar la interfaz
- `sharing=enabled|disabled` - Configurar compartir de conexión

### Comandos adicionales utilizados
- `NET SESSION` - Verificar permisos de administrador
- `IF` - Condiciones en scripts para verificar resultados
- `PAUSE` - Pausar ejecución del script
- `ECHO` - Mostrar mensajes informativos
- `SET` - Definir variables de entorno
- `FOR /F` - Procesar archivos línea por línea
- `TIMEOUT` - Esperar un tiempo específico
- `CHOICE` - Menús interactivos en scripts

## 💡 Ejemplos Prácticos

### **Ejemplo 1: Crear una red hospedada básica**
**Propósito**: Configurar una red WiFi simple para compartir internet con dispositivos móviles.

```batch
@echo off
echo Configurando red hospedada...
netsh wlan set hostednetwork mode=allow ssid="MiCasa" key="12345678"
netsh wlan start hostednetwork
echo Red "MiCasa" creada y activada
pause
```

### **Ejemplo 2: Verificar el estado de la red**
**Propósito**: Comprobar si la red hospedada está funcionando correctamente y ver información detallada.

```batch
@echo off
echo Verificando estado de la red hospedada...
netsh wlan show hostednetwork
echo.
echo Presiona cualquier tecla para continuar...
pause >nul
```

### **Ejemplo 3: Detener la red hospedada**
**Propósito**: Desactivar la red compartida cuando ya no se necesite.

```batch
@echo off
echo Deteniendo red hospedada...
netsh wlan stop hostednetwork
echo Red hospedada detenida
pause
```

### **Ejemplo 4: Configurar red con nombre personalizado**
**Propósito**: Crear una red con un nombre específico para identificar fácilmente el punto de acceso.

```batch
@echo off
set /p nombre="Ingresa el nombre de la red: "
set /p clave="Ingresa la contraseña (mínimo 8 caracteres): "
echo Configurando red "%nombre%"...
netsh wlan set hostednetwork mode=allow ssid="%nombre%" key="%clave%"
netsh wlan start hostednetwork
echo Red "%nombre%" creada exitosamente
pause
```

### **Ejemplo 5: Habilitar compartir conexión**
**Propósito**: Configurar el compartir de internet desde la conexión principal hacia la red hospedada.

```batch
@echo off
echo Habilitando compartir de conexión...
netsh interface set interface "Ethernet" enabled
netsh interface set interface "Wi-Fi" enabled
echo Configurando compartir de conexión...
netsh interface set interface "Ethernet" sharing=enabled
echo Conexión compartida habilitada
pause
```

### **Ejemplo 6: Verificar adaptadores compatibles**
**Propósito**: Identificar qué adaptadores de red soportan la creación de redes hospedadas.

```batch
@echo off
echo Verificando adaptadores compatibles...
netsh wlan show drivers
echo.
echo Buscando adaptadores que soporten redes hospedadas...
netsh wlan show drivers | findstr "Hosted network supported"
pause
```

### **Ejemplo 7: Configurar red con seguridad avanzada**
**Propósito**: Crear una red con contraseña fuerte y configuración de seguridad optimizada.

```batch
@echo off
echo Configurando red con seguridad avanzada...
netsh wlan set hostednetwork mode=allow ssid="RedSegura2024" key="P@ssw0rd2024!"
netsh wlan set hostednetwork maxclient=10
netsh wlan start hostednetwork
echo Red segura configurada con máximo 10 clientes
pause
```

### **Ejemplo 8: Monitorear clientes conectados**
**Propósito**: Ver en tiempo real qué dispositivos están conectados a la red hospedada.

```batch
@echo off
:monitor
cls
echo Monitoreando clientes conectados...
echo ================================
netsh wlan show hostednetwork
echo.
echo Presiona Ctrl+C para salir
timeout /t 5 /nobreak >nul
goto monitor
```

### **Ejemplo 9: Configurar red temporal para eventos**
**Propósito**: Crear una red de corta duración para reuniones o eventos específicos.

```batch
@echo off
set /p evento="Nombre del evento: "
set /p duracion="Duración en minutos: "
echo Creando red para evento: %evento%
netsh wlan set hostednetwork mode=allow ssid="Evento_%evento%" key="Evento2024"
netsh wlan start hostednetwork
echo Red activada por %duracion% minutos
timeout /t %duracion% /nobreak >nul
netsh wlan stop hostednetwork
echo Red del evento detenida
pause
```

### **Ejemplo 10: Script de gestión completa**
**Propósito**: Script interactivo para gestionar completamente las redes hospedadas con múltiples opciones.

```batch
@echo off
title Gestión de Redes Hospedadas
color 0A

:menu
cls
echo ========================================
echo    GESTION DE REDES HOSPEDADAS
echo ========================================
echo.
echo 1. Crear nueva red hospedada
echo 2. Iniciar red existente
echo 3. Detener red activa
echo 4. Ver estado de la red
echo 5. Verificar adaptadores
echo 6. Configurar compartir conexión
echo 7. Monitorear clientes
echo 8. Salir
echo.
set /p opcion="Selecciona una opción (1-8): "

if "%opcion%"=="1" goto crear
if "%opcion%"=="2" goto iniciar
if "%opcion%"=="3" goto detener
if "%opcion%"=="4" goto estado
if "%opcion%"=="5" goto adaptadores
if "%opcion%"=="6" goto compartir
if "%opcion%"=="7" goto monitorear
if "%opcion%"=="8" goto salir
goto menu

:crear
cls
echo === CREAR NUEVA RED HOSPEDADA ===
set /p ssid="Nombre de la red (SSID): "
set /p key="Contraseña (mínimo 8 caracteres): "
echo.
echo Configurando red "%ssid%"...
netsh wlan set hostednetwork mode=allow ssid="%ssid%" key="%key%"
if %errorlevel%==0 (
    echo Red configurada exitosamente
    set /p iniciar="¿Deseas iniciar la red ahora? (s/n): "
    if /i "%iniciar%"=="s" goto iniciar
) else (
    echo Error al configurar la red
)
pause
goto menu

:iniciar
cls
echo === INICIAR RED HOSPEDADA ===
netsh wlan start hostednetwork
if %errorlevel%==0 (
    echo Red hospedada iniciada correctamente
) else (
    echo Error al iniciar la red
)
pause
goto menu

:detener
cls
echo === DETENER RED HOSPEDADA ===
netsh wlan stop hostednetwork
if %errorlevel%==0 (
    echo Red hospedada detenida correctamente
) else (
    echo Error al detener la red
)
pause
goto menu

:estado
cls
echo === ESTADO DE LA RED HOSPEDADA ===
netsh wlan show hostednetwork
pause
goto menu

:adaptadores
cls
echo === VERIFICAR ADAPTADORES ===
netsh wlan show drivers | findstr "Hosted network supported"
pause
goto menu

:compartir
cls
echo === CONFIGURAR COMPARTIR CONEXIÓN ===
echo Habilitando compartir de conexión...
netsh interface set interface "Ethernet" sharing=enabled
echo Compartir configurado
pause
goto menu

:monitorear
cls
echo === MONITOREAR CLIENTES ===
echo Presiona Ctrl+C para salir del monitoreo
timeout /t 3 /nobreak >nul
:loop
cls
netsh wlan show hostednetwork
timeout /t 5 /nobreak >nul
goto loop

:salir
echo Gracias por usar el gestor de redes hospedadas
exit
```



## 💡 Consejos Importantes

### **Optimización**
- **Verificar compatibilidad**: Antes de crear una red hospedada, asegúrate de que tu adaptador WiFi soporte esta función
- **Contraseñas seguras**: Usa contraseñas de al menos 8 caracteres con combinación de letras, números y símbolos
- **Límite de clientes**: Configura un límite razonable de clientes para evitar saturar la red

### **Seguridad**
- **Cambiar contraseñas regularmente**: Actualiza las contraseñas de las redes hospedadas periódicamente
- **Monitorear conexiones**: Revisa regularmente qué dispositivos están conectados
- **Desactivar cuando no se use**: Detén las redes hospedadas cuando no las necesites

### **Mejores Prácticas**
- **Nombres descriptivos**: Usa nombres de red que indiquen claramente el propósito
- **Documentar configuraciones**: Mantén un registro de las configuraciones de red
- **Pruebas de conectividad**: Verifica que los clientes puedan acceder a internet correctamente

## 🌍 Casos de Uso Reales

### **Administración de Sistemas**
- **Puntos de acceso temporales**: Crear redes para eventos corporativos o reuniones
- **Redes de emergencia**: Proporcionar conectividad cuando falla la infraestructura principal
- **Testing de aplicaciones**: Crear entornos de prueba aislados para desarrollo

### **Entornos Educativos**
- **Laboratorios móviles**: Configurar redes para clases que requieren conectividad
- **Presentaciones**: Compartir internet durante demostraciones o exposiciones
- **Trabajo colaborativo**: Facilitar la conexión entre dispositivos de estudiantes

### **Empresas**
- **Oficinas temporales**: Configurar conectividad en espacios de trabajo temporales
- **Conferencias**: Proporcionar WiFi para eventos corporativos
- **Backup de conectividad**: Mantener redes de respaldo para casos de emergencia

## 🎯 Conclusión y Siguiente Paso

¡Excelente! Has dominado la creación y gestión de redes hospedadas en Windows. Esta habilidad te permitirá convertir cualquier PC en un punto de acceso WiFi, una competencia muy valorada en administración de sistemas y soporte técnico.

**¿Qué has aprendido?**
- Configurar redes hospedadas con seguridad WPA2
- Gestionar múltiples redes simultáneamente
- Monitorear clientes conectados en tiempo real
- Automatizar la creación y gestión de redes

**Aplicaciones profesionales:**
- Técnico de soporte en empresas
- Administrador de sistemas
- Consultor de redes
- Instructor de TI

En el siguiente capítulo, aprenderás a **enviar mensajes a usuarios** conectados en la red, una habilidad complementaria que te permitirá comunicarte directamente con los dispositivos conectados a tus redes hospedadas. ¡Prepárate para dominar la comunicación en red!

---

## 📚 Enlaces Relacionados

- [Capítulo 35: Conexiones de red](35.%20Conexiones%20de%20red.md)
- [Capítulo 38: Enviar mensajes a usuarios](38.%20Enviar%20mensajes%20a%20usuarios.md)
- [Capítulo 39: Envío de señales](39.%20Envío%20de%20señales.md)

## 🔗 Fuentes y Referencias

- **Microsoft Docs**: [Netsh WLAN Commands](https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-wlan)
- **Windows Networking**: [Hosted Network](https://docs.microsoft.com/en-us/windows/win32/nativewifi/hosted-network)
- **Wi-Fi Alliance**: [WPA2 Security](https://www.wi-fi.org/discover-wi-fi/security)
- **Autor**: [Jerson Martínez](https://jersonmartinez.com)
- **Blog DevOps**: [Crashell](https://crashell.com)

---

## Scripts disponibles

En el directorio `scripts/37-crear-red-hospedada/` encontrarás los siguientes scripts para crear y gestionar redes hospedadas de manera profesional:

### 🌐 **Gestión de redes hospedadas**
- **`gestor-avanzado-redes-hospedadas.bat`** - Interfaz completa para crear, configurar, monitorear y gestionar redes hospedadas con logging y verificación de compatibilidad
- **`creacion-masiva-redes.bat`** - Herramienta para crear múltiples redes hospedadas desde archivos de configuración para eventos o departamentos

### 📋 **Instrucciones de uso**

1. **Para gestión avanzada de redes:**
   ```batch
   cd scripts\37-crear-red-hospedada
   gestor-avanzado-redes-hospedadas.bat
   ```

2. **Para creación masiva de redes:**
   - El script creará automáticamente un archivo `redes_masivas.txt` de ejemplo
   - Edita el archivo con el formato: `SSID|Contraseña|MaxClientes`
   - Ejecuta: `creacion-masiva-redes.bat`

### ⚠️ **Notas importantes**
- Ejecuta estos scripts como administrador
- Verifica que tu adaptador WiFi soporte redes hospedadas
- Usa contraseñas de al menos 8 caracteres
- Los logs se guardan en archivos de texto para auditoría

### 🔧 **Características principales**
- **Verificación de compatibilidad:** Detecta automáticamente si el sistema soporta redes hospedadas
- **Configuración persistente:** Guarda configuraciones en archivos para reutilización
- **Monitoreo en tiempo real:** Seguimiento de clientes conectados y estado de la red
- **Logging completo:** Registra todas las operaciones para auditoría y troubleshooting
- **Creación masiva:** Permite configurar múltiples redes desde archivos de configuración 
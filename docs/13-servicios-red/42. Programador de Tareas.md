# 42. Programador de Tareas ‚è∞ü§ñ

> *"La automatizaci√≥n es el futuro de la administraci√≥n de sistemas. Con el Programador de Tareas, puedes hacer que Windows trabaje para ti mientras duermes, ejecutando tareas cr√≠ticas en el momento perfecto."*

## Introducci√≥n

¬øTe imaginas tener un asistente personal que ejecute todas tus tareas repetitivas autom√°ticamente? ¬øO un sistema que mantenga tu infraestructura funcionando perfectamente sin intervenci√≥n humana? El **Programador de Tareas** de Windows es exactamente eso: tu robot personal que nunca duerme y siempre est√° listo para trabajar.

En este cap√≠tulo, descubrir√°s c√≥mo convertir tu sistema Windows en una m√°quina aut√≥noma e inteligente, capaz de ejecutar backups autom√°ticos, limpiezas programadas, monitoreos continuos y mucho m√°s. La automatizaci√≥n no es solo una conveniencia; es una necesidad en el mundo moderno de la administraci√≥n de sistemas.

## Conceptos Clave

### ‚è∞ **Tarea Programada**
Un trabajo o script que se ejecuta autom√°ticamente en momentos espec√≠ficos o bajo condiciones determinadas.

### üîÑ **Trigger (Disparador)**
Evento o condici√≥n que activa la ejecuci√≥n de una tarea programada (tiempo, inicio del sistema, evento del sistema, etc.).

### üéØ **Action (Acci√≥n)**
Comando, script o programa que se ejecuta cuando se activa la tarea.

### üìã **Condition (Condici√≥n)**
Criterios adicionales que deben cumplirse para que la tarea se ejecute (conectividad de red, estado del sistema, etc.).

## Comandos Principales

### `SCHTASKS` - Gesti√≥n de tareas programadas
Comando nativo de Windows para crear, modificar, eliminar y gestionar tareas programadas.

**Sintaxis b√°sica:**
```batch
schtasks [opciones]
```

**Opciones principales:**
- `/create` - Crear nueva tarea programada
- `/delete` - Eliminar tarea existente
- `/query` - Listar tareas programadas
- `/change` - Modificar tarea existente
- `/run` - Ejecutar tarea inmediatamente
- `/end` - Detener tarea en ejecuci√≥n

### `SCHTASKS /CREATE` - Crear tarea
Comando para crear una nueva tarea programada con par√°metros espec√≠ficos.

**Sintaxis:**
```batch
schtasks /create /tn "NombreTarea" /tr "Comando" /sc [diario|semanal|mensual|inicio] /st "HH:MM"
```

**Par√°metros principales:**
- `/tn "nombre"` - Nombre de la tarea
- `/tr "comando"` - Comando o programa a ejecutar
- `/sc frecuencia` - Frecuencia de ejecuci√≥n (daily, weekly, monthly, onstart, onlogon, onidle)
- `/st "HH:MM"` - Hora de inicio
- `/sd "MM/DD/YYYY"` - Fecha de inicio
- `/ed "MM/DD/YYYY"` - Fecha de finalizaci√≥n
- `/mo n√∫mero` - Modificador de frecuencia (ej: 1, 2, 3...)
- `/d d√≠a` - D√≠a de la semana (MON, TUE, WED, THU, FRI, SAT, SUN)
- `/ru "usuario"` - Usuario bajo el cual ejecutar la tarea
- `/rp "contrase√±a"` - Contrase√±a del usuario
- `/it` - Ejecutar solo si el usuario est√° conectado
- `/z` - Eliminar la tarea despu√©s de completarse
- `/rl nivel` - Nivel de privilegios (highest, limited)

### `SCHTASKS /QUERY` - Listar tareas
Comando para mostrar informaci√≥n sobre tareas programadas.

**Sintaxis:**
```batch
schtasks /query [/fo table|list|csv] [/v] [/tn "nombre"]
```

**Opciones:**
- `/fo formato` - Formato de salida (table, list, csv)
- `/v` - Informaci√≥n detallada
- `/tn "nombre"` - Tarea espec√≠fica

### `SCHTASKS /RUN` - Ejecutar tarea
Comando para ejecutar una tarea programada inmediatamente.

**Sintaxis:**
```batch
schtasks /run /tn "NombreTarea"
```

### `SCHTASKS /CHANGE` - Modificar tarea
Comando para modificar par√°metros de una tarea existente.

**Sintaxis:**
```batch
schtasks /change /tn "NombreTarea" /tr "NuevoComando"
```

### `SCHTASKS /DELETE` - Eliminar tarea
Comando para eliminar una tarea programada.

**Sintaxis:**
```batch
schtasks /delete /tn "NombreTarea" [/f]
```

**Opciones:**
- `/f` - Forzar eliminaci√≥n sin confirmaci√≥n

### `SCHTASKS /END` - Detener tarea
Comando para detener una tarea que est√° en ejecuci√≥n.

**Sintaxis:**
```batch
schtasks /end /tn "NombreTarea"
```

## Ejemplos Pr√°cticos

### 1. **Crear tarea diaria de backup**
```batch
schtasks /create /tn "Backup_Diario" /tr "C:\scripts\backup.bat" /sc daily /st "02:00"
```
**Prop√≥sito:** Automatizar backups diarios a las 2:00 AM cuando el sistema tiene menos carga. Esencial para proteger datos cr√≠ticos sin intervenci√≥n manual.

### 2. **Tarea semanal de limpieza del sistema**
```batch
schtasks /create /tn "Limpieza_Semanal" /tr "cleanmgr.exe /sagerun:1" /sc weekly /d MON /st "03:00"
```
**Prop√≥sito:** Mantener el sistema optimizado ejecutando limpieza autom√°tica cada lunes a las 3:00 AM. Previene la acumulaci√≥n de archivos temporales.

### 3. **Tarea que se ejecuta al iniciar el sistema**
```batch
schtasks /create /tn "Inicio_Servicios" /tr "C:\scripts\iniciar_servicios.bat" /sc onstart
```
**Prop√≥sito:** Asegurar que servicios cr√≠ticos est√©n funcionando cada vez que el sistema se reinicia. Ideal para servidores que deben estar siempre disponibles.

### 4. **Tarea con usuario espec√≠fico**
```batch
schtasks /create /tn "Reporte_Mensual" /tr "C:\scripts\generar_reporte.bat" /sc monthly /d 1 /st "09:00" /ru "DOMINIO\usuario" /rp "contrase√±a"
```
**Prop√≥sito:** Ejecutar tareas que requieren permisos espec√≠ficos o credenciales de dominio. √ötil para reportes corporativos que necesitan acceso a recursos de red.

### 5. **Tarea con m√∫ltiples triggers**
```batch
schtasks /create /tn "Monitoreo_Inteligente" /tr "C:\scripts\monitor.bat" /sc onlogon /mo 30
```
**Prop√≥sito:** Monitorear el sistema cada 30 minutos despu√©s del inicio de sesi√≥n. Perfecto para detectar problemas de rendimiento en tiempo real.

### 6. **Listar todas las tareas del sistema**
```batch
schtasks /query /fo table /v
```
**Prop√≥sito:** Obtener una vista completa de todas las tareas programadas con detalles de configuraci√≥n. Esencial para auditor√≠as de seguridad y mantenimiento.

### 7. **Ejecutar tarea inmediatamente**
```batch
schtasks /run /tn "Backup_Diario"
```
**Prop√≥sito:** Forzar la ejecuci√≥n de una tarea sin esperar su horario programado. √ötil para pruebas o situaciones de emergencia.

### 8. **Tarea con condici√≥n de red**
```batch
schtasks /create /tn "Sync_Red" /tr "C:\scripts\sincronizar.bat" /sc daily /st "06:00" /it
```
**Prop√≥sito:** Sincronizar datos solo cuando hay conectividad de red. El par√°metro `/it` requiere que el usuario est√© conectado.

### 9. **Tarea con prioridad alta**
```batch
schtasks /create /tn "Tarea_Critica" /tr "C:\scripts\tarea_critica.bat" /sc daily /st "00:00" /rl highest
```
**Prop√≥sito:** Ejecutar tareas cr√≠ticas con m√°xima prioridad del sistema. Ideal para procesos que no pueden esperar.

### 10. **Tarea con reintentos autom√°ticos**
```batch
schtasks /create /tn "Tarea_Resiliente" /tr "C:\scripts\tarea_resiliente.bat" /sc daily /st "04:00" /z
```
**Prop√≥sito:** Crear tareas que se eliminan autom√°ticamente despu√©s de completarse. √ötil para tareas √∫nicas o de limpieza.

## Scripts Avanzados

### Script para Gesti√≥n Avanzada de Tareas Programadas

**Archivo:** [`scripts/42-programador-tareas/gestion-avanzada-tareas.bat`](scripts/42-programador-tareas/gestion-avanzada-tareas.bat)

Este script proporciona una interfaz completa para gestionar tareas programadas, incluyendo creaci√≥n, modificaci√≥n, eliminaci√≥n y generaci√≥n autom√°tica de scripts de backup, limpieza y monitoreo.

### Script para Sistema de Automatizaci√≥n Completa

**Archivo:** [`scripts/42-programador-tareas/sistema-automatizacion-completa.bat`](scripts/42-programador-tareas/sistema-automatizacion-completa.bat)

Este script proporciona un sistema completo de automatizaci√≥n con archivos de configuraci√≥n, logging, backup autom√°tico, monitoreo de tareas y generaci√≥n de reportes.

## Consejos Importantes

### üîí **Seguridad**
- Usa cuentas con privilegios m√≠nimos necesarios para cada tarea
- Revisa regularmente las tareas programadas en busca de actividades sospechosas
- Implementa logging detallado para auditor√≠as de seguridad
- Usa credenciales seguras y c√°mbialas peri√≥dicamente

### ‚ö° **Optimizaci√≥n**
- Programa tareas cr√≠ticas en horarios de baja actividad del sistema
- Usa triggers inteligentes para evitar ejecuciones innecesarias
- Implementa timeouts apropiados para evitar tareas colgadas
- Monitorea el rendimiento del sistema durante ejecuciones masivas

### üõ†Ô∏è **Mejores Pr√°cticas**
- Documenta todas las tareas programadas y su prop√≥sito
- Implementa manejo de errores en scripts de automatizaci√≥n
- Crea backups de configuraciones antes de cambios masivos
- Usa nombres descriptivos para facilitar la gesti√≥n

## Casos de Uso Reales

### üè¢ **Administraci√≥n de Sistemas**
- Backups autom√°ticos de bases de datos y archivos cr√≠ticos
- Limpieza programada de logs y archivos temporales
- Monitoreo continuo de servicios y recursos del sistema
- Actualizaciones autom√°ticas de software y parches

### üéì **Educaci√≥n**
- Limpieza autom√°tica de laboratorios de computaci√≥n
- Backup de trabajos de estudiantes
- Monitoreo de uso de recursos educativos
- Generaci√≥n autom√°tica de reportes acad√©micos

### üè≠ **Empresa**
- Sincronizaci√≥n autom√°tica de datos entre sucursales
- Generaci√≥n de reportes financieros y operativos
- Mantenimiento preventivo de sistemas cr√≠ticos
- Gesti√≥n autom√°tica de licencias y recursos

## Conclusi√≥n y Siguiente Paso

¬°Incre√≠ble! Has dominado el arte de la automatizaci√≥n con el Programador de Tareas de Windows. Ahora tu sistema puede trabajar de forma inteligente y aut√≥noma, ejecutando tareas cr√≠ticas en el momento perfecto sin intervenci√≥n humana.

En el pr√≥ximo cap√≠tulo, aprender√°s sobre la **Gesti√≥n de un servidor FTP**, una habilidad fundamental para la transferencia segura de archivos en redes corporativas. Descubrir√°s c√≥mo configurar, gestionar y mantener servidores FTP robustos para compartir archivos de manera eficiente y segura.

---

## Enlaces Relacionados

- [Cap√≠tulo 41: Escritorio Remoto](41.%20Escritorio%20Remoto.md)
- [Cap√≠tulo 43: Gesti√≥n de un servidor FTP](43.%20Gesti√≥n%20de%20un%20servidor%20FTP.md)
- [Cap√≠tulo 34: Gesti√≥n de Procesos](34.%20Gesti√≥n%20de%20Procesos.md)
- [Cap√≠tulo 31: Apagar, Reiniciar y Cerrar sesi√≥n](31.%20Apagar,%20Reiniciar%20y%20Cerrar%20sesi√≥n.md)

## Fuentes y Referencias

- [Windows Task Scheduler](https://docs.microsoft.com/en-us/windows/win32/taskschd/task-scheduler-start-page)
- [SCHTASKS Command Reference](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks)
- [Task Scheduler Best Practices](https://docs.microsoft.com/en-us/windows/win32/taskschd/task-scheduler-best-practices)
- [Automation and Scripting](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/automation-and-scripting)

---

**Autor:** Jerson Mart√≠nez  
**Sitio web:** [jersonmartinez.com](https://jersonmartinez.com)  
**Blog DevOps:** [crashell.com](https://crashell.com)

---

## üìÅ Scripts disponibles

Todos los scripts de este cap√≠tulo est√°n disponibles en el directorio `scripts/42-programador-tareas/`:

### ‚è∞ **Gesti√≥n de tareas programadas**
- **`gestion-avanzada-tareas.bat`**: Interfaz completa para gestionar tareas programadas con generaci√≥n autom√°tica de scripts
- **`sistema-automatizacion-completa.bat`**: Sistema avanzado con archivos de configuraci√≥n, logging y monitoreo de tareas

### üìã **Instrucciones de uso**
1. Navega al directorio `scripts/42-programador-tareas/`
2. Ejecuta cualquier script con doble clic o desde la l√≠nea de comandos
3. Los scripts crean archivos de configuraci√≥n y logs autom√°ticamente
4. Para el sistema avanzado, edita el archivo `config/automatizacion.conf` seg√∫n tus necesidades 
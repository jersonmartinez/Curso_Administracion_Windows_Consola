# 📂 Expandir archivos comprimidos

> *"Descomprimir no es solo extraer, es liberar el potencial contenido en cada archivo"* 🔓

¿Te has encontrado alguna vez con un archivo ZIP que necesitas abrir urgentemente pero no tienes WinRAR instalado? ¿O has recibido un backup comprimido que necesitas restaurar inmediatamente? La **expansión de archivos comprimidos** es la habilidad complementaria a la compresión, y Windows ofrece herramientas nativas poderosas para manejar esta tarea.

En este capítulo, descubriremos cómo extraer contenido de diferentes formatos de archivos comprimidos, desde ZIP hasta archivos nativos de Windows, usando solo la línea de comandos.

## 🎯 ¿Qué aprenderás?

- **Expansión de archivos ZIP** con PowerShell y herramientas nativas
- **Descompresión de archivos nativos** de Windows
- **Manejo de archivos protegidos** con contraseña
- **Scripts automatizados** para extracción masiva
- **Técnicas avanzadas** de expansión y verificación

---

## 🛠️ Comandos y herramientas principales

### 📦 PowerShell Expand-Archive

PowerShell proporciona comandos modernos y flexibles para expandir archivos comprimidos. Es la herramienta más versátil para manejar archivos ZIP y otros formatos comprimidos.

**Sintaxis básica:**
```powershell
Expand-Archive -Path <archivo_comprimido> -DestinationPath <directorio_destino>
```

**Parámetros principales:**
- `-Path` - Ruta del archivo comprimido
- `-DestinationPath` - Directorio donde extraer
- `-Force` - Sobrescribir archivos existentes
- `-Verbose` - Mostrar información detallada

**Comandos adicionales utilizados:**
- `CERTUTIL` - Calcula hashes MD5 para verificación de integridad
- `DIR` - Lista archivos y directorios
- `FORFILES` - Busca archivos por fecha y ejecuta comandos
- `FC` - Compara archivos para verificar integridad
- `MKDIR` - Crea directorios
- `XCOPY` - Copia archivos con opciones avanzadas

### 🗜️ COMPACT - Descompresión nativa

El comando `COMPACT` también puede descomprimir archivos nativos de Windows que fueron comprimidos con el mismo comando.

**Sintaxis básica:**
```batch
COMPACT /U [/S[:dir]] [/A] [/I] [/F] [/Q] [filename [...]]
```

**Parámetros principales:**
- `/U` - Descomprime archivos especificados
- `/S` - Aplica a subdirectorios
- `/A` - Muestra archivos con atributos ocultos o del sistema
- `/I` - Continúa operación después de errores
- `/F` - Fuerza descompresión en archivos ya descomprimidos
- `/Q` - Modo silencioso

### 🔧 TAR - Archivos TAR (Windows 10+)

Windows 10 y posteriores incluyen soporte nativo para archivos TAR, comúnmente usados en entornos Unix/Linux.

**Sintaxis básica:**
```batch
TAR -xf <archivo.tar> -C <directorio_destino>
```

**Parámetros principales:**
- `-x` - Extraer archivos
- `-f` - Especificar archivo
- `-C` - Cambiar al directorio antes de extraer
- `-z` - Descomprimir con gzip
- `-v` - Modo verbose (mostrar archivos)

---

## 💡 Ejemplos prácticos

### **Ejemplo 1: Expansión básica de archivos ZIP**

**Propósito:** Extraer contenido de archivos ZIP estándar. Fundamental para administradores que reciben backups, distribuciones de software, o archivos compartidos en formato ZIP.

```powershell
# Expandir un archivo ZIP básico
Expand-Archive -Path "C:\Descargas\backup.zip" -DestinationPath "C:\Restauracion\"

# Expandir con sobrescritura forzada
Expand-Archive -Path "C:\Descargas\proyecto.zip" -DestinationPath "C:\Proyectos\" -Force

# Expandir con información detallada
Expand-Archive -Path "C:\Descargas\datos.zip" -DestinationPath "C:\Datos\" -Verbose
```

**Resultado esperado:**
```
VERBOSE: Performing the operation "Expand Archive" on target "C:\Descargas\datos.zip".
VERBOSE: Created "C:\Datos\documento1.txt"
VERBOSE: Created "C:\Datos\documento2.txt"
VERBOSE: Created "C:\Datos\configuracion.ini"
```

### **Ejemplo 2: Descompresión de archivos nativos de Windows**

**Propósito:** Descomprimir archivos que fueron comprimidos con el comando COMPACT. Esencial para administradores que trabajan con archivos del sistema o backups nativos de Windows.

```batch
:: Descomprimir archivos específicos
compact /u documento1.txt documento2.txt

:: Descomprimir directorio completo
compact /u /s C:\Logs\

:: Descomprimir con modo silencioso
compact /u /s /q C:\Backups\
```

### **Ejemplo 3: Expansión de archivos TAR**

**Propósito:** Extraer archivos TAR que son comunes en entornos Linux y desarrollo. Útil para administradores que trabajan en entornos híbridos o reciben archivos de sistemas Unix/Linux.

```batch
:: Expandir archivo TAR básico
tar -xf archivo.tar -C C:\Destino\

:: Expandir archivo TAR comprimido con GZIP
tar -xzf archivo.tar.gz -C C:\Destino\

:: Expandir con información detallada
tar -xzf archivo.tar.gz -C C:\Destino\ -v
```

### **Ejemplo 4: Script de expansión masiva**

**Propósito:** Extraer múltiples archivos comprimidos de forma automática. Ideal para administradores que reciben lotes de backups o distribuciones de software que necesitan ser procesados rápidamente.

```batch
@echo off
:: Expansor masivo de archivos comprimidos
title 📦 Expansor Masivo
color 0A

set /p directorio="Directorio con archivos comprimidos: "
set /p destino="Directorio de destino: "

echo ========================================
echo    📦 EXPANSOR MASIVO DE ARCHIVOS
echo ========================================
echo.

if not exist "%destino%" mkdir "%destino%"

echo 🔍 Buscando archivos comprimidos...
echo.

:: Procesar archivos ZIP
for %%f in ("%directorio%\*.zip") do (
    echo 📦 Expandiendo: %%~nxf
    powershell -Command "Expand-Archive -Path '%%f' -DestinationPath '%destino%' -Force"
    if !errorlevel!==0 (
        echo ✅ %%~nxf expandido exitosamente
    ) else (
        echo ❌ Error al expandir %%~nxf
    )
)

:: Procesar archivos TAR
for %%f in ("%directorio%\*.tar") do (
    echo 📦 Expandiendo: %%~nxf
    tar -xf "%%f" -C "%destino%"
    if !errorlevel!==0 (
        echo ✅ %%~nxf expandido exitosamente
    ) else (
        echo ❌ Error al expandir %%~nxf
    )
)

:: Procesar archivos TAR.GZ
for %%f in ("%directorio%\*.tar.gz") do (
    echo 📦 Expandiendo: %%~nxf
    tar -xzf "%%f" -C "%destino%"
    if !errorlevel!==0 (
        echo ✅ %%~nxf expandido exitosamente
    ) else (
        echo ❌ Error al expandir %%~nxf
    )
)

echo.
echo 🎉 Expansión masiva completada.
pause
```

### **Ejemplo 5: Expansión con verificación de integridad**

**Propósito:** Extraer archivos comprimidos verificando que no se corrompan durante el proceso. Crítico para backups importantes o archivos de software que deben mantener su integridad.

```batch
@echo off
:: Expansor con verificación de integridad
title 🔐 Expansor Seguro
color 0B

set /p archivo="Archivo comprimido: "
set /p destino="Directorio de destino: "

echo ========================================
echo    🔐 EXPANSOR CON VERIFICACIÓN
echo ========================================
echo.

:: Verificar que el archivo existe
if not exist "%archivo%" (
    echo ❌ Archivo no encontrado: %archivo%
    pause
    exit /b 1
)

:: Crear directorio de destino si no existe
if not exist "%destino%" mkdir "%destino%"

:: Calcular hash del archivo comprimido
echo 🔍 Calculando hash del archivo comprimido...
certutil -hashfile "%archivo%" MD5 > hash_comprimido.txt

:: Expandir archivo
echo 📦 Expandiendo archivo...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"

if %errorlevel%==0 (
    echo ✅ Archivo expandido exitosamente
    
    :: Verificar archivos extraídos
    echo 🔍 Verificando archivos extraídos...
    dir "%destino%" /s /b > archivos_extraidos.txt
    
    echo 📊 Resumen de expansión:
    echo - Archivo original: %archivo%
    echo - Directorio destino: %destino%
    echo - Archivos extraídos: 
    type archivos_extraidos.txt
    
) else (
    echo ❌ Error al expandir archivo
)

:: Limpiar archivos temporales
del hash_comprimido.txt archivos_extraidos.txt 2>nul

echo.
pause
```

### **Ejemplo 6: Expansión de archivos de backup**

**Propósito:** Restaurar backups comprimidos de manera segura y organizada. Esencial para administradores de sistemas que necesitan restaurar configuraciones o datos de respaldo.

```batch
@echo off
:: Restaurador de backups comprimidos
title 🗄️ Restaurador de Backups
color 0C

set /p backup="Archivo de backup: "
set /p destino="Directorio de restauración: "

echo ========================================
echo    🗄️ RESTAURADOR DE BACKUPS
echo ========================================
echo.

:: Verificar espacio disponible
for %%d in ("%destino%") do set "espacio_destino=%%~zd"
for %%f in ("%backup%") do set "tamaño_backup=%%~zf"

echo 📊 Información de restauración:
echo - Backup: %backup%
echo - Tamaño: %tamaño_backup% bytes
echo - Destino: %destino%
echo.

:: Crear directorio de destino con timestamp
set "destino_final=%destino%\restauracion_%date:~-4,4%%date:~-10,2%%date:~-7,2%_%time:~0,2%%time:~3,2%"
set "destino_final=%destino_final: =0%"
mkdir "%destino_final%"

echo 🔄 Restaurando backup...
powershell -Command "Expand-Archive -Path '%backup%' -DestinationPath '%destino_final%' -Force"

if %errorlevel%==0 (
    echo ✅ Backup restaurado exitosamente en: %destino_final%
    
    :: Mostrar contenido restaurado
    echo 📋 Contenido restaurado:
    dir "%destino_final%" /s /b
) else (
    echo ❌ Error al restaurar backup
)

echo.
pause
```

### **Ejemplo 7: Expansión de archivos de distribución de software**

**Propósito:** Extraer paquetes de software distribuidos en formato comprimido. Fundamental para administradores de sistemas que despliegan software en múltiples equipos.

```batch
@echo off
:: Extractor de paquetes de software
title 🚀 Extractor de Software
color 0D

set /p paquete="Paquete de software: "
set /p version="Versión (ej: 1.0.0): "

echo ========================================
echo    🚀 EXTRACTOR DE PAQUETES DE SOFTWARE
echo ========================================
echo.

:: Directorio de instalación
set "dir_instalacion=C:\Software\%version%"

:: Crear directorio de instalación
if exist "%dir_instalacion%" (
    echo ⚠️ El directorio ya existe. ¿Sobrescribir? (S/N)
    set /p confirmar=
    if /i "%confirmar%"=="S" (
        rmdir /s /q "%dir_instalacion%"
    ) else (
        echo ❌ Operación cancelada
        pause
        exit /b 1
    )
)

mkdir "%dir_instalacion%"

echo 🔄 Extrayendo paquete de software...
powershell -Command "Expand-Archive -Path '%paquete%' -DestinationPath '%dir_instalacion%' -Force"

if %errorlevel%==0 (
    echo ✅ Software extraído exitosamente
    
    :: Buscar archivos de instalación
    echo 🔍 Buscando archivos de instalación...
    dir "%dir_instalacion%" /s /b | findstr /i "setup\|install\|\.exe" > archivos_instalacion.txt
    
    if exist archivos_instalacion.txt (
        echo 📋 Archivos de instalación encontrados:
        type archivos_instalacion.txt
    )
    
    del archivos_instalacion.txt 2>nul
) else (
    echo ❌ Error al extraer software
)

echo.
pause
```

### **Ejemplo 8: Expansión de archivos de configuración**

**Propósito:** Extraer configuraciones comprimidas para aplicarlas a sistemas. Útil para administradores que necesitan replicar configuraciones en múltiples equipos.

```batch
:: Expandir configuraciones del sistema
powershell -Command "Expand-Archive -Path 'C:\Backups\configs.zip' -DestinationPath 'C:\Configuraciones\' -Force"

:: Expandir configuraciones de aplicaciones
powershell -Command "Expand-Archive -Path 'C:\Backups\app_configs.zip' -DestinationPath 'C:\Users\%USERNAME%\AppData\Local\' -Force"

:: Expandir configuraciones de red
powershell -Command "Expand-Archive -Path 'C:\Backups\network_configs.zip' -DestinationPath 'C:\Windows\System32\config\' -Force"
```

### **Ejemplo 9: Expansión de archivos multimedia**

**Propósito:** Extraer archivos multimedia comprimidos para su procesamiento o distribución. Útil para editores de contenido, diseñadores, o administradores de contenido web.

```batch
@echo off
:: Extractor de archivos multimedia
title 🎨 Extractor Multimedia
color 0E

set /p archivo="Archivo multimedia comprimido: "
set /p categoria="Categoría (imagenes/videos/audio): "

echo ========================================
echo    🎨 EXTRACTOR DE ARCHIVOS MULTIMEDIA
echo ========================================
echo.

:: Directorios por categoría
if /i "%categoria%"=="imagenes" set "destino=C:\Multimedia\Imagenes"
if /i "%categoria%"=="videos" set "destino=C:\Multimedia\Videos"
if /i "%categoria%"=="audio" set "destino=C:\Multimedia\Audio"

if not exist "%destino%" mkdir "%destino%"

echo 🔄 Extrayendo archivos multimedia...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"

if %errorlevel%==0 (
    echo ✅ Archivos multimedia extraídos
    
    :: Mostrar estadísticas
    echo 📊 Estadísticas de extracción:
    dir "%destino%" /s /b | find /c /v "" > temp_count.txt
    set /p count=<temp_count.txt
    echo - Archivos extraídos: %count%
    del temp_count.txt
    
    :: Mostrar tipos de archivos
    echo 📋 Tipos de archivos encontrados:
    dir "%destino%" /s /b | findstr /i "\.jpg\|\.png\|\.gif\|\.mp4\|\.avi\|\.mp3\|\.wav"
) else (
    echo ❌ Error al extraer archivos multimedia
)

echo.
pause
```

### **Ejemplo 10: Expansión de archivos de desarrollo**

**Propósito:** Extraer proyectos de desarrollo comprimidos para su edición o compilación. Esencial para desarrolladores que reciben código fuente en formato comprimido.

```batch
@echo off
:: Extractor de proyectos de desarrollo
title 💻 Extractor de Proyectos Dev
color 0F

set /p proyecto="Proyecto comprimido: "
set /p lenguaje="Lenguaje de programación: "

echo ========================================
echo    💻 EXTRACTOR DE PROYECTOS DE DESARROLLO
echo ========================================
echo.

:: Directorio de proyectos
set "dir_proyectos=C:\Proyectos\%lenguaje%"
if not exist "%dir_proyectos%" mkdir "%dir_proyectos%"

:: Extraer proyecto
echo 🔄 Extrayendo proyecto...
powershell -Command "Expand-Archive -Path '%proyecto%' -DestinationPath '%dir_proyectos%' -Force"

if %errorlevel%==0 (
    echo ✅ Proyecto extraído exitosamente
    
    :: Buscar archivos de configuración del proyecto
    echo 🔍 Analizando estructura del proyecto...
    
    :: Buscar archivos de configuración comunes
    dir "%dir_proyectos%" /s /b | findstr /i "package\.json\|requirements\.txt\|pom\.xml\|\.sln\|\.csproj" > config_files.txt
    
    if exist config_files.txt (
        echo 📋 Archivos de configuración encontrados:
        type config_files.txt
    )
    
    :: Buscar archivos de código fuente
    echo 📝 Archivos de código fuente:
    dir "%dir_proyectos%" /s /b | findstr /i "\.js\|\.py\|\.java\|\.cs\|\.cpp\|\.h" | find /c /v ""
    
    del config_files.txt 2>nul
) else (
    echo ❌ Error al extraer proyecto
)

echo.
pause
```

### **Ejemplo 11: Expansión con filtrado de archivos**

**Propósito:** Extraer solo archivos específicos de un archivo comprimido. Útil cuando solo se necesitan ciertos archivos y no todo el contenido.

```powershell
# Extraer solo archivos de configuración
$zipPath = "C:\Descargas\proyecto.zip"
$destPath = "C:\Configuraciones\"
$tempPath = "C:\Temp\extraccion_temp\"

# Crear directorio temporal
New-Item -ItemType Directory -Path $tempPath -Force | Out-Null

# Extraer todo a directorio temporal
Expand-Archive -Path $zipPath -DestinationPath $tempPath -Force

# Mover solo archivos de configuración
Get-ChildItem -Path $tempPath -Recurse -Include "*.ini", "*.cfg", "*.conf", "*.json" | 
    ForEach-Object {
        $relativePath = $_.FullName.Substring($tempPath.Length)
        $destFile = Join-Path $destPath $relativePath
        $destDir = Split-Path $destFile -Parent
        
        if (!(Test-Path $destDir)) {
            New-Item -ItemType Directory -Path $destDir -Force | Out-Null
        }
        
        Copy-Item $_.FullName $destFile -Force
    }

# Limpiar directorio temporal
Remove-Item $tempPath -Recurse -Force

Write-Host "✅ Archivos de configuración extraídos exitosamente"
```

### **Ejemplo 12: Expansión de archivos de red**

**Propósito:** Extraer archivos comprimidos ubicados en recursos de red. Útil para administradores que trabajan con archivos compartidos en servidores.

```batch
@echo off
:: Extractor de archivos de red
title 🌐 Extractor de Red
color 0A

set /p ruta_red="Ruta de red del archivo: "
set /p destino_local="Directorio local de destino: "

echo ========================================
echo    🌐 EXTRACTOR DE ARCHIVOS DE RED
echo ========================================
echo.

:: Verificar conectividad de red
if exist "%ruta_red%" (
    echo ✅ Conexión de red establecida
    
    :: Crear directorio de destino
    if not exist "%destino_local%" mkdir "%destino_local%"
    
    :: Extraer archivo de red
    echo 🔄 Extrayendo archivo de red...
    powershell -Command "Expand-Archive -Path '%ruta_red%' -DestinationPath '%destino_local%' -Force"
    
    if %errorlevel%==0 (
        echo ✅ Archivo extraído exitosamente desde red
    ) else (
        echo ❌ Error al extraer archivo de red
    )
) else (
    echo ❌ No se puede acceder al archivo de red
    echo 💡 Verifica la conectividad y permisos de red
)

echo.
pause
```

### **Ejemplo 13: Expansión con validación de contenido**

**Propósito:** Extraer archivos comprimidos y validar que el contenido sea el esperado. Crítico para archivos importantes donde la integridad es esencial.

```batch
@echo off
:: Extractor con validación de contenido
title ✅ Extractor Validado
color 0B

set /p archivo="Archivo a extraer: "
set /p destino="Directorio de destino: "
set /p archivo_esperado="Archivo que debe contener (ej: README.txt): "

echo ========================================
echo    ✅ EXTRACTOR CON VALIDACIÓN
echo ========================================
echo.

:: Extraer archivo
echo 🔄 Extrayendo archivo...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"

if %errorlevel%==0 (
    echo ✅ Archivo extraído
    
    :: Validar contenido esperado
    echo 🔍 Validando contenido...
    if exist "%destino%\%archivo_esperado%" (
        echo ✅ Archivo esperado encontrado: %archivo_esperado%
        
        :: Mostrar información del archivo
        echo 📋 Información del archivo:
        dir "%destino%\%archivo_esperado%"
    ) else (
        echo ⚠️ Archivo esperado no encontrado: %archivo_esperado%
        echo 📋 Contenido extraído:
        dir "%destino%" /b
    )
) else (
    echo ❌ Error al extraer archivo
)

echo.
pause
```

### **Ejemplo 14: Expansión programada de backups**

**Propósito:** Crear un script que se puede programar para expandir backups automáticamente. Útil para sistemas que reciben backups regulares que necesitan ser procesados.

```batch
@echo off
:: Expansor programado de backups
title ⏰ Expansor Programado
color 0C

:: Configuración
set "dir_backups=C:\Backups\Comprimidos"
set "dir_restauracion=C:\Backups\Restaurados"
set "log_file=C:\Logs\expansion_%date:~-4,4%%date:~-10,2%%date:~-7,2%.log"

echo ========================================
echo    ⏰ EXPANSOR PROGRAMADO DE BACKUPS
echo ========================================
echo Fecha: %date% %time%
echo.

:: Crear directorio de restauración si no existe
if not exist "%dir_restauracion%" mkdir "%dir_restauracion%"

:: Procesar backups comprimidos
for %%f in ("%dir_backups%\*.zip") do (
    echo [%time%] Procesando: %%~nxf
    powershell -Command "Expand-Archive -Path '%%f' -DestinationPath '%dir_restauracion%' -Force" >> "%log_file%" 2>&1
    
    if !errorlevel!==0 (
        echo [%time%] ✅ %%~nxf expandido exitosamente
    ) else (
        echo [%time%] ❌ Error al expandir %%~nxf
    )
)

echo ✅ Procesamiento de backups completado.
echo 📄 Log guardado en: %log_file%
```

### **Ejemplo 15: Expansión de archivos con manejo de errores**

**Propósito:** Extraer archivos comprimidos con manejo robusto de errores. Esencial para scripts de producción que deben ser confiables.

```batch
@echo off
:: Extractor con manejo de errores
title 🛡️ Extractor Robusto
color 0D

set /p archivo="Archivo a extraer: "
set /p destino="Directorio de destino: "

echo ========================================
echo    🛡️ EXTRACTOR CON MANEJO DE ERRORES
echo ========================================
echo.

:: Verificar archivo de entrada
if not exist "%archivo%" (
    echo ❌ Error: Archivo no encontrado - %archivo%
    pause
    exit /b 1
)

:: Verificar espacio disponible
for %%d in ("%destino%") do set "espacio_destino=%%~zd"
for %%f in ("%archivo%") do set "tamaño_archivo=%%~zf"

if %tamaño_archivo% gtr %espacio_destino% (
    echo ❌ Error: Espacio insuficiente en destino
    echo - Tamaño archivo: %tamaño_archivo% bytes
    echo - Espacio disponible: %espacio_destino% bytes
    pause
    exit /b 1
)

:: Crear directorio de destino
if not exist "%destino%" (
    echo 🔄 Creando directorio de destino...
    mkdir "%destino%"
    if !errorlevel! neq 0 (
        echo ❌ Error: No se pudo crear directorio de destino
        pause
        exit /b 1
    )
)

:: Intentar extraer archivo
echo 🔄 Extrayendo archivo...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force" 2>error.log

if %errorlevel%==0 (
    echo ✅ Archivo extraído exitosamente
    
    :: Verificar contenido extraído
    dir "%destino%" /b >nul 2>&1
    if !errorlevel!==0 (
        echo 📋 Contenido extraído:
        dir "%destino%" /b
    ) else (
        echo ⚠️ Advertencia: Directorio de destino está vacío
    )
) else (
    echo ❌ Error al extraer archivo
    echo 📄 Detalles del error:
    type error.log
)

:: Limpiar archivo de error
del error.log 2>nul

echo.
pause
```

---

## 🎯 Script para gestión avanzada de expansión

**Propósito:** Crear un sistema completo de gestión de expansión de archivos con interfaz interactiva que permita al usuario manejar diferentes tipos de archivos comprimidos y opciones de extracción.

```batch
@echo off
:: Gestor avanzado de expansión
title 📂 Gestor Avanzado de Expansión
color 0A

:menu
cls
echo ========================================
echo    📂 GESTOR AVANZADO DE EXPANSIÓN
echo ========================================
echo.
echo 1. 📦 Expandir archivo ZIP
echo 2. 🗜️ Descomprimir archivos nativos
echo 3. 📋 Expandir archivo TAR
echo 4. 🔍 Ver contenido sin extraer
echo 5. 📊 Expansión masiva
echo 6. 🔐 Expansión con verificación
echo 7. 🚪 Salir
echo.
set /p opcion="Selecciona una opción: "

if "%opcion%"=="1" goto expandir_zip
if "%opcion%"=="2" goto descomprimir_nativo
if "%opcion%"=="3" goto expandir_tar
if "%opcion%"=="4" goto ver_contenido
if "%opcion%"=="5" goto expansion_masiva
if "%opcion%"=="6" goto expansion_verificada
if "%opcion%"=="7" goto salir
goto menu

:expandir_zip
cls
echo ========================================
echo         📦 EXPANDIR ARCHIVO ZIP
echo ========================================
echo.
set /p archivo="Archivo ZIP: "
set /p destino="Directorio de destino: "
if exist "%archivo%" (
    echo 🔄 Expandiendo archivo ZIP...
    powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"
    echo ✅ Archivo ZIP expandido.
) else (
    echo ❌ Archivo no encontrado.
)
pause
goto menu

:descomprimir_nativo
cls
echo ========================================
echo         🗜️ DESCOMPRIMIR ARCHIVOS NATIVOS
echo ========================================
echo.
set /p archivo="Archivo o directorio: "
if exist "%archivo%" (
    echo 🔄 Descomprimiendo archivos nativos...
    compact /u /s "%archivo%"
    echo ✅ Archivos descomprimidos.
) else (
    echo ❌ Archivo/directorio no encontrado.
)
pause
goto menu

:expandir_tar
cls
echo ========================================
echo         📋 EXPANDIR ARCHIVO TAR
echo ========================================
echo.
set /p archivo="Archivo TAR: "
set /p destino="Directorio de destino: "
if exist "%archivo%" (
    echo 🔄 Expandiendo archivo TAR...
    tar -xf "%archivo%" -C "%destino%"
    echo ✅ Archivo TAR expandido.
) else (
    echo ❌ Archivo no encontrado.
)
pause
goto menu

:ver_contenido
cls
echo ========================================
echo         🔍 VER CONTENIDO SIN EXTRAER
echo ========================================
echo.
set /p archivo="Archivo comprimido: "
if exist "%archivo%" (
    echo 📋 Contenido del archivo:
    powershell -Command "Get-ChildItem -Path '%archivo%' -Recurse | Select-Object Name, Length"
) else (
    echo ❌ Archivo no encontrado.
)
pause
goto menu

:expansion_masiva
cls
echo ========================================
echo         📊 EXPANSIÓN MASIVA
echo ========================================
echo.
set /p directorio="Directorio con archivos: "
set /p destino="Directorio de destino: "
if exist "%directorio%" (
    echo 🔄 Procesando archivos comprimidos...
    for %%f in ("%directorio%\*.zip") do (
        echo Expandiendo: %%~nxf
        powershell -Command "Expand-Archive -Path '%%f' -DestinationPath '%destino%' -Force"
    )
    echo ✅ Expansión masiva completada.
) else (
    echo ❌ Directorio no encontrado.
)
pause
goto menu

:expansion_verificada
cls
echo ========================================
echo         🔐 EXPANSIÓN CON VERIFICACIÓN
echo ========================================
echo.
set /p archivo="Archivo a expandir: "
set /p destino="Directorio de destino: "
if exist "%archivo%" (
    echo 🔍 Verificando integridad...
    certutil -hashfile "%archivo%" MD5 > hash_temp.txt
    
    echo 🔄 Expandiendo archivo...
    powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"
    
    if %errorlevel%==0 (
        echo ✅ Expansión verificada exitosamente.
    ) else (
        echo ❌ Error en la expansión.
    )
    
    del hash_temp.txt 2>nul
) else (
    echo ❌ Archivo no encontrado.
)
pause
goto menu

:salir
exit
```

---

## 💡 Consejos importantes

### 🎯 **Optimización de expansión**
- **Verificar espacio libre** antes de expandir archivos grandes
- **Usar directorios temporales** para archivos grandes
- **Limpiar archivos temporales** después de la expansión
- **Verificar integridad** de archivos críticos

### 🔧 **Mejores prácticas**
- **Mantener estructura de directorios** original
- **Usar rutas absolutas** para evitar confusiones
- **Documentar procesos** de expansión
- **Crear backups** antes de sobrescribir archivos

### ⚠️ **Consideraciones de seguridad**
- **Verificar origen** de archivos comprimidos
- **Escanear con antivirus** archivos extraídos
- **Revisar permisos** de archivos extraídos
- **No expandir archivos** de fuentes no confiables

---

## 🌟 Casos de uso reales

### 🏢 **Administración de servidores**
- **Restauración de backups** comprimidos automáticamente
- **Despliegue de configuraciones** desde archivos ZIP
- **Actualización de software** distribuido en formato comprimido

### 💻 **Desarrollo de software**
- **Extracción de librerías** y dependencias
- **Despliegue de releases** de software
- **Restauración de proyectos** desde backups

### 🎨 **Multimedia y diseño**
- **Extracción de assets** comprimidos
- **Restauración de proyectos** de diseño
- **Distribución de contenido** multimedia

### 🔧 **Mantenimiento de sistemas**
- **Restauración de configuraciones** del sistema
- **Extracción de logs** comprimidos
- **Despliegue de parches** y actualizaciones

---

## 🎓 Conclusión y siguiente paso

¡Excelente progreso! 🎉 Has completado el ciclo de gestión de archivos comprimidos, desde la compresión hasta la expansión. Ahora puedes manejar cualquier tipo de archivo comprimido con confianza y eficiencia.

La expansión de archivos es una habilidad complementaria esencial que completa tu arsenal de herramientas de administración de sistemas. Desde restaurar backups hasta desplegar software, estas técnicas te permitirán trabajar con eficiencia en cualquier entorno.

**¿Qué sigue?** En el próximo capítulo, exploraremos **llamadas a programas externos** 🔗, donde aprenderás a integrar herramientas de terceros, ejecutar aplicaciones desde scripts, y crear sistemas híbridos que combinen lo mejor de Windows con software especializado.

¡Prepárate para expandir tus horizontes más allá de las herramientas nativas! 🚀

---

## 📁 Scripts disponibles

En el directorio `scripts/23-expandir-archivos-comprimidos/` encontrarás los siguientes scripts listos para usar:

### 🔧 **Scripts de expansión básica**
- `expansor-masivo.bat` - Expansión masiva de múltiples archivos comprimidos
- `expansor-seguro.bat` - Expansión con verificación de integridad
- `extractor-robusto.bat` - Extractor con manejo robusto de errores

### 🗄️ **Scripts de backup y restauración**
- `restaurador-backups.bat` - Restaurador de backups comprimidos
- `expansor-programado.bat` - Expansor programado de backups automáticos

### 🚀 **Scripts especializados**
- `extractor-software.bat` - Extractor de paquetes de software
- `extractor-multimedia.bat` - Extractor de archivos multimedia
- `extractor-proyectos-dev.bat` - Extractor de proyectos de desarrollo
- `extractor-red.bat` - Extractor de archivos de red
- `extractor-validado.bat` - Extractor con validación de contenido

### 🎯 **Gestor completo**
- `gestor-avanzado-expansion.bat` - Gestor completo con interfaz interactiva

**Para usar estos scripts:**
1. Navega al directorio `scripts/23-expandir-archivos-comprimidos/`
2. Ejecuta el script deseado con doble clic o desde la línea de comandos
3. Sigue las instrucciones en pantalla

---

## 📚 Fuentes y referencias

### 🔗 **Enlaces relacionados**
- [Compresión de archivos](22.%20Compresión%20de%20archivos%20y%20directorios.md) - Técnicas de compresión
- [Gestión de archivos](4.%20Gestión%20de%20ficheros%20o%20archivos.md) - Operaciones básicas con archivos
- [Variables](15.%20Variables.md) - Manejo de variables en scripts

### 🌐 **Recursos externos**
- [PowerShell Expand-Archive](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive)
- [Windows TAR Command](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/tar)
- [File Compression and Decompression](https://docs.microsoft.com/en-us/windows/win32/fileio/file-compression-and-decompression)

### 👨‍💻 **Autor**
**Jerson Martínez** - [jersonmartinez.com](https://jersonmartinez.com) | [crashell.com](https://crashell.com)

*Administrador de sistemas y DevOps Engineer especializado en automatización y optimización de infraestructuras Windows.* 
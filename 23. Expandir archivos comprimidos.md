# ğŸ“‚ Expandir archivos comprimidos

> *"Descomprimir no es solo extraer, es liberar el potencial contenido en cada archivo"* ğŸ”“

Â¿Te has encontrado alguna vez con un archivo ZIP que necesitas abrir urgentemente pero no tienes WinRAR instalado? Â¿O has recibido un backup comprimido que necesitas restaurar inmediatamente? La **expansiÃ³n de archivos comprimidos** es la habilidad complementaria a la compresiÃ³n, y Windows ofrece herramientas nativas poderosas para manejar esta tarea.

En este capÃ­tulo, descubriremos cÃ³mo extraer contenido de diferentes formatos de archivos comprimidos, desde ZIP hasta archivos nativos de Windows, usando solo la lÃ­nea de comandos.

## ğŸ¯ Â¿QuÃ© aprenderÃ¡s?

- **ExpansiÃ³n de archivos ZIP** con PowerShell y herramientas nativas
- **DescompresiÃ³n de archivos nativos** de Windows
- **Manejo de archivos protegidos** con contraseÃ±a
- **Scripts automatizados** para extracciÃ³n masiva
- **TÃ©cnicas avanzadas** de expansiÃ³n y verificaciÃ³n

---

## ğŸ› ï¸ Comandos y herramientas principales

### ğŸ“¦ PowerShell Expand-Archive

PowerShell proporciona comandos modernos y flexibles para expandir archivos comprimidos. Es la herramienta mÃ¡s versÃ¡til para manejar archivos ZIP y otros formatos comprimidos.

**Sintaxis bÃ¡sica:**
```powershell
Expand-Archive -Path <archivo_comprimido> -DestinationPath <directorio_destino>
```

**ParÃ¡metros principales:**
- `-Path` - Ruta del archivo comprimido
- `-DestinationPath` - Directorio donde extraer
- `-Force` - Sobrescribir archivos existentes
- `-Verbose` - Mostrar informaciÃ³n detallada

**Comandos adicionales utilizados:**
- `CERTUTIL` - Calcula hashes MD5 para verificaciÃ³n de integridad
- `DIR` - Lista archivos y directorios
- `FORFILES` - Busca archivos por fecha y ejecuta comandos
- `FC` - Compara archivos para verificar integridad
- `MKDIR` - Crea directorios
- `XCOPY` - Copia archivos con opciones avanzadas

### ğŸ—œï¸ COMPACT - DescompresiÃ³n nativa

El comando `COMPACT` tambiÃ©n puede descomprimir archivos nativos de Windows que fueron comprimidos con el mismo comando.

**Sintaxis bÃ¡sica:**
```batch
COMPACT /U [/S[:dir]] [/A] [/I] [/F] [/Q] [filename [...]]
```

**ParÃ¡metros principales:**
- `/U` - Descomprime archivos especificados
- `/S` - Aplica a subdirectorios
- `/A` - Muestra archivos con atributos ocultos o del sistema
- `/I` - ContinÃºa operaciÃ³n despuÃ©s de errores
- `/F` - Fuerza descompresiÃ³n en archivos ya descomprimidos
- `/Q` - Modo silencioso

### ğŸ”§ TAR - Archivos TAR (Windows 10+)

Windows 10 y posteriores incluyen soporte nativo para archivos TAR, comÃºnmente usados en entornos Unix/Linux.

**Sintaxis bÃ¡sica:**
```batch
TAR -xf <archivo.tar> -C <directorio_destino>
```

**ParÃ¡metros principales:**
- `-x` - Extraer archivos
- `-f` - Especificar archivo
- `-C` - Cambiar al directorio antes de extraer
- `-z` - Descomprimir con gzip
- `-v` - Modo verbose (mostrar archivos)

---

## ğŸ’¡ Ejemplos prÃ¡cticos

### **Ejemplo 1: ExpansiÃ³n bÃ¡sica de archivos ZIP**

**PropÃ³sito:** Extraer contenido de archivos ZIP estÃ¡ndar. Fundamental para administradores que reciben backups, distribuciones de software, o archivos compartidos en formato ZIP.

```powershell
# Expandir un archivo ZIP bÃ¡sico
Expand-Archive -Path "C:\Descargas\backup.zip" -DestinationPath "C:\Restauracion\"

# Expandir con sobrescritura forzada
Expand-Archive -Path "C:\Descargas\proyecto.zip" -DestinationPath "C:\Proyectos\" -Force

# Expandir con informaciÃ³n detallada
Expand-Archive -Path "C:\Descargas\datos.zip" -DestinationPath "C:\Datos\" -Verbose
```

**Resultado esperado:**
```
VERBOSE: Performing the operation "Expand Archive" on target "C:\Descargas\datos.zip".
VERBOSE: Created "C:\Datos\documento1.txt"
VERBOSE: Created "C:\Datos\documento2.txt"
VERBOSE: Created "C:\Datos\configuracion.ini"
```

### **Ejemplo 2: DescompresiÃ³n de archivos nativos de Windows**

**PropÃ³sito:** Descomprimir archivos que fueron comprimidos con el comando COMPACT. Esencial para administradores que trabajan con archivos del sistema o backups nativos de Windows.

```batch
:: Descomprimir archivos especÃ­ficos
compact /u documento1.txt documento2.txt

:: Descomprimir directorio completo
compact /u /s C:\Logs\

:: Descomprimir con modo silencioso
compact /u /s /q C:\Backups\
```

### **Ejemplo 3: ExpansiÃ³n de archivos TAR**

**PropÃ³sito:** Extraer archivos TAR que son comunes en entornos Linux y desarrollo. Ãštil para administradores que trabajan en entornos hÃ­bridos o reciben archivos de sistemas Unix/Linux.

```batch
:: Expandir archivo TAR bÃ¡sico
tar -xf archivo.tar -C C:\Destino\

:: Expandir archivo TAR comprimido con GZIP
tar -xzf archivo.tar.gz -C C:\Destino\

:: Expandir con informaciÃ³n detallada
tar -xzf archivo.tar.gz -C C:\Destino\ -v
```

### **Ejemplo 4: Script de expansiÃ³n masiva**

**PropÃ³sito:** Extraer mÃºltiples archivos comprimidos de forma automÃ¡tica. Ideal para administradores que reciben lotes de backups o distribuciones de software que necesitan ser procesados rÃ¡pidamente.

```batch
@echo off
:: Expansor masivo de archivos comprimidos
title ğŸ“¦ Expansor Masivo
color 0A

set /p directorio="Directorio con archivos comprimidos: "
set /p destino="Directorio de destino: "

echo ========================================
echo    ğŸ“¦ EXPANSOR MASIVO DE ARCHIVOS
echo ========================================
echo.

if not exist "%destino%" mkdir "%destino%"

echo ğŸ” Buscando archivos comprimidos...
echo.

:: Procesar archivos ZIP
for %%f in ("%directorio%\*.zip") do (
    echo ğŸ“¦ Expandiendo: %%~nxf
    powershell -Command "Expand-Archive -Path '%%f' -DestinationPath '%destino%' -Force"
    if !errorlevel!==0 (
        echo âœ… %%~nxf expandido exitosamente
    ) else (
        echo âŒ Error al expandir %%~nxf
    )
)

:: Procesar archivos TAR
for %%f in ("%directorio%\*.tar") do (
    echo ğŸ“¦ Expandiendo: %%~nxf
    tar -xf "%%f" -C "%destino%"
    if !errorlevel!==0 (
        echo âœ… %%~nxf expandido exitosamente
    ) else (
        echo âŒ Error al expandir %%~nxf
    )
)

:: Procesar archivos TAR.GZ
for %%f in ("%directorio%\*.tar.gz") do (
    echo ğŸ“¦ Expandiendo: %%~nxf
    tar -xzf "%%f" -C "%destino%"
    if !errorlevel!==0 (
        echo âœ… %%~nxf expandido exitosamente
    ) else (
        echo âŒ Error al expandir %%~nxf
    )
)

echo.
echo ğŸ‰ ExpansiÃ³n masiva completada.
pause
```

### **Ejemplo 5: ExpansiÃ³n con verificaciÃ³n de integridad**

**PropÃ³sito:** Extraer archivos comprimidos verificando que no se corrompan durante el proceso. CrÃ­tico para backups importantes o archivos de software que deben mantener su integridad.

```batch
@echo off
:: Expansor con verificaciÃ³n de integridad
title ğŸ” Expansor Seguro
color 0B

set /p archivo="Archivo comprimido: "
set /p destino="Directorio de destino: "

echo ========================================
echo    ğŸ” EXPANSOR CON VERIFICACIÃ“N
echo ========================================
echo.

:: Verificar que el archivo existe
if not exist "%archivo%" (
    echo âŒ Archivo no encontrado: %archivo%
    pause
    exit /b 1
)

:: Crear directorio de destino si no existe
if not exist "%destino%" mkdir "%destino%"

:: Calcular hash del archivo comprimido
echo ğŸ” Calculando hash del archivo comprimido...
certutil -hashfile "%archivo%" MD5 > hash_comprimido.txt

:: Expandir archivo
echo ğŸ“¦ Expandiendo archivo...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"

if %errorlevel%==0 (
    echo âœ… Archivo expandido exitosamente
    
    :: Verificar archivos extraÃ­dos
    echo ğŸ” Verificando archivos extraÃ­dos...
    dir "%destino%" /s /b > archivos_extraidos.txt
    
    echo ğŸ“Š Resumen de expansiÃ³n:
    echo - Archivo original: %archivo%
    echo - Directorio destino: %destino%
    echo - Archivos extraÃ­dos: 
    type archivos_extraidos.txt
    
) else (
    echo âŒ Error al expandir archivo
)

:: Limpiar archivos temporales
del hash_comprimido.txt archivos_extraidos.txt 2>nul

echo.
pause
```

### **Ejemplo 6: ExpansiÃ³n de archivos de backup**

**PropÃ³sito:** Restaurar backups comprimidos de manera segura y organizada. Esencial para administradores de sistemas que necesitan restaurar configuraciones o datos de respaldo.

```batch
@echo off
:: Restaurador de backups comprimidos
title ğŸ—„ï¸ Restaurador de Backups
color 0C

set /p backup="Archivo de backup: "
set /p destino="Directorio de restauraciÃ³n: "

echo ========================================
echo    ğŸ—„ï¸ RESTAURADOR DE BACKUPS
echo ========================================
echo.

:: Verificar espacio disponible
for %%d in ("%destino%") do set "espacio_destino=%%~zd"
for %%f in ("%backup%") do set "tamaÃ±o_backup=%%~zf"

echo ğŸ“Š InformaciÃ³n de restauraciÃ³n:
echo - Backup: %backup%
echo - TamaÃ±o: %tamaÃ±o_backup% bytes
echo - Destino: %destino%
echo.

:: Crear directorio de destino con timestamp
set "destino_final=%destino%\restauracion_%date:~-4,4%%date:~-10,2%%date:~-7,2%_%time:~0,2%%time:~3,2%"
set "destino_final=%destino_final: =0%"
mkdir "%destino_final%"

echo ğŸ”„ Restaurando backup...
powershell -Command "Expand-Archive -Path '%backup%' -DestinationPath '%destino_final%' -Force"

if %errorlevel%==0 (
    echo âœ… Backup restaurado exitosamente en: %destino_final%
    
    :: Mostrar contenido restaurado
    echo ğŸ“‹ Contenido restaurado:
    dir "%destino_final%" /s /b
) else (
    echo âŒ Error al restaurar backup
)

echo.
pause
```

### **Ejemplo 7: ExpansiÃ³n de archivos de distribuciÃ³n de software**

**PropÃ³sito:** Extraer paquetes de software distribuidos en formato comprimido. Fundamental para administradores de sistemas que despliegan software en mÃºltiples equipos.

```batch
@echo off
:: Extractor de paquetes de software
title ğŸš€ Extractor de Software
color 0D

set /p paquete="Paquete de software: "
set /p version="VersiÃ³n (ej: 1.0.0): "

echo ========================================
echo    ğŸš€ EXTRACTOR DE PAQUETES DE SOFTWARE
echo ========================================
echo.

:: Directorio de instalaciÃ³n
set "dir_instalacion=C:\Software\%version%"

:: Crear directorio de instalaciÃ³n
if exist "%dir_instalacion%" (
    echo âš ï¸ El directorio ya existe. Â¿Sobrescribir? (S/N)
    set /p confirmar=
    if /i "%confirmar%"=="S" (
        rmdir /s /q "%dir_instalacion%"
    ) else (
        echo âŒ OperaciÃ³n cancelada
        pause
        exit /b 1
    )
)

mkdir "%dir_instalacion%"

echo ğŸ”„ Extrayendo paquete de software...
powershell -Command "Expand-Archive -Path '%paquete%' -DestinationPath '%dir_instalacion%' -Force"

if %errorlevel%==0 (
    echo âœ… Software extraÃ­do exitosamente
    
    :: Buscar archivos de instalaciÃ³n
    echo ğŸ” Buscando archivos de instalaciÃ³n...
    dir "%dir_instalacion%" /s /b | findstr /i "setup\|install\|\.exe" > archivos_instalacion.txt
    
    if exist archivos_instalacion.txt (
        echo ğŸ“‹ Archivos de instalaciÃ³n encontrados:
        type archivos_instalacion.txt
    )
    
    del archivos_instalacion.txt 2>nul
) else (
    echo âŒ Error al extraer software
)

echo.
pause
```

### **Ejemplo 8: ExpansiÃ³n de archivos de configuraciÃ³n**

**PropÃ³sito:** Extraer configuraciones comprimidas para aplicarlas a sistemas. Ãštil para administradores que necesitan replicar configuraciones en mÃºltiples equipos.

```batch
:: Expandir configuraciones del sistema
powershell -Command "Expand-Archive -Path 'C:\Backups\configs.zip' -DestinationPath 'C:\Configuraciones\' -Force"

:: Expandir configuraciones de aplicaciones
powershell -Command "Expand-Archive -Path 'C:\Backups\app_configs.zip' -DestinationPath 'C:\Users\%USERNAME%\AppData\Local\' -Force"

:: Expandir configuraciones de red
powershell -Command "Expand-Archive -Path 'C:\Backups\network_configs.zip' -DestinationPath 'C:\Windows\System32\config\' -Force"
```

### **Ejemplo 9: ExpansiÃ³n de archivos multimedia**

**PropÃ³sito:** Extraer archivos multimedia comprimidos para su procesamiento o distribuciÃ³n. Ãštil para editores de contenido, diseÃ±adores, o administradores de contenido web.

```batch
@echo off
:: Extractor de archivos multimedia
title ğŸ¨ Extractor Multimedia
color 0E

set /p archivo="Archivo multimedia comprimido: "
set /p categoria="CategorÃ­a (imagenes/videos/audio): "

echo ========================================
echo    ğŸ¨ EXTRACTOR DE ARCHIVOS MULTIMEDIA
echo ========================================
echo.

:: Directorios por categorÃ­a
if /i "%categoria%"=="imagenes" set "destino=C:\Multimedia\Imagenes"
if /i "%categoria%"=="videos" set "destino=C:\Multimedia\Videos"
if /i "%categoria%"=="audio" set "destino=C:\Multimedia\Audio"

if not exist "%destino%" mkdir "%destino%"

echo ğŸ”„ Extrayendo archivos multimedia...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"

if %errorlevel%==0 (
    echo âœ… Archivos multimedia extraÃ­dos
    
    :: Mostrar estadÃ­sticas
    echo ğŸ“Š EstadÃ­sticas de extracciÃ³n:
    dir "%destino%" /s /b | find /c /v "" > temp_count.txt
    set /p count=<temp_count.txt
    echo - Archivos extraÃ­dos: %count%
    del temp_count.txt
    
    :: Mostrar tipos de archivos
    echo ğŸ“‹ Tipos de archivos encontrados:
    dir "%destino%" /s /b | findstr /i "\.jpg\|\.png\|\.gif\|\.mp4\|\.avi\|\.mp3\|\.wav"
) else (
    echo âŒ Error al extraer archivos multimedia
)

echo.
pause
```

### **Ejemplo 10: ExpansiÃ³n de archivos de desarrollo**

**PropÃ³sito:** Extraer proyectos de desarrollo comprimidos para su ediciÃ³n o compilaciÃ³n. Esencial para desarrolladores que reciben cÃ³digo fuente en formato comprimido.

```batch
@echo off
:: Extractor de proyectos de desarrollo
title ğŸ’» Extractor de Proyectos Dev
color 0F

set /p proyecto="Proyecto comprimido: "
set /p lenguaje="Lenguaje de programaciÃ³n: "

echo ========================================
echo    ğŸ’» EXTRACTOR DE PROYECTOS DE DESARROLLO
echo ========================================
echo.

:: Directorio de proyectos
set "dir_proyectos=C:\Proyectos\%lenguaje%"
if not exist "%dir_proyectos%" mkdir "%dir_proyectos%"

:: Extraer proyecto
echo ğŸ”„ Extrayendo proyecto...
powershell -Command "Expand-Archive -Path '%proyecto%' -DestinationPath '%dir_proyectos%' -Force"

if %errorlevel%==0 (
    echo âœ… Proyecto extraÃ­do exitosamente
    
    :: Buscar archivos de configuraciÃ³n del proyecto
    echo ğŸ” Analizando estructura del proyecto...
    
    :: Buscar archivos de configuraciÃ³n comunes
    dir "%dir_proyectos%" /s /b | findstr /i "package\.json\|requirements\.txt\|pom\.xml\|\.sln\|\.csproj" > config_files.txt
    
    if exist config_files.txt (
        echo ğŸ“‹ Archivos de configuraciÃ³n encontrados:
        type config_files.txt
    )
    
    :: Buscar archivos de cÃ³digo fuente
    echo ğŸ“ Archivos de cÃ³digo fuente:
    dir "%dir_proyectos%" /s /b | findstr /i "\.js\|\.py\|\.java\|\.cs\|\.cpp\|\.h" | find /c /v ""
    
    del config_files.txt 2>nul
) else (
    echo âŒ Error al extraer proyecto
)

echo.
pause
```

### **Ejemplo 11: ExpansiÃ³n con filtrado de archivos**

**PropÃ³sito:** Extraer solo archivos especÃ­ficos de un archivo comprimido. Ãštil cuando solo se necesitan ciertos archivos y no todo el contenido.

```powershell
# Extraer solo archivos de configuraciÃ³n
$zipPath = "C:\Descargas\proyecto.zip"
$destPath = "C:\Configuraciones\"
$tempPath = "C:\Temp\extraccion_temp\"

# Crear directorio temporal
New-Item -ItemType Directory -Path $tempPath -Force | Out-Null

# Extraer todo a directorio temporal
Expand-Archive -Path $zipPath -DestinationPath $tempPath -Force

# Mover solo archivos de configuraciÃ³n
Get-ChildItem -Path $tempPath -Recurse -Include "*.ini", "*.cfg", "*.conf", "*.json" | 
    ForEach-Object {
        $relativePath = $_.FullName.Substring($tempPath.Length)
        $destFile = Join-Path $destPath $relativePath
        $destDir = Split-Path $destFile -Parent
        
        if (!(Test-Path $destDir)) {
            New-Item -ItemType Directory -Path $destDir -Force | Out-Null
        }
        
        Copy-Item $_.FullName $destFile -Force
    }

# Limpiar directorio temporal
Remove-Item $tempPath -Recurse -Force

Write-Host "âœ… Archivos de configuraciÃ³n extraÃ­dos exitosamente"
```

### **Ejemplo 12: ExpansiÃ³n de archivos de red**

**PropÃ³sito:** Extraer archivos comprimidos ubicados en recursos de red. Ãštil para administradores que trabajan con archivos compartidos en servidores.

```batch
@echo off
:: Extractor de archivos de red
title ğŸŒ Extractor de Red
color 0A

set /p ruta_red="Ruta de red del archivo: "
set /p destino_local="Directorio local de destino: "

echo ========================================
echo    ğŸŒ EXTRACTOR DE ARCHIVOS DE RED
echo ========================================
echo.

:: Verificar conectividad de red
if exist "%ruta_red%" (
    echo âœ… ConexiÃ³n de red establecida
    
    :: Crear directorio de destino
    if not exist "%destino_local%" mkdir "%destino_local%"
    
    :: Extraer archivo de red
    echo ğŸ”„ Extrayendo archivo de red...
    powershell -Command "Expand-Archive -Path '%ruta_red%' -DestinationPath '%destino_local%' -Force"
    
    if %errorlevel%==0 (
        echo âœ… Archivo extraÃ­do exitosamente desde red
    ) else (
        echo âŒ Error al extraer archivo de red
    )
) else (
    echo âŒ No se puede acceder al archivo de red
    echo ğŸ’¡ Verifica la conectividad y permisos de red
)

echo.
pause
```

### **Ejemplo 13: ExpansiÃ³n con validaciÃ³n de contenido**

**PropÃ³sito:** Extraer archivos comprimidos y validar que el contenido sea el esperado. CrÃ­tico para archivos importantes donde la integridad es esencial.

```batch
@echo off
:: Extractor con validaciÃ³n de contenido
title âœ… Extractor Validado
color 0B

set /p archivo="Archivo a extraer: "
set /p destino="Directorio de destino: "
set /p archivo_esperado="Archivo que debe contener (ej: README.txt): "

echo ========================================
echo    âœ… EXTRACTOR CON VALIDACIÃ“N
echo ========================================
echo.

:: Extraer archivo
echo ğŸ”„ Extrayendo archivo...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"

if %errorlevel%==0 (
    echo âœ… Archivo extraÃ­do
    
    :: Validar contenido esperado
    echo ğŸ” Validando contenido...
    if exist "%destino%\%archivo_esperado%" (
        echo âœ… Archivo esperado encontrado: %archivo_esperado%
        
        :: Mostrar informaciÃ³n del archivo
        echo ğŸ“‹ InformaciÃ³n del archivo:
        dir "%destino%\%archivo_esperado%"
    ) else (
        echo âš ï¸ Archivo esperado no encontrado: %archivo_esperado%
        echo ğŸ“‹ Contenido extraÃ­do:
        dir "%destino%" /b
    )
) else (
    echo âŒ Error al extraer archivo
)

echo.
pause
```

### **Ejemplo 14: ExpansiÃ³n programada de backups**

**PropÃ³sito:** Crear un script que se puede programar para expandir backups automÃ¡ticamente. Ãštil para sistemas que reciben backups regulares que necesitan ser procesados.

```batch
@echo off
:: Expansor programado de backups
title â° Expansor Programado
color 0C

:: ConfiguraciÃ³n
set "dir_backups=C:\Backups\Comprimidos"
set "dir_restauracion=C:\Backups\Restaurados"
set "log_file=C:\Logs\expansion_%date:~-4,4%%date:~-10,2%%date:~-7,2%.log"

echo ========================================
echo    â° EXPANSOR PROGRAMADO DE BACKUPS
echo ========================================
echo Fecha: %date% %time%
echo.

:: Crear directorio de restauraciÃ³n si no existe
if not exist "%dir_restauracion%" mkdir "%dir_restauracion%"

:: Procesar backups comprimidos
for %%f in ("%dir_backups%\*.zip") do (
    echo [%time%] Procesando: %%~nxf
    powershell -Command "Expand-Archive -Path '%%f' -DestinationPath '%dir_restauracion%' -Force" >> "%log_file%" 2>&1
    
    if !errorlevel!==0 (
        echo [%time%] âœ… %%~nxf expandido exitosamente
    ) else (
        echo [%time%] âŒ Error al expandir %%~nxf
    )
)

echo âœ… Procesamiento de backups completado.
echo ğŸ“„ Log guardado en: %log_file%
```

### **Ejemplo 15: ExpansiÃ³n de archivos con manejo de errores**

**PropÃ³sito:** Extraer archivos comprimidos con manejo robusto de errores. Esencial para scripts de producciÃ³n que deben ser confiables.

```batch
@echo off
:: Extractor con manejo de errores
title ğŸ›¡ï¸ Extractor Robusto
color 0D

set /p archivo="Archivo a extraer: "
set /p destino="Directorio de destino: "

echo ========================================
echo    ğŸ›¡ï¸ EXTRACTOR CON MANEJO DE ERRORES
echo ========================================
echo.

:: Verificar archivo de entrada
if not exist "%archivo%" (
    echo âŒ Error: Archivo no encontrado - %archivo%
    pause
    exit /b 1
)

:: Verificar espacio disponible
for %%d in ("%destino%") do set "espacio_destino=%%~zd"
for %%f in ("%archivo%") do set "tamaÃ±o_archivo=%%~zf"

if %tamaÃ±o_archivo% gtr %espacio_destino% (
    echo âŒ Error: Espacio insuficiente en destino
    echo - TamaÃ±o archivo: %tamaÃ±o_archivo% bytes
    echo - Espacio disponible: %espacio_destino% bytes
    pause
    exit /b 1
)

:: Crear directorio de destino
if not exist "%destino%" (
    echo ğŸ”„ Creando directorio de destino...
    mkdir "%destino%"
    if !errorlevel! neq 0 (
        echo âŒ Error: No se pudo crear directorio de destino
        pause
        exit /b 1
    )
)

:: Intentar extraer archivo
echo ğŸ”„ Extrayendo archivo...
powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force" 2>error.log

if %errorlevel%==0 (
    echo âœ… Archivo extraÃ­do exitosamente
    
    :: Verificar contenido extraÃ­do
    dir "%destino%" /b >nul 2>&1
    if !errorlevel!==0 (
        echo ğŸ“‹ Contenido extraÃ­do:
        dir "%destino%" /b
    ) else (
        echo âš ï¸ Advertencia: Directorio de destino estÃ¡ vacÃ­o
    )
) else (
    echo âŒ Error al extraer archivo
    echo ğŸ“„ Detalles del error:
    type error.log
)

:: Limpiar archivo de error
del error.log 2>nul

echo.
pause
```

---

## ğŸ¯ Script para gestiÃ³n avanzada de expansiÃ³n

**PropÃ³sito:** Crear un sistema completo de gestiÃ³n de expansiÃ³n de archivos con interfaz interactiva que permita al usuario manejar diferentes tipos de archivos comprimidos y opciones de extracciÃ³n.

```batch
@echo off
:: Gestor avanzado de expansiÃ³n
title ğŸ“‚ Gestor Avanzado de ExpansiÃ³n
color 0A

:menu
cls
echo ========================================
echo    ğŸ“‚ GESTOR AVANZADO DE EXPANSIÃ“N
echo ========================================
echo.
echo 1. ğŸ“¦ Expandir archivo ZIP
echo 2. ğŸ—œï¸ Descomprimir archivos nativos
echo 3. ğŸ“‹ Expandir archivo TAR
echo 4. ğŸ” Ver contenido sin extraer
echo 5. ğŸ“Š ExpansiÃ³n masiva
echo 6. ğŸ” ExpansiÃ³n con verificaciÃ³n
echo 7. ğŸšª Salir
echo.
set /p opcion="Selecciona una opciÃ³n: "

if "%opcion%"=="1" goto expandir_zip
if "%opcion%"=="2" goto descomprimir_nativo
if "%opcion%"=="3" goto expandir_tar
if "%opcion%"=="4" goto ver_contenido
if "%opcion%"=="5" goto expansion_masiva
if "%opcion%"=="6" goto expansion_verificada
if "%opcion%"=="7" goto salir
goto menu

:expandir_zip
cls
echo ========================================
echo         ğŸ“¦ EXPANDIR ARCHIVO ZIP
echo ========================================
echo.
set /p archivo="Archivo ZIP: "
set /p destino="Directorio de destino: "
if exist "%archivo%" (
    echo ğŸ”„ Expandiendo archivo ZIP...
    powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"
    echo âœ… Archivo ZIP expandido.
) else (
    echo âŒ Archivo no encontrado.
)
pause
goto menu

:descomprimir_nativo
cls
echo ========================================
echo         ğŸ—œï¸ DESCOMPRIMIR ARCHIVOS NATIVOS
echo ========================================
echo.
set /p archivo="Archivo o directorio: "
if exist "%archivo%" (
    echo ğŸ”„ Descomprimiendo archivos nativos...
    compact /u /s "%archivo%"
    echo âœ… Archivos descomprimidos.
) else (
    echo âŒ Archivo/directorio no encontrado.
)
pause
goto menu

:expandir_tar
cls
echo ========================================
echo         ğŸ“‹ EXPANDIR ARCHIVO TAR
echo ========================================
echo.
set /p archivo="Archivo TAR: "
set /p destino="Directorio de destino: "
if exist "%archivo%" (
    echo ğŸ”„ Expandiendo archivo TAR...
    tar -xf "%archivo%" -C "%destino%"
    echo âœ… Archivo TAR expandido.
) else (
    echo âŒ Archivo no encontrado.
)
pause
goto menu

:ver_contenido
cls
echo ========================================
echo         ğŸ” VER CONTENIDO SIN EXTRAER
echo ========================================
echo.
set /p archivo="Archivo comprimido: "
if exist "%archivo%" (
    echo ğŸ“‹ Contenido del archivo:
    powershell -Command "Get-ChildItem -Path '%archivo%' -Recurse | Select-Object Name, Length"
) else (
    echo âŒ Archivo no encontrado.
)
pause
goto menu

:expansion_masiva
cls
echo ========================================
echo         ğŸ“Š EXPANSIÃ“N MASIVA
echo ========================================
echo.
set /p directorio="Directorio con archivos: "
set /p destino="Directorio de destino: "
if exist "%directorio%" (
    echo ğŸ”„ Procesando archivos comprimidos...
    for %%f in ("%directorio%\*.zip") do (
        echo Expandiendo: %%~nxf
        powershell -Command "Expand-Archive -Path '%%f' -DestinationPath '%destino%' -Force"
    )
    echo âœ… ExpansiÃ³n masiva completada.
) else (
    echo âŒ Directorio no encontrado.
)
pause
goto menu

:expansion_verificada
cls
echo ========================================
echo         ğŸ” EXPANSIÃ“N CON VERIFICACIÃ“N
echo ========================================
echo.
set /p archivo="Archivo a expandir: "
set /p destino="Directorio de destino: "
if exist "%archivo%" (
    echo ğŸ” Verificando integridad...
    certutil -hashfile "%archivo%" MD5 > hash_temp.txt
    
    echo ğŸ”„ Expandiendo archivo...
    powershell -Command "Expand-Archive -Path '%archivo%' -DestinationPath '%destino%' -Force"
    
    if %errorlevel%==0 (
        echo âœ… ExpansiÃ³n verificada exitosamente.
    ) else (
        echo âŒ Error en la expansiÃ³n.
    )
    
    del hash_temp.txt 2>nul
) else (
    echo âŒ Archivo no encontrado.
)
pause
goto menu

:salir
exit
```

---

## ğŸ’¡ Consejos importantes

### ğŸ¯ **OptimizaciÃ³n de expansiÃ³n**
- **Verificar espacio libre** antes de expandir archivos grandes
- **Usar directorios temporales** para archivos grandes
- **Limpiar archivos temporales** despuÃ©s de la expansiÃ³n
- **Verificar integridad** de archivos crÃ­ticos

### ğŸ”§ **Mejores prÃ¡cticas**
- **Mantener estructura de directorios** original
- **Usar rutas absolutas** para evitar confusiones
- **Documentar procesos** de expansiÃ³n
- **Crear backups** antes de sobrescribir archivos

### âš ï¸ **Consideraciones de seguridad**
- **Verificar origen** de archivos comprimidos
- **Escanear con antivirus** archivos extraÃ­dos
- **Revisar permisos** de archivos extraÃ­dos
- **No expandir archivos** de fuentes no confiables

---

## ğŸŒŸ Casos de uso reales

### ğŸ¢ **AdministraciÃ³n de servidores**
- **RestauraciÃ³n de backups** comprimidos automÃ¡ticamente
- **Despliegue de configuraciones** desde archivos ZIP
- **ActualizaciÃ³n de software** distribuido en formato comprimido

### ğŸ’» **Desarrollo de software**
- **ExtracciÃ³n de librerÃ­as** y dependencias
- **Despliegue de releases** de software
- **RestauraciÃ³n de proyectos** desde backups

### ğŸ¨ **Multimedia y diseÃ±o**
- **ExtracciÃ³n de assets** comprimidos
- **RestauraciÃ³n de proyectos** de diseÃ±o
- **DistribuciÃ³n de contenido** multimedia

### ğŸ”§ **Mantenimiento de sistemas**
- **RestauraciÃ³n de configuraciones** del sistema
- **ExtracciÃ³n de logs** comprimidos
- **Despliegue de parches** y actualizaciones

---

## ğŸ“ ConclusiÃ³n y siguiente paso

Â¡Excelente progreso! ğŸ‰ Has completado el ciclo de gestiÃ³n de archivos comprimidos, desde la compresiÃ³n hasta la expansiÃ³n. Ahora puedes manejar cualquier tipo de archivo comprimido con confianza y eficiencia.

La expansiÃ³n de archivos es una habilidad complementaria esencial que completa tu arsenal de herramientas de administraciÃ³n de sistemas. Desde restaurar backups hasta desplegar software, estas tÃ©cnicas te permitirÃ¡n trabajar con eficiencia en cualquier entorno.

**Â¿QuÃ© sigue?** En el prÃ³ximo capÃ­tulo, exploraremos **llamadas a programas externos** ğŸ”—, donde aprenderÃ¡s a integrar herramientas de terceros, ejecutar aplicaciones desde scripts, y crear sistemas hÃ­bridos que combinen lo mejor de Windows con software especializado.

Â¡PrepÃ¡rate para expandir tus horizontes mÃ¡s allÃ¡ de las herramientas nativas! ğŸš€

---

## ğŸ“ Scripts disponibles

En el directorio `scripts/23-expandir-archivos-comprimidos/` encontrarÃ¡s los siguientes scripts listos para usar:

### ğŸ”§ **Scripts de expansiÃ³n bÃ¡sica**
- `expansor-masivo.bat` - ExpansiÃ³n masiva de mÃºltiples archivos comprimidos
- `expansor-seguro.bat` - ExpansiÃ³n con verificaciÃ³n de integridad
- `extractor-robusto.bat` - Extractor con manejo robusto de errores

### ğŸ—„ï¸ **Scripts de backup y restauraciÃ³n**
- `restaurador-backups.bat` - Restaurador de backups comprimidos
- `expansor-programado.bat` - Expansor programado de backups automÃ¡ticos

### ğŸš€ **Scripts especializados**
- `extractor-software.bat` - Extractor de paquetes de software
- `extractor-multimedia.bat` - Extractor de archivos multimedia
- `extractor-proyectos-dev.bat` - Extractor de proyectos de desarrollo
- `extractor-red.bat` - Extractor de archivos de red
- `extractor-validado.bat` - Extractor con validaciÃ³n de contenido

### ğŸ¯ **Gestor completo**
- `gestor-avanzado-expansion.bat` - Gestor completo con interfaz interactiva

**Para usar estos scripts:**
1. Navega al directorio `scripts/23-expandir-archivos-comprimidos/`
2. Ejecuta el script deseado con doble clic o desde la lÃ­nea de comandos
3. Sigue las instrucciones en pantalla

---

## ğŸ“š Fuentes y referencias

### ğŸ”— **Enlaces relacionados**
- [CompresiÃ³n de archivos](22.%20CompresiÃ³n%20de%20archivos%20y%20directorios.md) - TÃ©cnicas de compresiÃ³n
- [GestiÃ³n de archivos](4.%20GestiÃ³n%20de%20ficheros%20o%20archivos.md) - Operaciones bÃ¡sicas con archivos
- [Variables](15.%20Variables.md) - Manejo de variables en scripts

### ğŸŒ **Recursos externos**
- [PowerShell Expand-Archive](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive)
- [Windows TAR Command](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/tar)
- [File Compression and Decompression](https://docs.microsoft.com/en-us/windows/win32/fileio/file-compression-and-decompression)

### ğŸ‘¨â€ğŸ’» **Autor**
**Jerson MartÃ­nez** - [jersonmartinez.com](https://jersonmartinez.com) | [crashell.com](https://crashell.com)

*Administrador de sistemas y DevOps Engineer especializado en automatizaciÃ³n y optimizaciÃ³n de infraestructuras Windows.* 